diff --git a/node_modules/@lazorkit/wallet/dist/core/adapter/adapter.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/adapter/adapter.d.ts.map
index 875b44a..75edb5b 100644
--- a/node_modules/@lazorkit/wallet/dist/core/adapter/adapter.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/adapter/adapter.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"adapter.d.ts","sourceRoot":"","sources":["../../../core/adapter/adapter.ts"],"names":[],"mappings":"AAAA,OAAO,EACH,iBAAiB,EACjB,UAAU,EACV,gBAAgB,EAIhB,sBAAsB,EACzB,MAAM,6BAA6B,CAAC;AACrC,OAAO,EACH,SAAS,EACT,WAAW,EACX,oBAAoB,EAEpB,sBAAsB,EACtB,oBAAoB,EAGvB,MAAM,iBAAiB,CAAC;AAuBzB,eAAO,MAAM,kBAAkB,EAAwB,UAAU,CAAC,iBAAiB,CAAC,CAAC;AAErF,MAAM,WAAW,qBAAqB;IAClC,MAAM,EAAE,MAAM,CAAC;IACf,SAAS,EAAE,MAAM,CAAC;IAClB,eAAe,EAAE;QACb,YAAY,EAAE,MAAM,CAAC;QACrB,MAAM,CAAC,EAAE,MAAM,CAAC;KACnB,CAAC;IACF,iBAAiB,CAAC,EAAE,QAAQ,GAAG,SAAS,CAAC;CAC5C;AAED,eAAO,MAAM,cAAc,EAAE,qBAM5B,CAAC;AAEF,MAAM,WAAW,8BAA+B,SAAQ,sBAAsB;IAC1E,iBAAiB,CAAC,EAAE,sBAAsB,EAAE,CAAC;CAChD;AAMD,qBAAa,qBAAsB,SAAQ,iBAAiB;IACxD,IAAI,EAAE,UAAU,CAAC,iBAAiB,CAAC,CAAsB;IACzD,GAAG,SAA0B;IAC7B,IAAI,SAA+hT;IACniT,4BAA4B,EAAE,WAAW,CAAC,GAAG,CAAC,CAA0B;IAExE,OAAO,CAAC,UAAU,CAA0B;IAC5C,OAAO,CAAC,WAAW,CAGkB;IACrC,OAAO,CAAC,WAAW,CAAkB;IACrC,OAAO,CAAC,OAAO,CAA2B;IAC1C,OAAO,CAAC,OAAO,CAAyC;gBAE5C,MAAM,CAAC,EAAE,OAAO,CAAC,qBAAqB,CAAC;IAOnD,IAAI,SAAS,IAAI,SAAS,GAAG,IAAI,CAEhC;IAED,IAAI,UAAU,IAAI,OAAO,CAExB;IAED,IAAI,UAAU,IAAI,gBAAgB,CAEjC;IAEK,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC;IAqC9B,OAAO,CAAC,kBAAkB;IAM1B,OAAO,CAAC,oBAAoB;YAQd,oBAAoB;IAgD5B,UAAU,IAAI,OAAO,CAAC,IAAI,CAAC;IAO3B,eAAe,CACjB,WAAW,EAAE,WAAW,GAAG,oBAAoB,GAChD,OAAO,CAAC,oBAAoB,CAAC;IAqD1B,eAAe,CAAC,CAAC,SAAS,WAAW,GAAG,oBAAoB,EAAE,YAAY,EAAE,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;IAI1F,mBAAmB,CAAC,CAAC,SAAS,WAAW,GAAG,oBAAoB,EAAE,aAAa,EAAE,CAAC,EAAE,GAAG,OAAO,CAAC,CAAC,EAAE,CAAC;IAInG,WAAW,CAAC,OAAO,EAAE,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;IAqB3D,OAAO,CAAC,kBAAkB;IAU1B,OAAO,CAAC,oBAAoB;YAoBd,0BAA0B;YAsB1B,eAAe;YA4Bf,8BAA8B;YAwC9B,gBAAgB;CAmBjC"}
\ No newline at end of file
+{"version":3,"file":"adapter.d.ts","sourceRoot":"","sources":["../../../core/adapter/adapter.ts"],"names":[],"mappings":"AAAA,OAAO,EACH,iBAAiB,EACjB,UAAU,EACV,gBAAgB,EAIhB,sBAAsB,EACzB,MAAM,6BAA6B,CAAC;AACrC,OAAO,EACH,SAAS,EACT,WAAW,EACX,oBAAoB,EAEpB,sBAAsB,EACtB,oBAAoB,EAGvB,MAAM,iBAAiB,CAAC;AAsBzB,eAAO,MAAM,kBAAkB,EAAwB,UAAU,CAAC,iBAAiB,CAAC,CAAC;AAErF,MAAM,WAAW,qBAAqB;IAClC,MAAM,EAAE,MAAM,CAAC;IACf,SAAS,EAAE,MAAM,CAAC;IAClB,eAAe,EAAE;QACb,YAAY,EAAE,MAAM,CAAC;QACrB,MAAM,CAAC,EAAE,MAAM,CAAC;KACnB,CAAC;IACF,iBAAiB,CAAC,EAAE,QAAQ,GAAG,SAAS,CAAC;CAC5C;AAED,eAAO,MAAM,cAAc,EAAE,qBAM5B,CAAC;AAEF,MAAM,WAAW,8BAA+B,SAAQ,sBAAsB;IAC1E,iBAAiB,CAAC,EAAE,sBAAsB,EAAE,CAAC;CAChD;AAMD,qBAAa,qBAAsB,SAAQ,iBAAiB;IACxD,IAAI,EAAE,UAAU,CAAC,iBAAiB,CAAC,CAAsB;IACzD,GAAG,SAA0B;IAC7B,IAAI,SAA+hT;IACniT,4BAA4B,EAAE,WAAW,CAAC,GAAG,CAAC,CAA0B;IAExE,OAAO,CAAC,UAAU,CAA0B;IAC5C,OAAO,CAAC,WAAW,CAGkB;IACrC,OAAO,CAAC,WAAW,CAAkB;IACrC,OAAO,CAAC,OAAO,CAA2B;IAC1C,OAAO,CAAC,OAAO,CAAyC;gBAE5C,MAAM,CAAC,EAAE,OAAO,CAAC,qBAAqB,CAAC;IAOnD,IAAI,SAAS,IAAI,SAAS,GAAG,IAAI,CAEhC;IAED,IAAI,UAAU,IAAI,OAAO,CAExB;IAED,IAAI,UAAU,IAAI,gBAAgB,CAEjC;IAEK,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC;IAqC9B,OAAO,CAAC,kBAAkB;IAM1B,OAAO,CAAC,oBAAoB;YAQd,oBAAoB;IAgD5B,UAAU,IAAI,OAAO,CAAC,IAAI,CAAC;IAO3B,eAAe,CACjB,WAAW,EAAE,WAAW,GAAG,oBAAoB,GAChD,OAAO,CAAC,oBAAoB,CAAC;IAqD1B,eAAe,CAAC,CAAC,SAAS,WAAW,GAAG,oBAAoB,EAAE,YAAY,EAAE,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;IAI1F,mBAAmB,CAAC,CAAC,SAAS,WAAW,GAAG,oBAAoB,EAAE,aAAa,EAAE,CAAC,EAAE,GAAG,OAAO,CAAC,CAAC,EAAE,CAAC;IAInG,WAAW,CAAC,OAAO,EAAE,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;IAqB3D,OAAO,CAAC,kBAAkB;IAU1B,OAAO,CAAC,oBAAoB;YAoBd,0BAA0B;YAuB1B,eAAe;YA4Bf,8BAA8B;YAyC9B,gBAAgB;CAmBjC"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts
index bbcc185..5d6a5bf 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts
@@ -16,6 +16,116 @@ export type Lazorkit = {
         "LazorKit: Smart Wallet with WebAuthn Passkey Authentication"
     ];
     "instructions": [
+        {
+            "name": "closeChunk";
+            "discriminator": [
+                150,
+                183,
+                213,
+                198,
+                0,
+                74,
+                14,
+                170
+            ];
+            "accounts": [
+                {
+                    "name": "payer";
+                    "writable": true;
+                    "signer": true;
+                },
+                {
+                    "name": "smartWallet";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    115,
+                                    109,
+                                    97,
+                                    114,
+                                    116,
+                                    95,
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "wallet_state.wallet_id";
+                                "account": "walletState";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "walletState";
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116,
+                                    95,
+                                    115,
+                                    116,
+                                    97,
+                                    116,
+                                    101
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "chunk";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    99,
+                                    104,
+                                    117,
+                                    110,
+                                    107
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            },
+                            {
+                                "kind": "account";
+                                "path": "chunk.authorized_nonce";
+                                "account": "chunk";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "sessionRefund";
+                    "writable": true;
+                }
+            ];
+            "args": [];
+        },
         {
             "name": "createChunk";
             "discriminator": [
@@ -66,6 +176,7 @@ export type Lazorkit = {
                 },
                 {
                     "name": "walletState";
+                    "writable": true;
                     "pda": {
                         "seeds": [
                             {
@@ -244,6 +355,69 @@ export type Lazorkit = {
                 }
             ];
         },
+        {
+            "name": "deleteSmartWallet";
+            "discriminator": [
+                126,
+                239,
+                172,
+                118,
+                134,
+                32,
+                52,
+                102
+            ];
+            "accounts": [
+                {
+                    "name": "payer";
+                    "writable": true;
+                    "signer": true;
+                    "address": "BE8duRBDmh4cF4Ecz4TBCNgNAMCaonrpQiEiQ1xfQmab";
+                },
+                {
+                    "name": "smartWallet";
+                    "writable": true;
+                },
+                {
+                    "name": "walletState";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116,
+                                    95,
+                                    115,
+                                    116,
+                                    97,
+                                    116,
+                                    101
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "walletDevice";
+                    "writable": true;
+                },
+                {
+                    "name": "systemProgram";
+                    "address": "11111111111111111111111111111111";
+                }
+            ];
+            "args": [];
+        },
         {
             "name": "execute";
             "discriminator": [
@@ -400,7 +574,6 @@ export type Lazorkit = {
                 },
                 {
                     "name": "walletState";
-                    "writable": true;
                     "pda": {
                         "seeds": [
                             {
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts.map
index 3fe190b..242bc02 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/anchor/types/lazorkit.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../../core/contract/anchor/types/lazorkit.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../../core/contract/anchor/types/lazorkit.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;AACH,MAAM,MAAM,QAAQ,GAAG;IACrB,SAAS,EAAE,8CAA8C,CAAC;IAC1D,UAAU,EAAE;QACV,MAAM,EAAE,UAAU,CAAC;QACnB,SAAS,EAAE,OAAO,CAAC;QACnB,MAAM,EAAE,OAAO,CAAC;QAChB,aAAa,EAAE,qBAAqB,CAAA;KACrC,CAAC;IACF,MAAM,EAAE;QACN,6DAA6D;KAC9D,CAAC;IACF,cAAc,EAAE;QACd;YACE,MAAM,EAAE,YAAY,CAAC;YACrB,eAAe,EAAE;gBACf,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,CAAC;gBACD,EAAE;gBACF,EAAE;gBACF,GAAG;aACJ,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAA;iBACf;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,aAAa,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,OAAO,CAAA;6BACnB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,UAAU,EAAE,IAAI,CAAA;iBACjB;aACF,CAAC;YACF,MAAM,EAAE,EAAE,CAAA;SACX;QACD;YACE,MAAM,EAAE,aAAa,CAAC;YACtB,eAAe,EAAE;gBACf,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,CAAC;gBACD,EAAE;gBACF,GAAG;gBACH,EAAE;aACH,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAA;iBACf;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,aAAa,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,cAAc,CAAA;iBACvB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAA;iBACxB;gBACD;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,yBAAyB,CAAC;gCAClC,SAAS,EAAE,aAAa,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,UAAU,CAAC;oBACnB,SAAS,EAAE,6CAA6C,CAAA;iBACzD;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,SAAS,EAAE,kCAAkC,CAAA;iBAC9C;aACF,CAAC;YACF,MAAM,EAAE;gBACN;oBACE,MAAM,EAAE,MAAM,CAAC;oBACf,MAAM,EAAE;wBACN,SAAS,EAAE;4BACT,MAAM,EAAE,iBAAiB,CAAA;yBAC1B,CAAA;qBACF,CAAA;iBACF;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,mBAAmB,CAAC;YAC5B,eAAe,EAAE;gBACf,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,EAAE;aACH,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAA;iBACf;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,KAAK,CAAC;gCACd,MAAM,EAAE,gBAAgB,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,cAAc,CAAC;oBACvB,UAAU,EAAE,IAAI,CAAA;iBACjB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAA;iBACxB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,SAAS,EAAE,kCAAkC,CAAA;iBAC9C;aACF,CAAC;YACF,MAAM,EAAE;gBACN;oBACE,MAAM,EAAE,MAAM,CAAC;oBACf,MAAM,EAAE;wBACN,SAAS,EAAE;4BACT,MAAM,EAAE,uBAAuB,CAAA;yBAChC,CAAA;qBACF,CAAA;iBACF;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,mBAAmB,CAAC;YAC5B,eAAe,EAAE;gBACf,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,EAAE;gBACF,EAAE;gBACF,GAAG;aACJ,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAC;oBACf,SAAS,EAAE,8CAA8C,CAAA;iBAC1D;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAA;iBACjB;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,cAAc,CAAC;oBACvB,UAAU,EAAE,IAAI,CAAA;iBACjB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,SAAS,EAAE,kCAAkC,CAAA;iBAC9C;aACF,CAAC;YACF,MAAM,EAAE,EAAE,CAAA;SACX;QACD;YACE,MAAM,EAAE,SAAS,CAAC;YAClB,eAAe,EAAE;gBACf,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,GAAG;gBACH,EAAE;aACH,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAA;iBACf;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,aAAa,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,cAAc,CAAA;iBACvB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAA;iBACxB;gBACD;oBACE,MAAM,EAAE,YAAY,CAAA;iBACrB;gBACD;oBACE,MAAM,EAAE,UAAU,CAAC;oBACnB,SAAS,EAAE,6CAA6C,CAAA;iBACzD;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,SAAS,EAAE,kCAAkC,CAAA;iBAC9C;aACF,CAAC;YACF,MAAM,EAAE;gBACN;oBACE,MAAM,EAAE,MAAM,CAAC;oBACf,MAAM,EAAE;wBACN,SAAS,EAAE;4BACT,MAAM,EAAE,aAAa,CAAA;yBACtB,CAAA;qBACF,CAAA;iBACF;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,cAAc,CAAC;YACvB,eAAe,EAAE;gBACf,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,GAAG;aACJ,CAAC;YACF,UAAU,EAAE;gBACV;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,QAAQ,EAAE,IAAI,CAAA;iBACf;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,aAAa,CAAA;6BACzB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,aAAa,CAAC;oBACtB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,EAAE;oCACF,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,OAAO,CAAC;oBAChB,UAAU,EAAE,IAAI,CAAC;oBACjB,KAAK,EAAE;wBACL,OAAO,EAAE;4BACP;gCACE,MAAM,EAAE,OAAO,CAAC;gCAChB,OAAO,EAAE;oCACP,EAAE;oCACF,GAAG;oCACH,GAAG;oCACH,GAAG;oCACH,GAAG;iCACJ,CAAA;6BACF;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,aAAa,CAAA;6BACtB;4BACD;gCACE,MAAM,EAAE,SAAS,CAAC;gCAClB,MAAM,EAAE,wBAAwB,CAAC;gCACjC,SAAS,EAAE,OAAO,CAAA;6BACnB;yBACF,CAAA;qBACF,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,UAAU,EAAE,IAAI,CAAA;iBACjB;gBACD;oBACE,MAAM,EAAE,eAAe,CAAC;oBACxB,SAAS,EAAE,kCAAkC,CAAA;iBAC9C;aACF,CAAC;YACF,MAAM,EAAE;gBACN;oBACE,MAAM,EAAE,qBAAqB,CAAC;oBAC9B,MAAM,EAAE;wBACN,KAAK,EAAE,OAAO,CAAA;qBACf,CAAA;iBACF;gBACD;oBACE,MAAM,EAAE,YAAY,CAAC;oBACrB,MAAM,EAAE,OAAO,CAAA;iBAChB;aACF,CAAA;SACF;KACF,CAAC;IACF,UAAU,EAAE;QACV;YACE,MAAM,EAAE,OAAO,CAAC;YAChB,eAAe,EAAE;gBACf,GAAG;gBACH,EAAE;gBACF,EAAE;gBACF,EAAE;gBACF,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;aACJ,CAAA;SACF;QACD;YACE,MAAM,EAAE,cAAc,CAAC;YACvB,eAAe,EAAE;gBACf,EAAE;gBACF,EAAE;gBACF,EAAE;gBACF,EAAE;gBACF,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,GAAG;aACJ,CAAA;SACF;QACD;YACE,MAAM,EAAE,aAAa,CAAC;YACtB,eAAe,EAAE;gBACf,GAAG;gBACH,GAAG;gBACH,CAAC;gBACD,GAAG;gBACH,EAAE;gBACF,GAAG;gBACH,GAAG;gBACH,EAAE;aACH,CAAA;SACF;KACF,CAAC;IACF,QAAQ,EAAE;QACR;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,iBAAiB,CAAC;YAC1B,KAAK,EAAE,uDAAuD,CAAA;SAC/D;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,uBAAuB,CAAC;YAChC,KAAK,EAAE,0BAA0B,CAAA;SAClC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,wBAAwB,CAAC;YACjC,KAAK,EAAE,+CAA+C,CAAA;SACvD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,yBAAyB,CAAC;YAClC,KAAK,EAAE,gDAAgD,CAAA;SACxD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,uBAAuB,CAAC;YAChC,KAAK,EAAE,4CAA4C,CAAA;SACpD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,kBAAkB,CAAC;YAC3B,KAAK,EAAE,qDAAqD,CAAA;SAC7D;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,uBAAuB,CAAC;YAChC,KAAK,EAAE,qCAAqC,CAAA;SAC7C;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,0BAA0B,CAAC;YACnC,KAAK,EAAE,iCAAiC,CAAA;SACzC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,kBAAkB,CAAC;YAC3B,KAAK,EAAE,+CAA+C,CAAA;SACvD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,4BAA4B,CAAC;YACrC,KAAK,EAAE,kCAAkC,CAAA;SAC1C;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,+BAA+B,CAAC;YACxC,KAAK,EAAE,0CAA0C,CAAA;SAClD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,cAAc,CAAC;YACvB,KAAK,EAAE,iDAAiD,CAAA;SACzD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,iCAAiC,CAAC;YAC1C,KAAK,EAAE,mCAAmC,CAAA;SAC3C;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,yBAAyB,CAAC;YAClC,KAAK,EAAE,qDAAqD,CAAA;SAC7D;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,yBAAyB,CAAC;YAClC,KAAK,EAAE,mCAAmC,CAAA;SAC3C;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,qBAAqB,CAAC;YAC9B,KAAK,EAAE,mCAAmC,CAAA;SAC3C;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,sBAAsB,CAAC;YAC/B,KAAK,EAAE,wBAAwB,CAAA;SAChC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,mBAAmB,CAAC;YAC5B,KAAK,EAAE,+BAA+B,CAAA;SACvC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,oBAAoB,CAAC;YAC7B,KAAK,EAAE,0CAA0C,CAAA;SAClD;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,mBAAmB,CAAC;YAC5B,KAAK,EAAE,wBAAwB,CAAA;SAChC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,wBAAwB,CAAC;YACjC,KAAK,EAAE,0BAA0B,CAAA;SAClC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,oBAAoB,CAAC;YAC7B,KAAK,EAAE,qBAAqB,CAAA;SAC7B;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,2BAA2B,CAAC;YACpC,KAAK,EAAE,8BAA8B,CAAA;SACtC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,uBAAuB,CAAC;YAChC,KAAK,EAAE,yBAAyB,CAAA;SACjC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,sBAAsB,CAAC;YAC/B,KAAK,EAAE,wBAAwB,CAAA;SAChC;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,oBAAoB,CAAC;YAC7B,KAAK,EAAE,qBAAqB,CAAA;SAC7B;QACD;YACE,MAAM,EAAE,IAAI,CAAC;YACb,MAAM,EAAE,mBAAmB,CAAC;YAC5B,KAAK,EAAE,oBAAoB,CAAA;SAC5B;KACF,CAAC;IACF,OAAO,EAAE;QACP;YACE,MAAM,EAAE,OAAO,CAAC;YAChB,MAAM,EAAE;gBACN,0CAA0C;gBAC1C,EAAE;gBACF,2EAA2E;gBAC3E,qEAAqE;gBACrE,2EAA2E;aAC5E,CAAC;YACF,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,oBAAoB,CAAC;wBAC7B,MAAM,EAAE;4BACN,yDAAyD;yBAC1D,CAAC;wBACF,MAAM,EAAE,QAAQ,CAAA;qBACjB;oBACD;wBACE,MAAM,EAAE,SAAS,CAAC;wBAClB,MAAM,EAAE;4BACN,8DAA8D;yBAC/D,CAAC;wBACF,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,iBAAiB,CAAC;wBAC1B,MAAM,EAAE;4BACN,wEAAwE;yBACzE,CAAC;wBACF,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,qBAAqB,CAAC;wBAC9B,MAAM,EAAE;4BACN,oEAAoE;yBACrE,CAAC;wBACF,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,mBAAmB,CAAC;wBAC5B,MAAM,EAAE;4BACN,+DAA+D;yBAChE,CAAC;wBACF,MAAM,EAAE,QAAQ,CAAA;qBACjB;iBACF,CAAA;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,iBAAiB,CAAC;YAC1B,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,kBAAkB,CAAC;wBAC3B,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,WAAW,CAAC;wBACpB,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,mBAAmB,CAAC;wBAC5B,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,sBAAsB,CAAC;wBAC/B,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,wBAAwB,CAAC;wBACjC,MAAM,EAAE,IAAI,CAAA;qBACb;oBACD;wBACE,MAAM,EAAE,YAAY,CAAC;wBACrB,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,WAAW,CAAC;wBACpB,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,SAAS,CAAC;wBAClB,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;iBACF,CAAA;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,uBAAuB,CAAC;YAChC,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,kBAAkB,CAAC;wBAC3B,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,gBAAgB,CAAC;wBACzB,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,gBAAgB,CAAC;wBACzB,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,UAAU,CAAC;wBACnB,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,QAAQ,CAAC;wBACjB,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,gBAAgB,CAAC;wBACzB,MAAM,EAAE,KAAK,CAAA;qBACd;iBACF,CAAA;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,aAAa,CAAC;YACtB,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,kBAAkB,CAAC;wBAC3B,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,WAAW,CAAC;wBACpB,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,mBAAmB,CAAC;wBAC5B,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,sBAAsB,CAAC;wBAC/B,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,wBAAwB,CAAC;wBACjC,MAAM,EAAE,IAAI,CAAA;qBACb;oBACD;wBACE,MAAM,EAAE,YAAY,CAAC;wBACrB,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,YAAY,CAAC;wBACrB,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,SAAS,CAAC;wBAClB,MAAM,EAAE,OAAO,CAAA;qBAChB;oBACD;wBACE,MAAM,EAAE,WAAW,CAAC;wBACpB,MAAM,EAAE,KAAK,CAAA;qBACd;iBACF,CAAA;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,cAAc,CAAC;YACvB,MAAM,EAAE;gBACN,2DAA2D;aAC5D,CAAC;YACF,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,eAAe,CAAC;wBACxB,MAAM,EAAE;4BACN,4CAA4C;yBAC7C,CAAC;wBACF,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,gBAAgB,CAAC;wBACzB,MAAM,EAAE;4BACN,kCAAkC;yBACnC,CAAC;wBACF,MAAM,EAAE;4BACN,OAAO,EAAE;gCACP,IAAI;gCACJ,EAAE;6BACH,CAAA;yBACF,CAAA;qBACF;oBACD;wBACE,MAAM,EAAE,aAAa,CAAC;wBACtB,MAAM,EAAE;4BACN,iCAAiC;yBAClC,CAAC;wBACF,MAAM,EAAE,QAAQ,CAAA;qBACjB;oBACD;wBACE,MAAM,EAAE,MAAM,CAAC;wBACf,MAAM,EAAE;4BACN,eAAe;yBAChB,CAAC;wBACF,MAAM,EAAE,IAAI,CAAA;qBACb;iBACF,CAAA;aACF,CAAA;SACF;QACD;YACE,MAAM,EAAE,aAAa,CAAC;YACtB,MAAM,EAAE;gBACN,uEAAuE;aACxE,CAAC;YACF,MAAM,EAAE;gBACN,MAAM,EAAE,QAAQ,CAAC;gBACjB,QAAQ,EAAE;oBACR;wBACE,MAAM,EAAE,MAAM,CAAC;wBACf,MAAM,EAAE;4BACN,gCAAgC;yBACjC,CAAC;wBACF,MAAM,EAAE,IAAI,CAAA;qBACb;oBACD;wBACE,MAAM,EAAE,UAAU,CAAC;wBACnB,MAAM,EAAE;4BACN,0BAA0B;yBAC3B,CAAC;wBACF,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,WAAW,CAAC;wBACpB,MAAM,EAAE;4BACN,4CAA4C;yBAC7C,CAAC;wBACF,MAAM,EAAE,KAAK,CAAA;qBACd;oBACD;wBACE,MAAM,EAAE,eAAe,CAAC;wBACxB,MAAM,EAAE;4BACN,4CAA4C;yBAC7C,CAAC;wBACF,MAAM,EAAE,QAAQ,CAAA;qBACjB;oBACD;wBACE,MAAM,EAAE,YAAY,CAAC;wBACrB,MAAM,EAAE;4BACN,4DAA4D;yBAC7D,CAAC;wBACF,MAAM,EAAE,OAAO,CAAA;qBAChB;iBACF,CAAA;aACF,CAAA;SACF;KACF,CAAA;CACF,CAAC"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/auth.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/auth.d.ts.map
index 733069f..33556a1 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/auth.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/auth.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"auth.d.ts","sourceRoot":"","sources":["../../../core/contract/auth.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAG5C,OAAO,EAAE,gBAAgB,EAAE,SAAS,EAAE,MAAM,SAAS,CAAC;AAQtD;;;;;;GAMG;AACH,wBAAgB,mCAAmC,CACjD,gBAAgB,EAAE,gBAAgB,GACjC,MAAM,CAAC,IAAI,CAAC,sBAAsB,CA8CpC;AAED;;;;;;GAMG;AACH,wBAAgB,wCAAwC,CACtD,gBAAgB,EAAE,gBAAgB,GACjC;IACD,gBAAgB,EAAE,MAAM,EAAE,CAAC;IAC3B,SAAS,EAAE,SAAS,CAAC;IACrB,iBAAiB,EAAE,MAAM,CAAC;IAC1B,oBAAoB,EAAE,MAAM,CAAC;CAC9B,CAqBA"}
\ No newline at end of file
+{"version":3,"file":"auth.d.ts","sourceRoot":"","sources":["../../../core/contract/auth.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAG5C,OAAO,EAAE,gBAAgB,EAAE,SAAS,EAAE,MAAM,SAAS,CAAC;AAQtD;;;;;;GAMG;AACH,wBAAgB,mCAAmC,CACjD,gBAAgB,EAAE,gBAAgB,GACjC,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAmDpC;AAED;;;;;;GAMG;AACH,wBAAgB,wCAAwC,CACtD,gBAAgB,EAAE,gBAAgB,GACjC;IACD,gBAAgB,EAAE,MAAM,EAAE,CAAC;IAC3B,SAAS,EAAE,SAAS,CAAC;IACrB,iBAAiB,EAAE,MAAM,CAAC;IAC1B,oBAAoB,EAAE,MAAM,CAAC;CAC9B,CAqBA"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts
index c1d9203..c61c030 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts
@@ -6,14 +6,14 @@ type PublicKey = anchor.web3.PublicKey;
 type TransactionInstruction = anchor.web3.TransactionInstruction;
 type BN = anchor.BN;
 interface ExecutePolicyContext {
-    provided?: TransactionInstruction;
+    provided: TransactionInstruction | null;
     smartWallet: PublicKey;
     credentialHash: types.CredentialHash;
     passkeyPublicKey: types.PasskeyPublicKey | number[];
     walletStateData: types.WalletState;
 }
 interface CreatePolicyContext {
-    provided?: TransactionInstruction;
+    provided?: TransactionInstruction | null;
     smartWalletId: BN;
     smartWallet: PublicKey;
     walletState: PublicKey;
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts.map
index e70026a..804b675 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/client/internal/policyResolver.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"policyResolver.d.ts","sourceRoot":"","sources":["../../../../../core/contract/client/internal/policyResolver.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAC5C,OAAO,EAAE,mBAAmB,EAAE,MAAM,kBAAkB,CAAC;AACvD,OAAO,EAAE,gBAAgB,EAAE,MAAM,cAAc,CAAC;AAChD,OAAO,KAAK,KAAK,MAAM,aAAa,CAAC;AAErC,KAAK,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;AACvC,KAAK,sBAAsB,GAAG,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC;AACjE,KAAK,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC;AAEpB,UAAU,oBAAoB;IAC5B,QAAQ,CAAC,EAAE,sBAAsB,CAAC;IAClC,WAAW,EAAE,SAAS,CAAC;IACvB,cAAc,EAAE,KAAK,CAAC,cAAc,CAAC;IACrC,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,GAAG,MAAM,EAAE,CAAC;IACpD,eAAe,EAAE,KAAK,CAAC,WAAW,CAAC;CACpC;AAED,UAAU,mBAAmB;IAC3B,QAAQ,CAAC,EAAE,sBAAsB,CAAC;IAClC,aAAa,EAAE,EAAE,CAAC;IAClB,WAAW,EAAE,SAAS,CAAC;IACvB,WAAW,EAAE,SAAS,CAAC;IACvB,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,GAAG,MAAM,EAAE,CAAC;IACpD,cAAc,EAAE,KAAK,CAAC,cAAc,CAAC;CACtC;AAED;;;GAGG;AACH,qBAAa,yBAAyB;IAElC,OAAO,CAAC,QAAQ,CAAC,YAAY;IAC7B,OAAO,CAAC,QAAQ,CAAC,UAAU;gBADV,YAAY,EAAE,mBAAmB,EACjC,UAAU,EAAE,gBAAgB;IAGzC,iBAAiB,CAAC,EACtB,QAAQ,EACR,WAAW,EACX,cAAc,EACd,gBAAgB,EAChB,eAAe,GAChB,EAAE,oBAAoB,GAAG,OAAO,CAAC,sBAAsB,CAAC;IAoBnD,gBAAgB,CAAC,EACrB,QAAQ,EACR,aAAa,EACb,WAAW,EACX,WAAW,EACX,gBAAgB,EAChB,cAAc,GACf,EAAE,mBAAmB,GAAG,OAAO,CAAC,sBAAsB,CAAC;CAmBzD"}
\ No newline at end of file
+{"version":3,"file":"policyResolver.d.ts","sourceRoot":"","sources":["../../../../../core/contract/client/internal/policyResolver.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAC5C,OAAO,EAAE,mBAAmB,EAAE,MAAM,kBAAkB,CAAC;AACvD,OAAO,EAAE,gBAAgB,EAAE,MAAM,cAAc,CAAC;AAChD,OAAO,KAAK,KAAK,MAAM,aAAa,CAAC;AAErC,KAAK,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;AACvC,KAAK,sBAAsB,GAAG,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC;AACjE,KAAK,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC;AAEpB,UAAU,oBAAoB;IAC5B,QAAQ,EAAE,sBAAsB,GAAG,IAAI,CAAC;IACxC,WAAW,EAAE,SAAS,CAAC;IACvB,cAAc,EAAE,KAAK,CAAC,cAAc,CAAC;IACrC,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,GAAG,MAAM,EAAE,CAAC;IACpD,eAAe,EAAE,KAAK,CAAC,WAAW,CAAC;CACpC;AAED,UAAU,mBAAmB;IAC3B,QAAQ,CAAC,EAAE,sBAAsB,GAAG,IAAI,CAAC;IACzC,aAAa,EAAE,EAAE,CAAC;IAClB,WAAW,EAAE,SAAS,CAAC;IACvB,WAAW,EAAE,SAAS,CAAC;IACvB,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,GAAG,MAAM,EAAE,CAAC;IACpD,cAAc,EAAE,KAAK,CAAC,cAAc,CAAC;CACtC;AAED;;;GAGG;AACH,qBAAa,yBAAyB;IAElC,OAAO,CAAC,QAAQ,CAAC,YAAY;IAC7B,OAAO,CAAC,QAAQ,CAAC,UAAU;gBADV,YAAY,EAAE,mBAAmB,EACjC,UAAU,EAAE,gBAAgB;IAGzC,iBAAiB,CAAC,EACtB,QAAQ,EACR,WAAW,EACX,cAAc,EACd,gBAAgB,EAChB,eAAe,GAChB,EAAE,oBAAoB,GAAG,OAAO,CAAC,sBAAsB,CAAC;IAoBnD,gBAAgB,CAAC,EACrB,QAAQ,EACR,aAAa,EACb,WAAW,EACX,WAAW,EACX,gBAAgB,EAChB,cAAc,GACf,EAAE,mBAAmB,GAAG,OAAO,CAAC,sBAAsB,CAAC;CAmBzD"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts
index 8cac3cd..ab5b9ea 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts
@@ -65,6 +65,10 @@ export declare class LazorkitClient {
      * Validates ExecuteChunkParams
      */
     private validateExecuteChunkParams;
+    /**
+     * Validates CloseChunkParams
+     */
+    private validateCloseChunkParams;
     /**
      * Fetches smart wallet data for a given smart wallet
      */
@@ -73,6 +77,22 @@ export declare class LazorkitClient {
      * Fetches transaction session data for a given transaction session
      */
     getChunkData(chunk: PublicKey): Promise<any>;
+    /**
+     * Finds a smart wallet by passkey public key
+     * Searches through all WalletState accounts to find one containing the specified passkey
+     *
+     * @param passkeyPublicKey - Passkey public key (33 bytes)
+     * @returns Smart wallet information or null if not found
+     * @throws {ValidationError} if passkeyPublicKey is invalid
+     */
+    getSmartWalletByPasskey(passkeyPublicKey: types.PasskeyPublicKey | number[]): Promise<{
+        smartWallet: PublicKey | null;
+        walletState: PublicKey | null;
+        deviceSlot: {
+            passkeyPubkey: number[];
+            credentialHash: number[];
+        } | null;
+    }>;
     /**
      * Find smart wallet by credential hash
      * Searches through all WalletState accounts to find one containing the specified credential hash
@@ -85,7 +105,7 @@ export declare class LazorkitClient {
         smartWallet: anchor.web3.PublicKey;
         walletState: anchor.web3.PublicKey;
         walletDevice: anchor.web3.PublicKey;
-        passkeyPublicKey: number[];
+        passkeyPubkey: number[];
     } | null>;
     /**
      * Builds the create smart wallet instruction
@@ -135,6 +155,16 @@ export declare class LazorkitClient {
      * @throws {ValidationError} if parameters are invalid
      */
     buildExecuteChunkIns(payer: PublicKey, smartWallet: PublicKey, cpiInstructions: readonly TransactionInstruction[], cpiSigners?: readonly PublicKey[]): Promise<TransactionInstruction>;
+    /**
+     * Builds the close chunk instruction
+     *
+     * @param payer - Payer account public key
+     * @param smartWallet - Smart wallet PDA address
+     * @param nonce - Nonce of the chunk to close
+     * @returns Transaction instruction
+     * @throws {ValidationError} if parameters are invalid
+     */
+    buildCloseChunkIns(payer: PublicKey, smartWallet: PublicKey, nonce: BN): Promise<TransactionInstruction>;
     /**
      * Creates a smart wallet with passkey authentication
      *
@@ -175,6 +205,15 @@ export declare class LazorkitClient {
      * @throws {ValidationError} if parameters are invalid
      */
     executeChunkTxn(params: types.ExecuteChunkParams, options?: types.TransactionBuilderOptions): Promise<Transaction | VersionedTransaction>;
+    /**
+     * Closes a deferred transaction (no authentication needed)
+     *
+     * @param params - Close chunk parameters
+     * @param options - Transaction builder options
+     * @returns Transaction
+     * @throws {ValidationError} if parameters are invalid
+     */
+    closeChunkTxn(params: types.CloseChunkParams, options?: types.TransactionBuilderOptions): Promise<Transaction | VersionedTransaction>;
     /**
      * Builds an authorization message for a smart wallet action
      */
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts.map
index 49d945f..9a8711b 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/client/lazorkit.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../core/contract/client/lazorkit.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../core/contract/client/lazorkit.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/pda/lazorkit.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/pda/lazorkit.d.ts.map
index 7bcdd0a..fb65f26 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/pda/lazorkit.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/pda/lazorkit.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../core/contract/pda/lazorkit.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAC5C,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAIhC,eAAO,MAAM,iBAAiB,qBAA8B,CAAC;AAC7D,eAAO,MAAM,wBAAwB,qBAA8B,CAAC;AACpE,eAAO,MAAM,kBAAkB,qBAA+B,CAAC;AAC/D,eAAO,MAAM,UAAU,qBAAuB,CAAC;AAE/C,wBAAgB,oBAAoB,CAClC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,QAAQ,EAAE,MAAM,CAAC,EAAE,GAClB,MAAM,CAAC,IAAI,CAAC,SAAS,CAKvB;AAED,wBAAgB,0BAA0B,CACxC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,GACjC,MAAM,CAAC,IAAI,CAAC,SAAS,CAKvB;AAcD,wBAAgB,qBAAqB,CACnC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAClC,cAAc,EAAE,MAAM,EAAE,GACvB,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,CAKjC;AAED,wBAAgB,cAAc,CAC5B,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAClC,SAAS,EAAE,MAAM,CAAC,EAAE,GACnB,MAAM,CAAC,IAAI,CAAC,SAAS,CASvB"}
\ No newline at end of file
+{"version":3,"file":"lazorkit.d.ts","sourceRoot":"","sources":["../../../../core/contract/pda/lazorkit.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAC5C,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAIhC,eAAO,MAAM,iBAAiB,qBAA8B,CAAC;AAC7D,eAAO,MAAM,wBAAwB,qBAA8B,CAAC;AACpE,eAAO,MAAM,kBAAkB,qBAA+B,CAAC;AAC/D,eAAO,MAAM,UAAU,qBAAuB,CAAC;AAE/C,wBAAgB,oBAAoB,CAClC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,QAAQ,EAAE,MAAM,CAAC,EAAE,GAClB,MAAM,CAAC,IAAI,CAAC,SAAS,CAKvB;AAED,wBAAgB,0BAA0B,CACxC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,GACjC,MAAM,CAAC,IAAI,CAAC,SAAS,CAKvB;AAED,wBAAgB,qBAAqB,CACnC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAClC,cAAc,EAAE,MAAM,EAAE,GACvB,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,CAKjC;AAED,wBAAgB,cAAc,CAC5B,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAChC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAClC,SAAS,EAAE,MAAM,CAAC,EAAE,GACnB,MAAM,CAAC,IAAI,CAAC,SAAS,CASvB"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts
index bc0f349..47f2f6d 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts
@@ -44,12 +44,18 @@ export declare function asCredentialHash(value: number[]): CredentialHash;
  */
 export declare function asSignature(value: number[]): Signature;
 export declare enum SmartWalletAction {
+    Execute = "execute",
     CreateChunk = "create_chunk",
     ExecuteChunk = "execute_chunk"
 }
 export type ArgsByAction = {
+    [SmartWalletAction.Execute]: {
+        policyInstruction: anchor.web3.TransactionInstruction | null;
+        cpiInstruction: anchor.web3.TransactionInstruction;
+        cpiSigners?: readonly anchor.web3.PublicKey[];
+    };
     [SmartWalletAction.CreateChunk]: {
-        policyInstruction?: anchor.web3.TransactionInstruction;
+        policyInstruction: anchor.web3.TransactionInstruction | null;
         cpiInstructions: readonly anchor.web3.TransactionInstruction[];
         expiresAt: number;
         cpiSigners?: readonly anchor.web3.PublicKey[];
@@ -78,8 +84,8 @@ export interface PasskeySignature {
     readonly authenticatorDataRaw64: string;
 }
 export interface TransactionBuilderOptions {
-    /** Address lookup table for versioned transactions */
-    readonly addressLookupTables?: readonly anchor.web3.AddressLookupTableAccount[];
+    /** Address lookup tables for versioned transactions */
+    readonly addressLookupTables?: anchor.web3.AddressLookupTableAccount[];
     /** Custom recent blockhash (if not provided, fetched from connection) */
     readonly recentBlockhash?: string;
     /** Compute unit limit for transaction */
@@ -122,7 +128,7 @@ export interface CreateSmartWalletParams {
     /** Initial funding amount in lamports (optional, defaults to EMPTY_PDA_RENT_EXEMPT_BALANCE) */
     readonly amount?: anchor.BN;
     /** Custom policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    readonly policyInstruction?: anchor.web3.TransactionInstruction | null;
     /** Wallet ID (optional, if not provided, a random one is generated) */
     readonly smartWalletId?: anchor.BN;
     /** Policy data size in bytes (optional, if not provided, default policy size is used) */
@@ -134,8 +140,8 @@ export interface CreateSmartWalletParams {
  * All required fields must be provided and validated
  */
 export interface ExecuteParams extends AuthParams {
-    /** Policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    /** Policy instruction (null for default policy, must be valid TransactionInstruction if provided) */
+    readonly policyInstruction: anchor.web3.TransactionInstruction | null;
     /** CPI instruction to execute (required, must be valid TransactionInstruction) */
     readonly cpiInstruction: anchor.web3.TransactionInstruction;
     /** Transaction timestamp (Unix timestamp in seconds, required, must be non-negative) */
@@ -148,8 +154,8 @@ export interface ExecuteParams extends AuthParams {
  * All required fields must be provided and validated
  */
 export interface CreateChunkParams extends AuthParams {
-    /** Policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    /** Policy instruction (null for default policy, must be valid TransactionInstruction if provided) */
+    readonly policyInstruction: anchor.web3.TransactionInstruction | null;
     /** CPI instructions to execute later (required, must be non-empty array, all must be valid TransactionInstructions) */
     readonly cpiInstructions: readonly anchor.web3.TransactionInstruction[];
     /** Transaction timestamp (Unix timestamp in seconds, required, must be non-negative) */
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts.map
index fbb472f..8f18ab7 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/types.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"types.d.ts","sourceRoot":"","sources":["../../../core/contract/types.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"types.d.ts","sourceRoot":"","sources":["../../../core/contract/types.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts
index c6cb060..b235831 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts
@@ -1,10 +1,8 @@
 import * as anchor from '@coral-xyz/anchor';
 import * as types from './types';
-import { LazorkitClient } from './client/lazorkit';
 export declare function instructionToAccountMetas(ix: anchor.web3.TransactionInstruction, signers?: readonly anchor.web3.PublicKey[]): anchor.web3.AccountMeta[];
 export declare function getRandomBytes(len: number): Uint8Array;
 export declare function byteArrayEquals(a: number[], b: number[]): boolean;
 export declare function credentialHashFromBase64(credentialIdBase64: string): types.CredentialHash;
 export declare function getBlockchainTimestamp(connection: anchor.web3.Connection): Promise<anchor.BN>;
-export declare function ensureChunkExist(connection: anchor.web3.Connection, client: LazorkitClient, smartWalletPubkey: anchor.web3.PublicKey): Promise<void>;
 //# sourceMappingURL=utils.d.ts.map
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts.map
index 4ad59d6..0c38caf 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/utils.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"utils.d.ts","sourceRoot":"","sources":["../../../core/contract/utils.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAG5C,OAAO,KAAK,KAAK,MAAM,SAAS,CAAC;AACjC,OAAO,EAAE,cAAc,EAAE,MAAM,mBAAmB,CAAC;AAGnD,wBAAgB,yBAAyB,CACvC,EAAE,EAAE,MAAM,CAAC,IAAI,CAAC,sBAAsB,EACtC,OAAO,CAAC,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,GACzC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAQ3B;AAED,wBAAgB,cAAc,CAAC,GAAG,EAAE,MAAM,GAAG,UAAU,CAatD;AAED,wBAAgB,eAAe,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,GAAG,OAAO,CAUjE;AAED,wBAAgB,wBAAwB,CACtC,kBAAkB,EAAE,MAAM,GACzB,KAAK,CAAC,cAAc,CAKtB;AAGD,wBAAsB,sBAAsB,CAC1C,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,GACjC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CASpB;AAED,wBAAsB,gBAAgB,CACpC,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,EAClC,MAAM,EAAE,cAAc,EACtB,iBAAiB,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,iBAqBzC"}
\ No newline at end of file
+{"version":3,"file":"utils.d.ts","sourceRoot":"","sources":["../../../core/contract/utils.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAG5C,OAAO,KAAK,KAAK,MAAM,SAAS,CAAC;AAEjC,wBAAgB,yBAAyB,CACvC,EAAE,EAAE,MAAM,CAAC,IAAI,CAAC,sBAAsB,EACtC,OAAO,CAAC,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,GACzC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAQ3B;AAED,wBAAgB,cAAc,CAAC,GAAG,EAAE,MAAM,GAAG,UAAU,CAatD;AAED,wBAAgB,eAAe,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,GAAG,OAAO,CAUjE;AAED,wBAAgB,wBAAwB,CACtC,kBAAkB,EAAE,MAAM,GACzB,KAAK,CAAC,cAAc,CAKtB;AAGD,wBAAsB,sBAAsB,CAC1C,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,GACjC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAIpB"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts
index 38e06cf..4f84251 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts
@@ -53,8 +53,7 @@ export declare function assertValidSignature(value: number[] | Uint8Array | null
  */
 export declare function validateSignature(value: number[] | Uint8Array | null | undefined, fieldName?: string): number[];
 /**
- * Validates that a BN is non-negative (>= 0)
- * Note: Despite the name "Positive", this actually checks for non-negative values (>= 0)
+ * Validates that a BN is positive
  * Works correctly in browser, Node.js, and React Native environments
  */
 export declare function assertPositiveBN(value: anchor.BN | null | undefined, fieldName: string): asserts value is anchor.BN;
@@ -100,7 +99,6 @@ export declare function assertValidBase64(value: string | null | undefined, fiel
 export declare function assertPositiveInteger(value: number | null | undefined, fieldName: string): asserts value is number;
 /**
  * Validates an array of PublicKeys
- * Allows empty arrays since cpiSigners is optional and may be empty
  */
 export declare function assertValidPublicKeyArray(value: readonly anchor.web3.PublicKey[] | anchor.web3.PublicKey[] | null | undefined, fieldName: string): asserts value is readonly anchor.web3.PublicKey[] | anchor.web3.PublicKey[];
 /**
@@ -111,9 +109,4 @@ export declare function assertValidTransactionInstructionArray(value: readonly a
  * Converts a byte array-like value to a number array
  */
 export declare function toNumberArraySafe(value: number[] | Uint8Array | readonly number[]): number[];
-/**
- * Validates a PasskeySignature object
- * Works correctly in browser, Node.js, and React Native environments
- */
-export declare function assertValidPasskeySignature(value: any, fieldName?: string): asserts value is import('./types').PasskeySignature;
 //# sourceMappingURL=validation.d.ts.map
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts.map
index 239e892..5af0f6d 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/validation.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"validation.d.ts","sourceRoot":"","sources":["../../../core/contract/validation.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAW5C,qBAAa,eAAgB,SAAQ,KAAK;aACK,KAAK,CAAC,EAAE,MAAM;gBAA/C,OAAO,EAAE,MAAM,EAAkB,KAAK,CAAC,EAAE,MAAM,YAAA;CAI5D;AAMD;;;GAGG;AACH,wBAAgB,aAAa,CAAC,CAAC,EAC7B,KAAK,EAAE,CAAC,GAAG,IAAI,GAAG,SAAS,EAC3B,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,CAAC,CAWpB;AAED;;;GAGG;AACH,wBAAgB,oBAAoB,CAClC,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,MAAM,GAAG,IAAI,GAAG,SAAS,EACxD,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CA6CxC;AAED;;;GAGG;AACH,wBAAgB,qBAAqB,CACnC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,cAAc,EAAE,MAAM,EACtB,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,EAAE,CAyC3B;AAED;;GAEG;AACH,wBAAgB,uBAAuB,CACrC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,EAAE,CAO3B;AAED;;;GAGG;AACH,wBAAgB,2BAA2B,CACzC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAA2B,GACrC,OAAO,CAAC,KAAK,IAAI,MAAM,EAAE,CAE3B;AAED;;;GAGG;AACH,wBAAgB,wBAAwB,CACtC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAA2B,GACrC,MAAM,EAAE,CAGV;AAED;;;GAGG;AACH,wBAAgB,yBAAyB,CACvC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAAyB,GACnC,OAAO,CAAC,KAAK,IAAI,MAAM,EAAE,CAE3B;AAED;;;GAGG;AACH,wBAAgB,sBAAsB,CACpC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAAyB,GACnC,MAAM,EAAE,CAGV;AAED;;;GAGG;AACH,wBAAgB,oBAAoB,CAClC,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAAoB,GAC9B,OAAO,CAAC,KAAK,IAAI,MAAM,EAAE,CAE3B;AAED;;;GAGG;AACH,wBAAgB,iBAAiB,CAC/B,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,IAAI,GAAG,SAAS,EAC/C,SAAS,GAAE,MAAoB,GAC9B,MAAM,EAAE,CAGV;AAED;;;;GAIG;AACH,wBAAgB,gBAAgB,CAC9B,KAAK,EAAE,MAAM,CAAC,EAAE,GAAG,IAAI,GAAG,SAAS,EACnC,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,EAAE,CA4B5B;AAED;;;GAGG;AACH,wBAAgB,oBAAoB,CAClC,KAAK,EAAE,MAAM,GAAG,IAAI,GAAG,SAAS,EAChC,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAiBzB;AAED;;;GAGG;AACH,wBAAgB,oBAAoB,CAClC,KAAK,EAAE,MAAM,GAAG,IAAI,GAAG,SAAS,EAChC,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAezB;AAED;;;;GAIG;AACH,wBAAgB,mBAAmB,CAAC,CAAC,EACnC,KAAK,EAAE,CAAC,EAAE,GAAG,SAAS,CAAC,EAAE,GAAG,IAAI,GAAG,SAAS,EAC5C,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,CAAC,EAAE,GAAG,SAAS,CAAC,EAAE,CAerC;AAED;;;GAGG;AACH,wBAAgB,iCAAiC,CAC/C,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,sBAAsB,GAAG,IAAI,GAAG,SAAS,EAC5D,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,sBAAsB,CA8BrD;AAED;;GAEG;AACH,wBAAgB,aAAa,CAC3B,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,MAAM,GACpC,MAAM,EAAE,CAKV;AAED;;;GAGG;AACH,wBAAgB,kBAAkB,CAChC,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,MAAM,GAAG,IAAI,GAAG,SAAS,EACxD,SAAS,GAAE,MAAoB,GAC9B,MAAM,CAAC,IAAI,CAAC,SAAS,CAMvB;AAED;;;GAGG;AACH,wBAAgB,iBAAiB,CAC/B,KAAK,EAAE,MAAM,GAAG,IAAI,GAAG,SAAS,EAChC,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAiCzB;AAED;;;GAGG;AACH,wBAAgB,qBAAqB,CACnC,KAAK,EAAE,MAAM,GAAG,IAAI,GAAG,SAAS,EAChC,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,MAAM,CAwBzB;AAED;;;GAGG;AACH,wBAAgB,yBAAyB,CACvC,KAAK,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,IAAI,GAAG,SAAS,EACpF,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,SAAS,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,CAa7E;AAED;;GAEG;AACH,wBAAgB,sCAAsC,CACpD,KAAK,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,sBAAsB,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,sBAAsB,EAAE,GAAG,IAAI,GAAG,SAAS,EAC9G,SAAS,EAAE,MAAM,GAChB,OAAO,CAAC,KAAK,IAAI,SAAS,MAAM,CAAC,IAAI,CAAC,sBAAsB,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAKvG;AAED;;GAEG;AACH,wBAAgB,iBAAiB,CAC/B,KAAK,EAAE,MAAM,EAAE,GAAG,UAAU,GAAG,SAAS,MAAM,EAAE,GAC/C,MAAM,EAAE,CAEV;AAED;;;GAGG;AACH,wBAAgB,2BAA2B,CACzC,KAAK,EAAE,GAAG,EACV,SAAS,GAAE,MAA2B,GACrC,OAAO,CAAC,KAAK,IAAI,OAAO,SAAS,EAAE,gBAAgB,CA2BrD"}
\ No newline at end of file
+{"version":3,"file":"validation.d.ts","sourceRoot":"","sources":["../../../core/contract/validation.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts b/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts
index 74405e1..2251338 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts
@@ -1,4 +1,5 @@
 import * as anchor from '@coral-xyz/anchor';
 import { Buffer } from 'buffer';
+export declare function createWalletDeviceHash(smartWallet: anchor.web3.PublicKey, credentialHash: number[]): Buffer;
 export declare function buildSecp256r1VerifyIx(message: Uint8Array, pubkey: number[], signature: Buffer<ArrayBuffer>): anchor.web3.TransactionInstruction;
 //# sourceMappingURL=secp256r1.d.ts.map
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts.map
index 517c3d2..54bb17f 100644
--- a/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/contract/webauthn/secp256r1.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"secp256r1.d.ts","sourceRoot":"","sources":["../../../../core/contract/webauthn/secp256r1.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAC5C,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAuChC,wBAAgB,sBAAsB,CACpC,OAAO,EAAE,UAAU,EACnB,MAAM,EAAE,MAAM,EAAE,EAChB,SAAS,EAAE,MAAM,CAAC,WAAW,CAAC,GAC7B,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAiDpC"}
\ No newline at end of file
+{"version":3,"file":"secp256r1.d.ts","sourceRoot":"","sources":["../../../../core/contract/webauthn/secp256r1.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,MAAM,mBAAmB,CAAC;AAE5C,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAEhC,wBAAgB,sBAAsB,CACpC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,EAClC,cAAc,EAAE,MAAM,EAAE,GACvB,MAAM,CAOR;AAsFD,wBAAgB,sBAAsB,CACpC,OAAO,EAAE,UAAU,EACnB,MAAM,EAAE,MAAM,EAAE,EAChB,SAAS,EAAE,MAAM,CAAC,WAAW,CAAC,GAC7B,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAwEpC"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/core/wallet/actions.d.ts.map b/node_modules/@lazorkit/wallet/dist/core/wallet/actions.d.ts.map
index 4e246d9..7af5412 100644
--- a/node_modules/@lazorkit/wallet/dist/core/wallet/actions.d.ts.map
+++ b/node_modules/@lazorkit/wallet/dist/core/wallet/actions.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"actions.d.ts","sourceRoot":"","sources":["../../../core/wallet/actions.ts"],"names":[],"mappings":"AAKA,OAAO,EAAkB,UAAU,EAAE,MAAM,YAAY,CAAC;AAIxD,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE,iBAAiB,EAAgB,6BAA6B,EAAE,MAAM,UAAU,CAAC;AASvH;;GAEG;AACH,eAAO,MAAM,aAAa,GACtB,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,UAAU,cAAc,GAAG;IAAE,OAAO,CAAC,EAAE,WAAW,GAAG,MAAM,CAAA;CAAE,KAC9D,OAAO,CAAC,UAAU,CA2EpB,CAAC;AAEF;;GAEG;AACH,eAAO,MAAM,gBAAgB,GACzB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,UAAU,iBAAiB,KAC5B,OAAO,CAAC,IAAI,CAgBd,CAAC;AAKF;;GAEG;AACH,eAAO,MAAM,4BAA4B,GACrC,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,SAAS,6BAA6B,KACvC,OAAO,CAAC,MAAM,CAkHhB,CAAC;AAEF;;GAEG;AACH,eAAO,MAAM,iBAAiB,GAC1B,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,SAAS,MAAM,KAChB,OAAO,CAAC;IAAE,SAAS,EAAE,MAAM,CAAC;IAAC,aAAa,EAAE,MAAM,CAAA;CAAE,CAgCtD,CAAC"}
\ No newline at end of file
+{"version":3,"file":"actions.d.ts","sourceRoot":"","sources":["../../../core/wallet/actions.ts"],"names":[],"mappings":"AAKA,OAAO,EAAkB,UAAU,EAAE,MAAM,YAAY,CAAC;AAGxD,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE,iBAAiB,EAAgB,6BAA6B,EAAE,MAAM,UAAU,CAAC;AASvH;;GAEG;AACH,eAAO,MAAM,aAAa,GACtB,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,UAAU,cAAc,GAAG;IAAE,OAAO,CAAC,EAAE,WAAW,GAAG,MAAM,CAAA;CAAE,KAC9D,OAAO,CAAC,UAAU,CA2EpB,CAAC;AAEF;;GAEG;AACH,eAAO,MAAM,gBAAgB,GACzB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,UAAU,iBAAiB,KAC5B,OAAO,CAAC,IAAI,CAgBd,CAAC;AAIF;;GAEG;AACH,eAAO,MAAM,4BAA4B,GACrC,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,SAAS,6BAA6B,KACvC,OAAO,CAAC,MAAM,CAqHhB,CAAC;AAEF;;GAEG;AACH,eAAO,MAAM,iBAAiB,GAC1B,KAAK,MAAM,WAAW,EACtB,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,WAAW,CAAC,KAAK,IAAI,EAC1C,SAAS,MAAM,KAChB,OAAO,CAAC;IAAE,SAAS,EAAE,MAAM,CAAC;IAAC,aAAa,EAAE,MAAM,CAAA;CAAE,CAqCtD,CAAC"}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/index.d.ts b/node_modules/@lazorkit/wallet/dist/index.d.ts
index e492ebb..914a55a 100644
--- a/node_modules/@lazorkit/wallet/dist/index.d.ts
+++ b/node_modules/@lazorkit/wallet/dist/index.d.ts
@@ -474,6 +474,116 @@ type Lazorkit = {
         "LazorKit: Smart Wallet with WebAuthn Passkey Authentication"
     ];
     "instructions": [
+        {
+            "name": "closeChunk";
+            "discriminator": [
+                150,
+                183,
+                213,
+                198,
+                0,
+                74,
+                14,
+                170
+            ];
+            "accounts": [
+                {
+                    "name": "payer";
+                    "writable": true;
+                    "signer": true;
+                },
+                {
+                    "name": "smartWallet";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    115,
+                                    109,
+                                    97,
+                                    114,
+                                    116,
+                                    95,
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "wallet_state.wallet_id";
+                                "account": "walletState";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "walletState";
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116,
+                                    95,
+                                    115,
+                                    116,
+                                    97,
+                                    116,
+                                    101
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "chunk";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    99,
+                                    104,
+                                    117,
+                                    110,
+                                    107
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            },
+                            {
+                                "kind": "account";
+                                "path": "chunk.authorized_nonce";
+                                "account": "chunk";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "sessionRefund";
+                    "writable": true;
+                }
+            ];
+            "args": [];
+        },
         {
             "name": "createChunk";
             "discriminator": [
@@ -524,6 +634,7 @@ type Lazorkit = {
                 },
                 {
                     "name": "walletState";
+                    "writable": true;
                     "pda": {
                         "seeds": [
                             {
@@ -702,6 +813,69 @@ type Lazorkit = {
                 }
             ];
         },
+        {
+            "name": "deleteSmartWallet";
+            "discriminator": [
+                126,
+                239,
+                172,
+                118,
+                134,
+                32,
+                52,
+                102
+            ];
+            "accounts": [
+                {
+                    "name": "payer";
+                    "writable": true;
+                    "signer": true;
+                    "address": "BE8duRBDmh4cF4Ecz4TBCNgNAMCaonrpQiEiQ1xfQmab";
+                },
+                {
+                    "name": "smartWallet";
+                    "writable": true;
+                },
+                {
+                    "name": "walletState";
+                    "writable": true;
+                    "pda": {
+                        "seeds": [
+                            {
+                                "kind": "const";
+                                "value": [
+                                    119,
+                                    97,
+                                    108,
+                                    108,
+                                    101,
+                                    116,
+                                    95,
+                                    115,
+                                    116,
+                                    97,
+                                    116,
+                                    101
+                                ];
+                            },
+                            {
+                                "kind": "account";
+                                "path": "smartWallet";
+                            }
+                        ];
+                    };
+                },
+                {
+                    "name": "walletDevice";
+                    "writable": true;
+                },
+                {
+                    "name": "systemProgram";
+                    "address": "11111111111111111111111111111111";
+                }
+            ];
+            "args": [];
+        },
         {
             "name": "execute";
             "discriminator": [
@@ -858,7 +1032,6 @@ type Lazorkit = {
                 },
                 {
                     "name": "walletState";
-                    "writable": true;
                     "pda": {
                         "seeds": [
                             {
@@ -1462,12 +1635,18 @@ declare function asCredentialHash(value: number[]): CredentialHash;
  */
 declare function asSignature(value: number[]): Signature;
 declare enum SmartWalletAction {
+    Execute = "execute",
     CreateChunk = "create_chunk",
     ExecuteChunk = "execute_chunk"
 }
 type ArgsByAction = {
+    [SmartWalletAction.Execute]: {
+        policyInstruction: anchor.web3.TransactionInstruction | null;
+        cpiInstruction: anchor.web3.TransactionInstruction;
+        cpiSigners?: readonly anchor.web3.PublicKey[];
+    };
     [SmartWalletAction.CreateChunk]: {
-        policyInstruction?: anchor.web3.TransactionInstruction;
+        policyInstruction: anchor.web3.TransactionInstruction | null;
         cpiInstructions: readonly anchor.web3.TransactionInstruction[];
         expiresAt: number;
         cpiSigners?: readonly anchor.web3.PublicKey[];
@@ -1496,8 +1675,8 @@ interface PasskeySignature {
     readonly authenticatorDataRaw64: string;
 }
 interface TransactionBuilderOptions {
-    /** Address lookup table for versioned transactions */
-    readonly addressLookupTables?: readonly anchor.web3.AddressLookupTableAccount[];
+    /** Address lookup tables for versioned transactions */
+    readonly addressLookupTables?: anchor.web3.AddressLookupTableAccount[];
     /** Custom recent blockhash (if not provided, fetched from connection) */
     readonly recentBlockhash?: string;
     /** Compute unit limit for transaction */
@@ -1540,7 +1719,7 @@ interface CreateSmartWalletParams {
     /** Initial funding amount in lamports (optional, defaults to EMPTY_PDA_RENT_EXEMPT_BALANCE) */
     readonly amount?: anchor.BN;
     /** Custom policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    readonly policyInstruction?: anchor.web3.TransactionInstruction | null;
     /** Wallet ID (optional, if not provided, a random one is generated) */
     readonly smartWalletId?: anchor.BN;
     /** Policy data size in bytes (optional, if not provided, default policy size is used) */
@@ -1552,8 +1731,8 @@ interface CreateSmartWalletParams {
  * All required fields must be provided and validated
  */
 interface ExecuteParams extends AuthParams {
-    /** Policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    /** Policy instruction (null for default policy, must be valid TransactionInstruction if provided) */
+    readonly policyInstruction: anchor.web3.TransactionInstruction | null;
     /** CPI instruction to execute (required, must be valid TransactionInstruction) */
     readonly cpiInstruction: anchor.web3.TransactionInstruction;
     /** Transaction timestamp (Unix timestamp in seconds, required, must be non-negative) */
@@ -1566,8 +1745,8 @@ interface ExecuteParams extends AuthParams {
  * All required fields must be provided and validated
  */
 interface CreateChunkParams extends AuthParams {
-    /** Policy instruction (optional, if not provided, default policy is used) */
-    readonly policyInstruction?: anchor.web3.TransactionInstruction;
+    /** Policy instruction (null for default policy, must be valid TransactionInstruction if provided) */
+    readonly policyInstruction: anchor.web3.TransactionInstruction | null;
     /** CPI instructions to execute later (required, must be non-empty array, all must be valid TransactionInstructions) */
     readonly cpiInstructions: readonly anchor.web3.TransactionInstruction[];
     /** Transaction timestamp (Unix timestamp in seconds, required, must be non-negative) */
@@ -1926,6 +2105,10 @@ declare class LazorkitClient {
      * Validates ExecuteChunkParams
      */
     private validateExecuteChunkParams;
+    /**
+     * Validates CloseChunkParams
+     */
+    private validateCloseChunkParams;
     /**
      * Fetches smart wallet data for a given smart wallet
      */
@@ -1934,6 +2117,22 @@ declare class LazorkitClient {
      * Fetches transaction session data for a given transaction session
      */
     getChunkData(chunk: PublicKey): Promise<any>;
+    /**
+     * Finds a smart wallet by passkey public key
+     * Searches through all WalletState accounts to find one containing the specified passkey
+     *
+     * @param passkeyPublicKey - Passkey public key (33 bytes)
+     * @returns Smart wallet information or null if not found
+     * @throws {ValidationError} if passkeyPublicKey is invalid
+     */
+    getSmartWalletByPasskey(passkeyPublicKey: PasskeyPublicKey | number[]): Promise<{
+        smartWallet: PublicKey | null;
+        walletState: PublicKey | null;
+        deviceSlot: {
+            passkeyPubkey: number[];
+            credentialHash: number[];
+        } | null;
+    }>;
     /**
      * Find smart wallet by credential hash
      * Searches through all WalletState accounts to find one containing the specified credential hash
@@ -1946,7 +2145,7 @@ declare class LazorkitClient {
         smartWallet: anchor.web3.PublicKey;
         walletState: anchor.web3.PublicKey;
         walletDevice: anchor.web3.PublicKey;
-        passkeyPublicKey: number[];
+        passkeyPubkey: number[];
     } | null>;
     /**
      * Builds the create smart wallet instruction
@@ -1996,6 +2195,16 @@ declare class LazorkitClient {
      * @throws {ValidationError} if parameters are invalid
      */
     buildExecuteChunkIns(payer: PublicKey, smartWallet: PublicKey, cpiInstructions: readonly TransactionInstruction[], cpiSigners?: readonly PublicKey[]): Promise<TransactionInstruction>;
+    /**
+     * Builds the close chunk instruction
+     *
+     * @param payer - Payer account public key
+     * @param smartWallet - Smart wallet PDA address
+     * @param nonce - Nonce of the chunk to close
+     * @returns Transaction instruction
+     * @throws {ValidationError} if parameters are invalid
+     */
+    buildCloseChunkIns(payer: PublicKey, smartWallet: PublicKey, nonce: BN): Promise<TransactionInstruction>;
     /**
      * Creates a smart wallet with passkey authentication
      *
@@ -2036,6 +2245,15 @@ declare class LazorkitClient {
      * @throws {ValidationError} if parameters are invalid
      */
     executeChunkTxn(params: ExecuteChunkParams, options?: TransactionBuilderOptions): Promise<Transaction | VersionedTransaction>;
+    /**
+     * Closes a deferred transaction (no authentication needed)
+     *
+     * @param params - Close chunk parameters
+     * @param options - Transaction builder options
+     * @returns Transaction
+     * @throws {ValidationError} if parameters are invalid
+     */
+    closeChunkTxn(params: CloseChunkParams, options?: TransactionBuilderOptions): Promise<Transaction | VersionedTransaction>;
     /**
      * Builds an authorization message for a smart wallet action
      */
@@ -2102,7 +2320,6 @@ declare function getRandomBytes(len: number): Uint8Array;
 declare function byteArrayEquals(a: number[], b: number[]): boolean;
 declare function credentialHashFromBase64(credentialIdBase64: string): CredentialHash;
 declare function getBlockchainTimestamp(connection: anchor.web3.Connection): Promise<anchor.BN>;
-declare function ensureChunkExist(connection: anchor.web3.Connection, client: LazorkitClient, smartWalletPubkey: anchor.web3.PublicKey): Promise<void>;
 
 declare const computeMultipleCpiHashes: (cpiInstructions: readonly anchor.web3.TransactionInstruction[], smartWallet: anchor.web3.PublicKey, cpiSigners?: readonly anchor.web3.PublicKey[]) => {
     cpiDataHash: Uint8Array;
@@ -2174,8 +2391,7 @@ declare function assertValidSignature(value: number[] | Uint8Array | null | unde
  */
 declare function validateSignature(value: number[] | Uint8Array | null | undefined, fieldName?: string): number[];
 /**
- * Validates that a BN is non-negative (>= 0)
- * Note: Despite the name "Positive", this actually checks for non-negative values (>= 0)
+ * Validates that a BN is positive
  * Works correctly in browser, Node.js, and React Native environments
  */
 declare function assertPositiveBN(value: anchor.BN | null | undefined, fieldName: string): asserts value is anchor.BN;
@@ -2221,7 +2437,6 @@ declare function assertValidBase64(value: string | null | undefined, fieldName:
 declare function assertPositiveInteger(value: number | null | undefined, fieldName: string): asserts value is number;
 /**
  * Validates an array of PublicKeys
- * Allows empty arrays since cpiSigners is optional and may be empty
  */
 declare function assertValidPublicKeyArray(value: readonly anchor.web3.PublicKey[] | anchor.web3.PublicKey[] | null | undefined, fieldName: string): asserts value is readonly anchor.web3.PublicKey[] | anchor.web3.PublicKey[];
 /**
@@ -2232,11 +2447,6 @@ declare function assertValidTransactionInstructionArray(value: readonly anchor.w
  * Converts a byte array-like value to a number array
  */
 declare function toNumberArraySafe(value: number[] | Uint8Array | readonly number[]): number[];
-/**
- * Validates a PasskeySignature object
- * Works correctly in browser, Node.js, and React Native environments
- */
-declare function assertValidPasskeySignature(value: any, fieldName?: string): asserts value is PasskeySignature;
 
 declare const EMPTY_PDA_RENT_EXEMPT_BALANCE = 890880;
 declare const PASSKEY_PUBLIC_KEY_SIZE = 33;
@@ -2290,5 +2500,5 @@ declare class LazorkitWalletAdapter extends BaseWalletAdapter {
 
 declare function registerLazorkitWallet(config?: Partial<typeof DEFAULT_CONFIG>): void;
 
-export { API_ENDPOINTS, CHUNK_SEED, CREDENTIAL_HASH_SIZE, DEFAULTS, DEFAULT_COMMITMENT, DEFAULT_CONFIG, DefaultPolicyClient, DialogManager, EMPTY_PDA_RENT_EXEMPT_BALANCE, LazorkitClient, LazorkitProvider, LazorkitWalletAdapter, LazorkitWalletName, Logger, PASSKEY_PUBLIC_KEY_SIZE, Paymaster, SIGNATURE_SIZE, SMART_WALLET_CONFIG_SEED, SMART_WALLET_SEED, STORAGE_KEYS, SmartWalletAction, StorageManager, StorageUtil, ValidationError, WALLET_DEVICE_SEED, asCredentialHash, asPasskeyPublicKey, asSignature, assertByteArrayLength, assertDefined, assertNonEmptyArray, assertNonEmptyByteArray, assertNonEmptyString, assertPositiveBN, assertPositiveInteger, assertPositiveNumber, assertValidBase64, assertValidCredentialHash, assertValidPasskeyPublicKey, assertValidPasskeySignature, assertValidPublicKey, assertValidPublicKeyArray, assertValidSignature, assertValidTransactionInstruction, assertValidTransactionInstructionArray, base64ToBytes, buildCreateChunkMessage, buildExecuteMessage, buildPasskeyVerificationInstruction, buildTransaction, byteArrayEquals, calculateVerifyInstructionIndex, combineInstructionsWithAuth, combineInstructionsWithAuthAndCU, computeMultipleCpiHashes, convertPasskeySignatureToInstructionArgs, createComputeUnitLimitInstruction, credentialHashFromBase64, deriveChunkPda, deriveSmartWalletConfigPda, deriveSmartWalletPda, deriveWalletDevicePda, detectPlatform, ensureChunkExist, getBlockchainTimestamp, getRandomBytes, importP256PublicKey, instructionToAccountMetas, isAndroid, isIOS, isSafari, normalizePublicKey, prependComputeUnitLimit, registerLazorkitWallet, toNumberArray, toNumberArraySafe, useWallet, useWalletStore, validateCredentialHash, validatePasskeyPublicKey, validateSignature, verifySignatureBrowser };
+export { API_ENDPOINTS, CHUNK_SEED, CREDENTIAL_HASH_SIZE, DEFAULTS, DEFAULT_COMMITMENT, DEFAULT_CONFIG, DefaultPolicyClient, DialogManager, EMPTY_PDA_RENT_EXEMPT_BALANCE, LazorkitClient, LazorkitProvider, LazorkitWalletAdapter, LazorkitWalletName, Logger, PASSKEY_PUBLIC_KEY_SIZE, Paymaster, SIGNATURE_SIZE, SMART_WALLET_CONFIG_SEED, SMART_WALLET_SEED, STORAGE_KEYS, SmartWalletAction, StorageManager, StorageUtil, ValidationError, WALLET_DEVICE_SEED, asCredentialHash, asPasskeyPublicKey, asSignature, assertByteArrayLength, assertDefined, assertNonEmptyArray, assertNonEmptyByteArray, assertNonEmptyString, assertPositiveBN, assertPositiveInteger, assertPositiveNumber, assertValidBase64, assertValidCredentialHash, assertValidPasskeyPublicKey, assertValidPublicKey, assertValidPublicKeyArray, assertValidSignature, assertValidTransactionInstruction, assertValidTransactionInstructionArray, base64ToBytes, buildCreateChunkMessage, buildExecuteMessage, buildPasskeyVerificationInstruction, buildTransaction, byteArrayEquals, calculateVerifyInstructionIndex, combineInstructionsWithAuth, combineInstructionsWithAuthAndCU, computeMultipleCpiHashes, convertPasskeySignatureToInstructionArgs, createComputeUnitLimitInstruction, credentialHashFromBase64, deriveChunkPda, deriveSmartWalletConfigPda, deriveSmartWalletPda, deriveWalletDevicePda, detectPlatform, getBlockchainTimestamp, getRandomBytes, importP256PublicKey, instructionToAccountMetas, isAndroid, isIOS, isSafari, normalizePublicKey, prependComputeUnitLimit, registerLazorkitWallet, toNumberArray, toNumberArraySafe, useWallet, useWalletStore, validateCredentialHash, validatePasskeyPublicKey, validateSignature, verifySignatureBrowser };
 export type { ArgsByAction, AuthParams, BaseParams, BuildCheckPolicyIxParams, BuildInitPolicyIxParams, Chunk, CloseChunkParams, CreateChunkArgs, CreateChunkParams, CreateSmartWalletArgs, CreateSmartWalletParams, CredentialHash, ExecuteArgs, ExecuteChunkParams, ExecuteParams, LazorkitAdapterConfig, LazorkitSendTransactionOptions, PasskeyPublicKey, PasskeySignature, Platform, Signature, SmartWalletActionArgs, StoredCredentials, TransactionBuilderOptions, TransactionBuilderResult, WalletConfig, WalletDevice, WalletHookInterface, WalletInfo, WalletState };
diff --git a/node_modules/@lazorkit/wallet/dist/index.js b/node_modules/@lazorkit/wallet/dist/index.js
index 44c171d..276f44c 100644
--- a/node_modules/@lazorkit/wallet/dist/index.js
+++ b/node_modules/@lazorkit/wallet/dist/index.js
@@ -1,2 +1,2 @@
-"use strict";var e=require("react/jsx-runtime"),t=require("react"),a=require("@solana/web3.js"),r=require("zustand"),n=require("@coral-xyz/anchor"),i=require("buffer"),s=require("js-sha256"),o=require("bs58"),l=require("eventemitter3"),c=require("@solana/wallet-adapter-base"),d=require("@solana/kora"),u=require("@wallet-standard/wallet");function A(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}}),t.default=e,Object.freeze(t)}var p=A(n),g=A(o);function m(e,t){let a;try{a=e()}catch(e){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),n=null!=(t=a.getItem(e))?t:null;return n instanceof Promise?n.then(r):r(n)},setItem:(e,t)=>a.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>a.removeItem(e)}}const h=e=>t=>{try{const a=e(t);return a instanceof Promise?a:{then:e=>h(e)(a),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>h(t)(e)}}},y=(e,t)=>(a,r,n)=>{let i={storage:m(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...e)},r,n);const d=()=>{const e=i.partialize({...r()});return c.setItem(i.name,{state:e,version:i.version})},u=n.setState;n.setState=(e,t)=>(u(e,t),d());const A=e((...e)=>(a(...e),d()),r,n);let p;n.getInitialState=()=>A;const g=()=>{var e,t;if(!c)return;s=!1,o.forEach(e=>{var t;return e(null!=(t=r())?t:A)});const n=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=r())?e:A))||void 0;return h(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate){const t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[n,s]=e;if(p=i.merge(s,null!=(t=r())?t:A),a(p,!0),n)return d()}).then(()=>{null==n||n(p,void 0),p=r(),s=!0,l.forEach(e=>e(p))}).catch(e=>{null==n||n(void 0,e)})};return n.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>s,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},i.skipHydration||g(),p||A},f={PORTAL_URL:"https://portal.lazor.sh",PAYMASTER_URL:"https://lazorkit-paymaster.onrender.com",RPC_ENDPOINT:"https://api.devnet.solana.com"},w={CONNECT:"connect",SIGN:"sign"},b="confirmed",S={WALLET:"lazorkit-wallet",CREDENTIALS:"lazorkit-credentials",PUBLIC_KEY:"PUBLIC_KEY",CREDENTIAL_ID:"CREDENTIAL_ID",SMART_WALLET_ADDRESS:"SMART_WALLET_ADDRESS"},k={getItem:async e=>{try{if("undefined"==typeof window)return null;return localStorage.getItem(e)}catch(t){return console.error("Error reading from localStorage:",t,{key:e}),null}},setItem:async(e,t)=>{try{if("undefined"==typeof window)return;localStorage.setItem(e,t)}catch(a){console.error("Error writing to localStorage:",a,{key:e,valueLength:t.length})}},removeItem:async e=>{try{if("undefined"==typeof window)return;localStorage.removeItem(e)}catch(t){console.error("Error removing from localStorage:",t,{key:e})}}};class I{static async saveWallet(e){try{await k.setItem(S.WALLET,JSON.stringify(e)),await k.setItem(S.CREDENTIAL_ID,e.credentialId),await k.setItem(S.SMART_WALLET_ADDRESS,e.smartWallet),await k.setItem(S.PUBLIC_KEY,i.Buffer.from(e.passkeyPubkey).toString("base64"))}catch(e){throw console.error("Failed to save wallet to storage:",e),e}}static async getWallet(){try{const e=await k.getItem(S.WALLET);return e?JSON.parse(e):null}catch(e){return console.error("Failed to get wallet from storage:",e),null}}static async saveConfig(e){try{await k.setItem("lazorkit-config",JSON.stringify(e))}catch(e){throw console.error("Failed to save config to storage:",e),e}}static async getConfig(){try{const e=await k.getItem("lazorkit-config");return e?JSON.parse(e):null}catch(e){return console.error("Failed to get config from storage:",e),null}}static async clearWallet(){try{await k.removeItem(S.WALLET),await k.removeItem(S.CREDENTIAL_ID),await k.removeItem(S.SMART_WALLET_ADDRESS),await k.removeItem(S.PUBLIC_KEY),await k.removeItem("CREDENTIALS_TIMESTAMP")}catch(e){throw console.error("Failed to clear wallet from storage:",e),e}}static async getItem(e){return await k.getItem(e)}static async setItem(e,t){await k.setItem(e,t)}static async removeItem(e){await k.removeItem(e)}}class v{constructor(e){this.context=e,this.enabled="production"!==process.env.NODE_ENV}debug(e,t){this.enabled&&console.debug(`[${this.context}] ${e}`,t)}info(e,t){console.info(`[${this.context}] ${e}`,t)}warn(e,t){console.warn(`[${this.context}] ${e}`,t)}error(e,t){console.error(`[${this.context}] ${e}`,t)}}class P{constructor(e){this.logger=new v("Paymaster"),this.endpoint=e.paymasterUrl,this.apiKey=e.apiKey}getHeaders(){const e={"Content-Type":"application/json"};return this.apiKey&&(e["x-api-key"]=this.apiKey),e}async getPayer(){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getPayerSigner",params:[]})});if(!e.ok)throw new Error(`Failed to get payer: ${e.statusText}`);const t=await e.json();return new a.PublicKey(t.result.signer_address)}catch(e){throw this.logger.error("Failed to get payer",e),e}}async getBlockhash(){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"getBlockhash",id:1,params:[]})});if(!e.ok)throw new Error(`Failed to get blockhash: ${e.statusText}`);return(await e.json()).result.blockhash}catch(e){throw this.logger.error("Failed to get blockhash",e),e}}async attemptSign(e,t=1){try{const t=e.serialize({verifySignatures:!1,requireAllSignatures:!1}),r=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signTransaction",id:1,params:[t.toString("base64")]})});if(!r.ok)throw new Error(`Failed to sign transaction: ${r.statusText}`);const n=await r.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return a.Transaction.from(i.Buffer.from(n.result.signed_transaction,"base64"))}catch(e){throw this.logger.error(`Sign attempt ${t} failed:`,e),e}}async sign(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSign(e,r)}catch(e){if(r===t)throw this.logger.error("All sign retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying sign in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign transaction after all retries")}async attemptSignAndSend(e,t=1){try{const t=e.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[t.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign and send transaction: ${a.statusText}`);const r=await a.json();if(r.error)throw new Error(r.error.message||"Unknown paymaster error");return r.result.signature}catch(e){throw this.logger.error(`Attempt ${t} failed:`,e),e}}async signAndSend(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSignAndSend(e,r)}catch(e){if(r===t)throw this.logger.error("All retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign and send transaction after all retries")}async attemptSignAndSendVersionedTransaction(e,t=1){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[i.Buffer.from(e.serialize()).toString("base64")]})});if(!t.ok)throw new Error(`Failed to sign and send transaction: ${t.statusText}`);const a=await t.json();if(a.error)throw new Error(a.error.message||"Unknown paymaster error");return a.result.signature}catch(e){throw this.logger.error(`Attempt ${t} failed:`,e),e}}async signAndSendVersionedTransaction(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSignAndSendVersionedTransaction(e,r)}catch(e){if(r===t)throw this.logger.error("All retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign and send transaction after all retries")}}var C,D={address:"Gsuz7YcA5sbMGVRXT3xSYhJBessW4xFC4xYsihNCqMFh",metadata:{name:"lazorkit",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},docs:["LazorKit: Smart Wallet with WebAuthn Passkey Authentication"],instructions:[{name:"create_chunk",discriminator:[83,226,15,219,9,19,186,90],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"wallet_state.last_nonce",account:"WalletState"}]}},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateChunkArgs"}}}]},{name:"create_smart_wallet",discriminator:[129,39,235,18,132,68,203,19],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"arg",path:"args.wallet_id"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"policy_program"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateSmartWalletArgs"}}}]},{name:"execute",discriminator:[130,221,242,154,13,193,189,29],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"cpi_program"},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"ExecuteArgs"}}}]},{name:"execute_chunk",discriminator:[106,83,113,47,89,243,39,220],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"instruction_data_list",type:{vec:"bytes"}},{name:"split_index",type:"bytes"}]}],accounts:[{name:"Chunk",discriminator:[134,67,80,65,135,143,156,196]},{name:"WalletDevice",discriminator:[35,85,31,31,179,48,136,123]},{name:"WalletState",discriminator:[126,186,0,158,92,223,167,68]}],errors:[{code:6e3,name:"PasskeyMismatch",msg:"Passkey public key mismatch with stored authenticator"},{code:6001,name:"InvalidPolicyDataSize",msg:"Invalid policy data size"},{code:6002,name:"Secp256r1InvalidLength",msg:"Secp256r1 instruction has invalid data length"},{code:6003,name:"Secp256r1HeaderMismatch",msg:"Secp256r1 instruction header validation failed"},{code:6004,name:"Secp256r1DataMismatch",msg:"Secp256r1 signature data validation failed"},{code:6005,name:"InvalidSignature",msg:"Invalid signature provided for passkey verification"},{code:6006,name:"ClientDataInvalidUtf8",msg:"Client data JSON is not valid UTF-8"},{code:6007,name:"ClientDataJsonParseError",msg:"Client data JSON parsing failed"},{code:6008,name:"ChallengeMissing",msg:"Challenge field missing from client data JSON"},{code:6009,name:"ChallengeBase64DecodeError",msg:"Challenge base64 decoding failed"},{code:6010,name:"ChallengeDeserializationError",msg:"Challenge message deserialization failed"},{code:6011,name:"HashMismatch",msg:"Message hash mismatch: expected different value"},{code:6012,name:"InvalidInstructionDiscriminator",msg:"Invalid instruction discriminator"},{code:6013,name:"InsufficientCpiAccounts",msg:"Insufficient remaining accounts for CPI instruction"},{code:6014,name:"AccountSliceOutOfBounds",msg:"Account slice index out of bounds"},{code:6015,name:"InvalidAccountOwner",msg:"Account owner verification failed"},{code:6016,name:"ProgramNotExecutable",msg:"Program not executable"},{code:6017,name:"CredentialIdEmpty",msg:"Credential ID cannot be empty"},{code:6018,name:"PolicyDataTooLarge",msg:"Policy data exceeds maximum allowed size"},{code:6019,name:"TransactionTooOld",msg:"Transaction is too old"},{code:6020,name:"InvalidInstructionData",msg:"Invalid instruction data"},{code:6021,name:"InvalidInstruction",msg:"Invalid instruction"},{code:6022,name:"InsufficientBalanceForFee",msg:"Insufficient balance for fee"},{code:6023,name:"InvalidSequenceNumber",msg:"Invalid sequence number"},{code:6024,name:"InvalidPasskeyFormat",msg:"Invalid passkey format"},{code:6025,name:"ReentrancyDetected",msg:"Reentrancy detected"},{code:6026,name:"UnauthorizedAdmin",msg:"Unauthorized admin"}],types:[{name:"Chunk",docs:["Transaction chunk for deferred execution","","Created after full passkey and policy verification. Contains all bindings","necessary to execute the transaction later without re-verification.","Used for large transactions that need to be split into manageable chunks."],type:{kind:"struct",fields:[{name:"owner_wallet_address",docs:["Smart wallet address that authorized this chunk session"],type:"pubkey"},{name:"cpi_hash",docs:["Combined SHA256 hash of all cpi transaction instruction data"],type:{array:["u8",32]}},{name:"authorized_nonce",docs:["The nonce that was authorized at chunk creation (bound into data hash)"],type:"u64"},{name:"authorized_timestamp",docs:["Timestamp from the original message hash for expiration validation"],type:"i64"},{name:"rent_refund_address",docs:["Address to receive rent refund when closing the chunk session"],type:"pubkey"}]}},{name:"CreateChunkArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"policy_data",type:"bytes"},{name:"timestamp",type:"i64"},{name:"cpi_hash",type:{array:["u8",32]}}]}},{name:"CreateSmartWalletArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"init_policy_data",type:"bytes"},{name:"wallet_id",type:"u64"},{name:"amount",type:"u64"},{name:"policy_data_size",type:"u16"}]}},{name:"ExecuteArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"split_index",type:"u16"},{name:"policy_data",type:"bytes"},{name:"cpi_data",type:"bytes"},{name:"timestamp",type:"i64"}]}},{name:"WalletDevice",docs:["Wallet device account linking a passkey to a smart wallet"],type:{kind:"struct",fields:[{name:"passkey_pubkey",docs:["Secp256r1 compressed public key (33 bytes)"],type:{array:["u8",33]}},{name:"credential_hash",docs:["SHA256 hash of the credential ID"],type:{array:["u8",32]}},{name:"smart_wallet",docs:["Associated smart wallet address"],type:"pubkey"},{name:"bump",docs:["PDA bump seed"],type:"u8"}]}},{name:"WalletState",docs:["Wallet state account storing wallet configuration and execution state"],type:{kind:"struct",fields:[{name:"bump",docs:["PDA bump seed for smart wallet"],type:"u8"},{name:"wallet_id",docs:["Unique wallet identifier"],type:"u64"},{name:"last_nonce",docs:["Last used nonce for anti-replay protection"],type:"u64"},{name:"policy_program",docs:["Policy program that validates transactions"],type:"pubkey"},{name:"policy_data",docs:["Serialized policy data returned from policy initialization"],type:"bytes"}]}}]};function W(e,t){return e.keys.map(e=>({pubkey:e.pubkey,isWritable:e.isWritable,isSigner:!!t&&t.some(t=>t.toString()===e.pubkey.toString())}))}function E(e){if("function"==typeof globalThis.crypto?.getRandomValues){const t=new Uint8Array(e);return globalThis.crypto.getRandomValues(t),t}try{const{randomBytes:t}=require("crypto");return t(e)}catch{throw new Error("No CSPRNG available")}}function B(e){const t=i.Buffer.from(e,"base64");return Array.from(new Uint8Array(s.sha256.arrayBuffer(t)))}async function x(e){const t=await e.getSlot(),a=await e.getBlockTime(t);if(null===a)throw new Error("Failed to get blockchain timestamp");return new p.BN(a)}async function T(e,t,a){let r=0;for(;r<3;){try{const r=await t.getWalletStateData(a),n=t.getChunkPubkey(a,r.lastNonce);if(await e.getAccountInfo(n))return}catch(e){console.warn(`Attempt ${r+1} failed to find chunk:`,e)}r++,r<3&&await new Promise(e=>setTimeout(e,3e3))}throw new Error("Chunk not found")}function U(e){return e}function R(e){return e}exports.SmartWalletAction=void 0,(C=exports.SmartWalletAction||(exports.SmartWalletAction={})).CreateChunk="create_chunk",C.ExecuteChunk="execute_chunk";var M={address:"BiE9vSdz9MidUiyjVYsu3PG4C1fbPZ8CVPADA9jRfXw7",metadata:{name:"default_policy",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},instructions:[{name:"check_policy",discriminator:[28,88,170,179,239,136,25,35],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet"}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"policy_data",type:"bytes"}]},{name:"init_policy",discriminator:[45,234,110,100,209,146,191,86],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}],returns:{defined:{name:"PolicyStruct"}}}],errors:[{code:6e3,name:"InvalidPasskey",msg:"Invalid passkey format"},{code:6001,name:"Unauthorized",msg:"Unauthorized to access smart wallet"}],types:[{name:"DeviceSlot",type:{kind:"struct",fields:[{name:"passkey_pubkey",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}]}},{name:"PolicyStruct",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"smart_wallet",type:"pubkey"},{name:"device_slots",type:{vec:{defined:{name:"DeviceSlot"}}}}]}}]};const H=i.Buffer.from("policy");const Q=890880;class K extends Error{constructor(e,t){super(e),this.field=t,this.name="ValidationError"}}function N(e,t){if(null==e||void 0===e){throw new K(`${t} is required but was ${null===e?"null":"undefined"}`,t)}}function O(e,t){N(e,t);try{if("string"==typeof e){if(0===e.trim().length)throw new K(`${t} cannot be an empty string`,t);new p.web3.PublicKey(e)}else{if(!(e instanceof p.web3.PublicKey||e&&"object"==typeof e&&"toBase58"in e&&"function"==typeof e.toBase58&&"toBytes"in e&&"function"==typeof e.toBytes))throw new K(`${t} must be a PublicKey instance or valid base58 string`,t)}}catch(e){if(e instanceof K)throw e;throw new K(`${t} is not a valid PublicKey: ${e instanceof Error?e.message:"Invalid format"}`,t)}}function z(e,t,a){let r;if(N(e,a),Array.isArray(e))r=e;else if(e instanceof Uint8Array)r=Array.from(e);else{if(!e||"object"!=typeof e||"number"!=typeof e.length)throw new K(`${a} must be an array or Uint8Array`,a);r=Array.from(e)}if(r.length!==t)throw new K(`${a} must be exactly ${t} bytes, got ${r.length}`,a);for(let e=0;e<r.length;e++){const t=r[e];if("number"!=typeof t||!Number.isFinite(t)||!Number.isInteger(t)||t<0||t>255)throw new K(`${a}[${e}] must be a valid byte (0-255), got ${"number"==typeof t?t:typeof t}`,a)}}function L(e,t="passkeyPublicKey"){z(e,33,t)}function V(e,t="credentialHash"){z(e,32,t)}function F(e,t="signature"){z(e,64,t)}function j(e,t){N(e,t);if(!(e instanceof p.BN||e&&"object"==typeof e&&"lt"in e&&"function"==typeof e.lt&&"toString"in e&&"function"==typeof e.toString))throw new K(`${t} must be a BN instance`,t);if(e.lt(new p.BN(0)))throw new K(`${t} must be non-negative, got ${e.toString()}`,t)}function _(e,t){if(N(e,t),"string"!=typeof e)throw new K(`${t} must be a string (got ${typeof e})`,t);if(0===String(e).trim().length)throw new K(`${t} cannot be empty`,t)}function G(e,t){if(N(e,t),!Array.isArray(e))throw new K(`${t} must be an array (got ${typeof e}${e&&"object"==typeof e?` with constructor ${e.constructor?.name||"unknown"}`:""})`,t);if(0===e.length)throw new K(`${t} cannot be empty`,t)}function J(e,t){N(e,t);if(!(e instanceof p.web3.TransactionInstruction||e&&"object"==typeof e&&"programId"in e&&"keys"in e&&Array.isArray(e.keys)&&"data"in e))throw new K(`${t} must be a TransactionInstruction instance`,t);if(O(e.programId,`${t}.programId`),!e.keys||!Array.isArray(e.keys)||0===e.keys.length)throw new K(`${t} must have at least one account key`,t)}function Z(e){return Array.isArray(e)?e:Array.from(e)}function Y(e,t){_(e,t);if(!/^[A-Za-z0-9+/]*={0,2}$/.test(e))throw new K(`${t} is not a valid base64 string (invalid characters)`,t);try{"undefined"!=typeof Buffer&&Buffer.from?Buffer.from(e,"base64"):"undefined"!=typeof atob&&atob(e)}catch(e){throw new K(`${t} is not a valid base64 string: ${e instanceof Error?e.message:"Invalid format"}`,t)}}function X(e,t){if(N(e,t),"number"!=typeof e||!Number.isFinite(e)||Number.isNaN(e))throw new K(`${t} must be a finite number (got ${Number.isNaN(e)?"NaN":Number.isFinite(e)?typeof e:e===1/0?"Infinity":"-Infinity"})`,t);if(!Number.isInteger(e))throw new K(`${t} must be an integer, got ${e}`,t);if(e<=0)throw new K(`${t} must be a positive integer, got ${e}`,t)}function q(e,t){if(N(e,t),!Array.isArray(e))throw new K(`${t} must be an array (got ${typeof e})`,t);e.forEach((e,a)=>{O(e,`${t}[${a}]`)})}function $(e,t){G(e,t),e.forEach((e,a)=>{J(e,`${t}[${a}]`)})}function ee(e){return Array.isArray(e)?[...e]:Array.from(e)}function te(e,t="passkeySignature"){if(N(e,t),"object"!=typeof e||null===e)throw new K(`${t} must be an object`,t);L(e.passkeyPublicKey,`${t}.passkeyPublicKey`),Y(e.signature64,`${t}.signature64`),Y(e.clientDataJsonRaw64,`${t}.clientDataJsonRaw64`),Y(e.authenticatorDataRaw64,`${t}.authenticatorDataRaw64`)}class ae{constructor(e){N(e,"connection"),this.connection=e,this.program=new p.Program(M,{connection:e}),this.programId=this.program.programId}policyPda(e){return O(e,"smartWallet"),function(e,t){return p.web3.PublicKey.findProgramAddressSync([H,t.toBuffer()],e)[0]}(this.programId,e)}getPolicyDataSize(){return 102}validateInitPolicyParams(e){N(e,"params"),j(e.walletId,"params.walletId"),L(e.passkeyPublicKey,"params.passkeyPublicKey"),V(e.credentialHash,"params.credentialHash"),O(e.policySigner,"params.policySigner"),O(e.smartWallet,"params.smartWallet"),O(e.walletState,"params.walletState")}async buildInitPolicyIx(e){return this.validateInitPolicyParams(e),await this.program.methods.initPolicy(e.walletId,ee(e.passkeyPublicKey),ee(e.credentialHash)).accountsPartial({smartWallet:e.smartWallet,walletState:e.walletState,policySigner:e.policySigner}).instruction()}validateCheckPolicyParams(e){if(N(e,"params"),j(e.walletId,"params.walletId"),L(e.passkeyPublicKey,"params.passkeyPublicKey"),O(e.policySigner,"params.policySigner"),O(e.smartWallet,"params.smartWallet"),V(e.credentialHash,"params.credentialHash"),N(e.policyData,"params.policyData"),!Buffer.isBuffer(e.policyData))throw new K("params.policyData must be a Buffer instance","params.policyData")}async buildCheckPolicyIx(e){return this.validateCheckPolicyParams(e),await this.program.methods.checkPolicy(e.walletId,ee(e.passkeyPublicKey),ee(e.credentialHash),e.policyData).accountsPartial({smartWallet:e.smartWallet,policySigner:e.policySigner}).instruction()}}const re=i.Buffer.from("smart_wallet"),ne=i.Buffer.from("wallet_state"),ie=i.Buffer.from("wallet_device"),se=i.Buffer.from("chunk");function oe(e,t){return p.web3.PublicKey.findProgramAddressSync([re,t.toArrayLike(i.Buffer,"le",8)],e)[0]}function le(e,t){return p.web3.PublicKey.findProgramAddressSync([ne,t.toBuffer()],e)[0]}function ce(e,t){const a=i.Buffer.concat([e.toBuffer(),i.Buffer.from(t)]),r=s.sha256.arrayBuffer(a);return i.Buffer.from(r).subarray(0,32)}function de(e,t,a){return p.web3.PublicKey.findProgramAddressSync([ie,ce(t,a)],e)}function ue(e,t,a){return p.web3.PublicKey.findProgramAddressSync([se,t.toBuffer(),a.toArrayLike(i.Buffer,"le",8)],e)[0]}class Ae{constructor(e){this.programId=e}smartWallet(e){return j(e,"walletId"),oe(this.programId,e)}walletState(e){return O(e,"smartWallet"),le(this.programId,e)}walletDevice(e,t){return O(e,"smartWallet"),V(t,"credentialHash"),de(this.programId,e,t)[0]}chunk(e,t){return O(e,"smartWallet"),ue(this.programId,e,t)}}class pe{constructor(e,t){this.policyClient=e,this.walletPdas=t}async resolveForExecute({provided:e,smartWallet:t,credentialHash:a,passkeyPublicKey:r,walletStateData:n}){if(void 0!==e)return e;const i=this.walletPdas.walletDevice(t,a);return this.policyClient.buildCheckPolicyIx({walletId:n.walletId,passkeyPublicKey:r,policySigner:i,smartWallet:t,credentialHash:a,policyData:n.policyData})}async resolveForCreate({provided:e,smartWalletId:t,smartWallet:a,walletState:r,passkeyPublicKey:n,credentialHash:i}){if(void 0!==e)return e;const s=this.walletPdas.walletDevice(a,i);return this.policyClient.buildInitPolicyIx({walletId:t,passkeyPublicKey:n,credentialHash:i,policySigner:s,smartWallet:a,walletState:r})}}let ge=null;const me=e=>new Uint8Array(s.sha256.arrayBuffer(e)),he=(e,t,a)=>{const r=s.sha256.create();r.update(e.toBytes());for(const e of t)r.update(e.pubkey.toBytes()),r.update(Uint8Array.from([e.isSigner?1:0])),r.update(Uint8Array.from([e.pubkey.toString()===a.toString()||e.isWritable?1:0]));return new Uint8Array(r.arrayBuffer())},ye=(e,t)=>{const a=W(e),r=he(e.programId,a,t);return{policyDataHash:me(e.data),policyAccountsHash:r}},fe=(e,t,a)=>{const r=i.Buffer.alloc(4);r.writeUInt32LE(e.length,0);const n=i.Buffer.concat([r,...e.map(e=>{const t=i.Buffer.from(e.data),a=i.Buffer.alloc(4);return a.writeUInt32LE(t.length,0),i.Buffer.concat([a,t])})]),o=me(n),l=((e,t)=>{const a=new Map;for(const t of e){const e=t.pubkey.toString(),r=a.get(e);r?(r.isSigner=r.isSigner||t.isSigner,r.isWritable=r.isWritable||t.isWritable):a.set(e,{isSigner:t.isSigner,isWritable:t.isWritable})}const r=e.map(e=>{const t=e.pubkey.toString(),r=a.get(t);return{pubkey:e.pubkey,isSigner:r.isSigner,isWritable:r.isWritable}}),n=s.sha256.create();for(const e of r)n.update(e.pubkey.toBytes()),n.update(Uint8Array.from([e.isSigner?1:0])),n.update(Uint8Array.from([e.pubkey.toString()===t.toString()||e.isWritable?1:0]));return new Uint8Array(n.arrayBuffer())})(e.flatMap(e=>[{pubkey:e.programId,isSigner:!1,isWritable:!1},...W(e,a)]),t);return{cpiDataHash:o,cpiAccountsHash:l}},we=(e,t)=>{try{const a=(ge||(ge=new p.BorshCoder({version:"0.1.0",name:"lazorkit_msgs",instructions:[],accounts:[],types:[{name:"SimpleMessage",type:{kind:"struct",fields:[{name:"dataHash",type:{array:["u8",32]}}]}}]})),ge).types.encode(e,t);return i.Buffer.from(a)}catch(t){throw new Error(`Failed to encode ${e}: ${t instanceof Error?t.message:"Unknown error"}`)}};function be(e,t,a,r,n,s){const o=ye(r,e),l=fe(n,e,s),c=new Uint8Array(64);c.set(o.policyDataHash,0),c.set(o.policyAccountsHash,32);const d=me(c),u=new Uint8Array(64);u.set(l.cpiDataHash,0),u.set(l.cpiAccountsHash,32);const A=me(u),p=i.Buffer.alloc(8);p.writeBigUInt64LE(BigInt(t.toString()),0);const g=i.Buffer.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=i.Buffer.concat([p,g,i.Buffer.from(d),i.Buffer.from(A)]),h=me(m);return we("SimpleMessage",{dataHash:Array.from(h)})}const Se=new p.web3.PublicKey("Secp256r1SigVerify1111111111111111111111111");function ke(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);{const t=new ArrayBuffer(2*Object.values(e).length),a=new DataView(t);return Object.values(e).forEach((e,t)=>{a.setUint16(2*t,e,!0)}),new Uint8Array(t)}}function Ie(e){L(e.passkeyPublicKey,"passkeySignature.passkeyPublicKey"),Y(e.signature64,"passkeySignature.signature64"),Y(e.clientDataJsonRaw64,"passkeySignature.clientDataJsonRaw64"),Y(e.authenticatorDataRaw64,"passkeySignature.authenticatorDataRaw64");const t=Buffer.from(e.authenticatorDataRaw64,"base64"),a=Buffer.from(e.clientDataJsonRaw64,"base64"),r=Buffer.from(e.signature64,"base64");F(Z(r),"passkeySignature.signature64 (decoded)");return function(e,t,a){if(33!==t.length||64!==a.length)throw new Error("Invalid key or signature length");const r=113+e.length,n=new Uint8Array(r);n.set(ke([1,0]),0);const s={signature_offset:49,signature_instruction_index:65535,public_key_offset:16,public_key_instruction_index:65535,message_data_offset:113,message_data_size:e.length,message_instruction_index:65535};return n.set(ke(s),2),n.set(t,16),n.set(a,49),n.set(e,113),new p.web3.TransactionInstruction({keys:[],programId:Se,data:i.Buffer.from(n)})}(Buffer.concat([t,Buffer.from(s.sha256.arrayBuffer(a))]),e.passkeyPublicKey,r)}function ve(e){const t=Buffer.from(e.signature64,"base64");return F(Z(t),"passkeySignature.signature64 (decoded)"),{passkeyPublicKey:e.passkeyPublicKey,signature:Z(t),clientDataJsonRaw:Buffer.from(e.clientDataJsonRaw64,"base64"),authenticatorDataRaw:Buffer.from(e.authenticatorDataRaw64,"base64")}}function Pe(e){return p.web3.ComputeBudgetProgram.setComputeUnitLimit({units:e})}function Ce(e,t){return void 0===t?e:[Pe(t),...e]}function De(e,t){return[e,...t]}function We(e){return void 0!==e?1:0}async function Ee(e,t,a,r={}){const{addressLookupTables:n,recentBlockhash:i,computeUnitLimit:s}=r,o=Ce(a,s),l=void 0!==n&&n.length>0,c=i||(await e.getLatestBlockhash()).blockhash;if(l){const e=new p.web3.TransactionMessage({payerKey:t,recentBlockhash:c,instructions:o}).compileToV0Message([...n]);return{transaction:new p.web3.VersionedTransaction(e),isVersioned:!0,recentBlockhash:c}}{const e=(new p.web3.Transaction).add(...o);return e.feePayer=t,e.recentBlockhash=c,{transaction:e,isVersioned:!1,recentBlockhash:c}}}global.Buffer=i.Buffer,i.Buffer.prototype.subarray=function(e,t){const a=Uint8Array.prototype.subarray.apply(this,[e,t]);return Object.setPrototypeOf(a,i.Buffer.prototype),a};class Be{constructor(e){this.connection=e,this.program=new p.Program(D,{connection:e}),this.programId=this.program.programId,this.defaultPolicyProgram=new ae(e),this.walletPdas=new Ae(this.programId),this.policyResolver=new pe(this.defaultPolicyProgram,this.walletPdas)}getSmartWalletPubkey(e){return this.walletPdas.smartWallet(e)}getWalletStatePubkey(e){return this.walletPdas.walletState(e)}getWalletDevicePubkey(e,t){return this.walletPdas.walletDevice(e,t)}getChunkPubkey(e,t){return this.walletPdas.chunk(e,t)}generateWalletId(){return new p.BN(E(8),"le")}async fetchWalletStateContext(e){const t=this.getWalletStatePubkey(e);return{walletState:t,data:await this.program.account.walletState.fetch(t)}}async fetchChunkContext(e,t){const a=this.getChunkPubkey(e,t);return{chunk:a,data:await this.program.account.chunk.fetch(a)}}validateCreateSmartWalletParams(e){N(e,"params"),O(e.payer,"params.payer"),L(e.passkeyPublicKey,"params.passkeyPublicKey"),Y(e.credentialIdBase64,"params.credentialIdBase64"),void 0!==e.amount&&j(e.amount,"params.amount"),void 0!==e.smartWalletId&&j(e.smartWalletId,"params.smartWalletId"),void 0!==e.policyDataSize&&X(e.policyDataSize,"params.policyDataSize"),void 0!==e.policyInstruction&&J(e.policyInstruction,"params.policyInstruction")}validateExecuteParams(e){N(e,"params"),O(e.payer,"params.payer"),O(e.smartWallet,"params.smartWallet"),te(e.passkeySignature,"params.passkeySignature"),V(e.credentialHash,"params.credentialHash"),J(e.cpiInstruction,"params.cpiInstruction"),j(e.timestamp,"params.timestamp"),void 0!==e.policyInstruction&&J(e.policyInstruction,"params.policyInstruction"),void 0!==e.cpiSigners&&q(e.cpiSigners,"params.cpiSigners")}validateCreateChunkParams(e){N(e,"params"),O(e.payer,"params.payer"),O(e.smartWallet,"params.smartWallet"),te(e.passkeySignature,"params.passkeySignature"),V(e.credentialHash,"params.credentialHash"),$(e.cpiInstructions,"params.cpiInstructions"),j(e.timestamp,"params.timestamp"),void 0!==e.policyInstruction&&J(e.policyInstruction,"params.policyInstruction"),void 0!==e.cpiSigners&&q(e.cpiSigners,"params.cpiSigners")}validateExecuteChunkParams(e){N(e,"params"),O(e.payer,"params.payer"),O(e.smartWallet,"params.smartWallet"),$(e.cpiInstructions,"params.cpiInstructions"),void 0!==e.cpiSigners&&q(e.cpiSigners,"params.cpiSigners")}async getWalletStateData(e){const{data:t}=await this.fetchWalletStateContext(e);return t}async getChunkData(e){return await this.program.account.chunk.fetch(e)}async getSmartWalletByCredentialHash(e){V(e,"credentialHash");const t=D.accounts?.find(e=>"WalletDevice"===e.name)?.discriminator;if(!t)throw new K("WalletDevice discriminator not found in IDL","credentialHash");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:g.default.encode(t)}},{memcmp:{offset:41,bytes:g.default.encode(e)}}]});if(0===a.length)return null;for(const e of a){const t=await this.program.account.walletDevice.fetch(e.pubkey);return{smartWallet:t.smartWallet,walletState:this.getWalletStatePubkey(t.smartWallet),walletDevice:e.pubkey,passkeyPublicKey:t.passkeyPubkey}}return null}async buildCreateSmartWalletIns(e,t,a,r){return O(e,"payer"),O(t,"smartWallet"),J(a,"policyInstruction"),N(r,"args"),L(r.passkeyPublicKey,"args.passkeyPublicKey"),V(r.credentialHash,"args.credentialHash"),j(r.walletId,"args.walletId"),j(r.amount,"args.amount"),await this.program.methods.createSmartWallet(r).accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),walletDevice:this.getWalletDevicePubkey(t,r.credentialHash),policyProgram:a.programId,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(a)]).instruction()}async buildExecuteIns(e,t,a,r,n,i,s){return O(e,"payer"),O(t,"smartWallet"),O(a,"walletDevice"),N(r,"args"),J(n,"policyInstruction"),J(i,"cpiInstruction"),void 0!==s&&q(s,"cpiSigners"),await this.program.methods.execute(r).accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),walletDevice:a,policyProgram:n.programId,cpiProgram:i.programId,ixSysvar:p.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(n),...W(i,s)]).instruction()}async buildCreateChunkIns(e,t,a,r,n){O(e,"payer"),O(t,"smartWallet"),O(a,"walletDevice"),N(r,"args"),J(n,"policyInstruction");const{walletState:i,data:s}=await this.fetchWalletStateContext(t),o=this.getChunkPubkey(t,s.lastNonce);return await this.program.methods.createChunk(r).accountsPartial({payer:e,smartWallet:t,walletState:i,walletDevice:a,policyProgram:n.programId,chunk:o,ixSysvar:p.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(n)]).instruction()}async buildExecuteChunkIns(e,t,a,r){O(e,"payer"),O(t,"smartWallet"),$(a,"cpiInstructions"),void 0!==r&&q(r,"cpiSigners");const{data:n,walletState:s}=await this.fetchWalletStateContext(t),{chunk:o,data:l}=await this.fetchChunkContext(t,n.lastNonce),c=a.map(e=>i.Buffer.from(e.data)),d=function(e){const t=[];let a=0;for(let r=0;r<e.length-1;r++)a+=e[r].keys.length+1,t.push(a);return t}(a),u=function(e,t){return e.flatMap(e=>[{pubkey:e.programId,isSigner:!1,isWritable:!1},...W(e,t)])}(a,r);return await this.program.methods.executeChunk(c,i.Buffer.from(d)).accountsStrict({payer:e,smartWallet:t,walletState:s,chunk:o,sessionRefund:l.rentRefundAddress,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts(u).instruction()}async createSmartWalletTxn(e,t={}){this.validateCreateSmartWalletParams(e);const a=e.smartWalletId??this.generateWalletId(),r=this.getSmartWalletPubkey(a),n=this.getWalletStatePubkey(r),i=e.amount??new p.BN(Q),s=e.policyDataSize??this.defaultPolicyProgram.getPolicyDataSize(),o=B(e.credentialIdBase64),l=await this.policyResolver.resolveForCreate({provided:e.policyInstruction,smartWalletId:a,smartWallet:r,walletState:n,passkeyPublicKey:e.passkeyPublicKey,credentialHash:o}),c={passkeyPublicKey:e.passkeyPublicKey,credentialHash:o,initPolicyData:l.data,walletId:a,amount:i,policyDataSize:s},d=await this.buildCreateSmartWalletIns(e.payer,r,l,c);return{transaction:(await Ee(this.connection,e.payer,[d],t)).transaction,smartWalletId:a,smartWallet:r}}async executeTxn(e,t={}){this.validateExecuteParams(e);const a=Ie(e.passkeySignature),r=await this.getWalletStateData(e.smartWallet),n=this.getWalletDevicePubkey(e.smartWallet,e.credentialHash),i=await this.policyResolver.resolveForExecute({provided:e.policyInstruction,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:e.passkeySignature.passkeyPublicKey,walletStateData:r}),s=ve(e.passkeySignature),o=De(a,[await this.buildExecuteIns(e.payer,e.smartWallet,n,{...s,verifyInstructionIndex:We(t.computeUnitLimit),splitIndex:i.keys.length,policyData:i.data,cpiData:e.cpiInstruction.data,timestamp:e.timestamp},i,e.cpiInstruction,[...e.cpiSigners??[],e.payer])]);return(await Ee(this.connection,e.payer,o,t)).transaction}async createChunkTxn(e,t={}){this.validateCreateChunkParams(e);const a=Ie(e.passkeySignature),r=await this.getWalletStateData(e.smartWallet),n=this.getWalletDevicePubkey(e.smartWallet,e.credentialHash),i=await this.policyResolver.resolveForExecute({provided:e.policyInstruction,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:e.passkeySignature.passkeyPublicKey,walletStateData:r}),o=ve(e.passkeySignature),l=function(e,t,a){const r=fe(e,t,a),n=new Uint8Array(64);return n.set(r.cpiDataHash,0),n.set(r.cpiAccountsHash,32),Array.from(new Uint8Array(s.sha256.arrayBuffer(n)))}(e.cpiInstructions,e.smartWallet,[...e.cpiSigners??[],e.payer]),c=De(a,[await this.buildCreateChunkIns(e.payer,e.smartWallet,n,{...o,policyData:i.data,verifyInstructionIndex:We(t.computeUnitLimit),timestamp:e.timestamp,cpiHash:Array.from(l)},i)]);return(await Ee(this.connection,e.payer,c,t)).transaction}async executeChunkTxn(e,t={}){this.validateExecuteChunkParams(e);const a=await this.buildExecuteChunkIns(e.payer,e.smartWallet,e.cpiInstructions,e.cpiSigners);return(await Ee(this.connection,e.payer,[a],t)).transaction}async buildAuthorizationMessage(e){let t;const{action:a,smartWallet:r,passkeyPublicKey:n,timestamp:i}=e;switch(a.type){case exports.SmartWalletAction.CreateChunk:{const{policyInstruction:s,cpiInstructions:o,cpiSigners:l}=a.args,c=await this.getWalletStateData(e.smartWallet),d=await this.policyResolver.resolveForExecute({provided:s,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:n,walletStateData:c});t=be(r,(await this.getWalletStateData(r)).lastNonce,i,d,o,[...l??[],e.payer]);break}default:throw new K(`Unsupported SmartWalletAction: ${a.type}`,"action.type")}return t}}"function"!=typeof globalThis.structuredClone&&(globalThis.structuredClone=e=>JSON.parse(JSON.stringify(e)));class xe extends l.EventEmitter{constructor(){super(),this.iframeRef=null,this.retryDelays=[200,400,800,1500,3e3]}setIframeRef(e){this.iframeRef=e}notifyCredentialsUpdated(e){this.emit("credentials-updated",e);const t=new CustomEvent("lazorkit:credentials-updated",{detail:e,bubbles:!0,cancelable:!0});window.dispatchEvent(t)}syncCredentials(e=!1){this.iframeRef&&this.iframeRef.contentWindow?this.performCredentialSync(e):setTimeout(()=>this.syncCredentials(e),500)}performCredentialSync(e){if(!this.iframeRef?.contentWindow)throw new Error("Cannot sync credentials: iframe reference not available");const t=localStorage.getItem("CREDENTIAL_ID")||"",a=localStorage.getItem("PUBLIC_KEY")||"",r=localStorage.getItem("SMART_WALLET_ADDRESS")||"";if(!(e||t&&a))return;const n={type:"SYNC_CREDENTIALS",data:{credentialId:t,publickey:a,smartWalletAddress:r,timestamp:Date.now()}};try{this.iframeRef.contentWindow.postMessage(n,"*"),this.retryDelays.forEach(e=>{setTimeout(()=>{try{this.iframeRef?.contentWindow&&this.iframeRef.contentWindow.postMessage(n,"*")}catch(e){}},e)})}catch(e){}}storeCredential(e){e.credentialId&&localStorage.setItem("CREDENTIAL_ID",e.credentialId),e.publickey&&localStorage.setItem("PUBLIC_KEY",e.publickey),e.smartWalletAddress&&localStorage.setItem("SMART_WALLET_ADDRESS",e.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",(new Date).toISOString())}destroy(){this.removeAllListeners(),this.iframeRef=null}}class Te extends l.EventEmitter{constructor(e){super(),this.dialogRef=null,this.iframeRef=null,this.popupWindow=null,this.popupCloseInterval=null,this.isClosing=!1,this.isDestroyed=!1,this.logger=new v("DialogManager"),this._currentAction=null,this.config=e,this.credentialManager=new xe,this.logger.debug("Created dialog manager"),this.setupMessageListener()}async openConnect(){return new Promise((e,t)=>{const a=()=>{this.off("connect-result",r),this.off("error",n)},r=t=>{a(),e(t)},n=e=>{a(),t(e)};this.on("connect-result",r),this.on("error",n);const i=setTimeout(()=>{a(),t(new Error("Connection timed out after 60 seconds"))},6e4),s=e,o=t;e=e=>{clearTimeout(i),s(e)},t=e=>{clearTimeout(i),o(e)},this._currentAction=w.CONNECT;if(this.shouldUsePopup("connect")){const e=`${this.config.portalUrl}?action=${w.CONNECT}`;this.openPopup(e).catch(t)}else this.openConnectDialog().catch(t)})}async openSign(e,t,a,r){return new Promise((n,i)=>{const s=()=>{this.off("sign-result",o),this.off("error",l)},o=e=>{s(),n(e)},l=e=>{s(),i(e)};this.on("sign-result",o),this.on("error",l);const c=setTimeout(()=>{s(),i(new Error("Signing timed out after 60 seconds"))},6e4),d=n,u=i;n=e=>{clearTimeout(c),d(e)},i=e=>{clearTimeout(c),u(e)},this._currentAction=w.SIGN;const A=this.shouldUsePopup("sign"),p=encodeURIComponent(e);let g=`${this.config.portalUrl}?action=${w.SIGN}&message=${p}&transaction=${encodeURIComponent(t)}&credentialId=${encodeURIComponent(a)}`;r&&(g+=`&clusterSimulation=${r}`),A?this.openPopup(g).catch(i):this.openSignDialog(g).catch(i)})}async openSignMessage(e,t){return new Promise((a,r)=>{const n=()=>{this.off("sign-result",i),this.off("error",s)},i=e=>{n(),a(e)},s=e=>{n(),r(e)};this.on("sign-result",i),this.on("error",s);const o=setTimeout(()=>{n(),r(new Error("Signing timed out after 60 seconds"))},6e4),l=a,c=r;a=e=>{clearTimeout(o),l(e)},r=e=>{clearTimeout(o),c(e)},this._currentAction=w.SIGN;const d=encodeURIComponent(e),u=`${this.config.portalUrl}?action=${w.SIGN}&message=${d}&credentialId=${encodeURIComponent(t)}`;this.shouldUsePopup("sign")?this.openPopup(u).catch(r):this.openSignDialog(u).catch(r)})}async openConnectDialog(){const e=`${this.config.portalUrl}?action=${w.CONNECT}`;await this.openModal(e)}ensureFonts(){const e="lazorkit-font-roboto-flex";if(document.getElementById(e))return;const t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&display=swap",document.head.appendChild(t)}ensureDialogBackdropCSS(){const e="lazorkit-dialog-backdrop-style";if(document.getElementById(e))return;const t=document.createElement("style");t.id=e,t.textContent='\n    /* ===== Backdrop (overlay nh) ===== */\n    dialog#lazorkit-dialog::backdrop {\n      background: rgba(0,0,0,0);\n      animation: lazor-backdrop-in 160ms ease-out forwards;\n    }\n\n    dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n      animation: lazor-backdrop-out 140ms ease-in forwards;\n    }\n\n    @keyframes lazor-backdrop-in {\n      from { background: rgba(0,0,0,0); }\n      to   { background: rgba(0,0,0,0.12); } /*  overlay nh */\n    }\n\n    @keyframes lazor-backdrop-out {\n      from { background: rgba(0,0,0,0.12); }\n      to   { background: rgba(0,0,0,0); }\n    }\n\n    /* ===== Panel animations ===== */\n    @keyframes lazor-drawer-in {\n      from { transform: translateY(16px); opacity: 0.98; }\n      to   { transform: translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-drawer-out {\n      from { transform: translateY(0); opacity: 1; }\n      to   { transform: translateY(16px); opacity: 0.98; }\n    }\n\n    @keyframes lazor-float-in {\n      from { transform: scale(0.985) translateY(4px); opacity: 0; }\n      to   { transform: scale(1) translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-float-out {\n      from { transform: scale(1) translateY(0); opacity: 1; }\n      to   { transform: scale(0.985) translateY(4px); opacity: 0; }\n    }\n\n    #lazorkit-panel {\n      will-change: transform, opacity;\n      transform-origin: center;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-drawer-in 180ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-drawer-out 150ms ease-in forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-float-in 170ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-float-out 140ms ease-in forwards;\n    }\n\n    /* ===== Reduced motion ===== */\n    @media (prefers-reduced-motion: reduce) {\n      dialog#lazorkit-dialog::backdrop {\n        animation: none !important;\n        background: rgba(0,0,0,0.12) !important;\n      }\n      dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n        background: rgba(0,0,0,0) !important;\n      }\n      dialog#lazorkit-dialog #lazorkit-panel {\n        animation: none !important;\n      }\n    }\n  ',document.head.appendChild(t)}createCloseButton(e){const t=document.createElement("button");return t.type="button",t.title="Close Dialog",t.setAttribute("aria-label","Close Dialog"),Object.assign(t.style,{width:"36px",height:"36px",borderRadius:"10px",border:"none",background:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0",color:"rgba(255, 255, 255, 0.6)",outline:"none",webkitTapHighlightColor:"transparent"}),t.addEventListener("mouseenter",()=>{t.style.background="rgba(255,255,255,0.1)",t.style.color="#ffffff"}),t.addEventListener("mouseleave",()=>{t.style.background="transparent",t.style.color="rgba(255, 255, 255, 0.6)"}),t.onclick=e,t.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg"\n      width="20" height="20" viewBox="0 0 24 24"\n      fill="none" stroke="currentColor" stroke-width="2"\n      stroke-linecap="round" stroke-linejoin="round">\n      <line x1="18" y1="6" x2="6" y2="18" />\n      <line x1="6" y1="6" x2="18" y2="18" />\n    </svg>\n  ',t}async openSignDialog(e){await this.openModal(e),this.iframeRef&&(this.credentialManager.setIframeRef(this.iframeRef),setTimeout(()=>{this.credentialManager.syncCredentials(!0)},500))}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}shouldUsePopup(e){const t=this.isMobileDevice();return!(!this.isSafari()||"connect"!==e)||(!(!t||"connect"!==e)||!(!t&&"sign"===e)&&(!t||"sign"!==e))}getPopupDimensions(){if(!window.top)return{width:450,height:600,top:0,left:0};const e=window.top.outerWidth/2+window.top.screenX-225;return{width:450,height:600,top:window.top.outerHeight/2+window.top.screenY-300,left:e}}async openPopup(e){if(this.popupWindow&&!this.popupWindow.closed)try{this.popupWindow.close()}catch(e){}const t=this.getPopupDimensions();if(this.popupWindow=window.open(e,"lazorkit-popup",`width=${t.width},height=${t.height},top=${t.top},left=${t.left},resizable,scrollbars,status`),this.startPopupMonitor(),!this.popupWindow)throw this.logger.error("Popup was blocked by browser"),new Error("Popup was blocked by browser")}startPopupMonitor(){this.popupCloseInterval&&clearInterval(this.popupCloseInterval),this.popupCloseInterval=setInterval(()=>{this.popupWindow?.closed&&(this.popupWindow=null,this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null))},500)}async openModal(e){this.dialogRef||this.createModal(),this.iframeRef&&(this.iframeRef.src=e),this.dialogRef&&!this.dialogRef.open&&(this.dialogRef.setAttribute("data-state","opening"),this.dialogRef.showModal(),window.setTimeout(()=>{this.dialogRef?.open&&this.dialogRef.setAttribute("data-state","idle")},220))}createModal(){this.ensureFonts(),this.ensureDialogBackdropCSS();const e=document.createElement("dialog");e.id="lazorkit-dialog",e.style.colorScheme="dark",e.setAttribute("data-theme","dark");const t=this.isMobileDevice(),a=(e=>({overlay:{position:"fixed",inset:0,padding:0,border:"none",background:"transparent",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",overflow:"visible",zIndex:2147483647,display:"grid",placeItems:e?"end center":"center"},panel:{width:e?"100%":"360px",maxWidth:e?"100%":"90vw",height:e?"55vh":"650px",maxHeight:e?"55vh":"90vh",background:"white",borderRadius:e?"20px 20px 0 0":"20px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",position:"relative"},closeButton:{zIndex:10},iframeContainer:{position:"relative",width:"100%",height:"100%",border:"none",margin:0,padding:0,overflow:"hidden",borderRadius:"inherit",background:"white"},iframe:{width:"100%",height:"100%",border:0,borderRadius:"inherit",display:"block"}}))(t);Object.assign(e.style,a.overlay),Object.assign(e.style,{"--background-color-th_base":"#191919","--background-color-th_frame":"#191919","--text-color-th_base":"#eeeeee","--border-color-th_frame":"rgba(255,255,255,0.10)"});const r=document.createElement("div"),n=t?"drawer":"floating";e.setAttribute("data-variant",n),e.setAttribute("data-state","idle"),r.id="lazorkit-panel",Object.assign(r.style,a.panel),Object.assign(r.style,{display:"flex",flexDirection:"column"}),Object.assign(r.style,{background:"var(--background-color-th_base, #fcfcfc)",color:"var(--text-color-th_base, #202020)",fontFamily:'"Roboto Flex", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'});const i=document.createElement("div");Object.assign(i.style,{height:"32px",flex:"0 0 auto",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 12px",boxSizing:"border-box",borderBottom:"1px solid rgba(0,0,0,0.08)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, var(--background-color-th_base, #fcfcfc))",color:"var(--text-color-th_base, #202020)",borderBottom:"1px solid var(--border-color-th_frame, rgba(0,0,0,0.08))"});const s=document.createElement("div");Object.assign(s.style,a.iframeContainer),Object.assign(s.style,{flex:"1 1 auto"}),Object.assign(s.style,{background:"var(--background-color-th_base, #fcfcfc)"}),Object.assign(r.style,{background:"var(--background-color-th_base, #191919)",color:"var(--text-color-th_base, #eeeeee)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, #191919)",color:"var(--text-color-th_base, #eeeeee)",borderBottom:"1px solid var(--border-color-th_frame, rgba(255,255,255,0.10))"}),Object.assign(s.style,{background:"var(--background-color-th_base, #191919)"});const o=this.createCloseButton(()=>{this.closeDialog(),this.emit("close")});Object.assign(o.style,{position:"static",top:"",right:""}),o.id="lazorkit-dialog-close",o.ariaLabel="Close",Object.assign(o.style,a.closeButton);const l=document.createElement("iframe");l.id="lazorkit-iframe",Object.assign(l.style,a.iframe),l.allow=`publickey-credentials-get ${this.config.portalUrl}; publickey-credentials-create ${this.config.portalUrl}; clipboard-write; camera; microphone`;const c=l.sandbox;c.add("allow-forms"),c.add("allow-scripts"),c.add("allow-same-origin"),c.add("allow-popups"),c.add("allow-popups-to-escape-sandbox"),c.add("allow-modals"),l.setAttribute("aria-label","Lazor Wallet"),l.tabIndex=0,l.title="Lazor",e.addEventListener("cancel",()=>this.closeDialog()),e.addEventListener("click",t=>{t.target===e&&this.closeDialog()}),i.appendChild(o),r.appendChild(i),s.appendChild(l),r.appendChild(s),e.appendChild(r),document.body.appendChild(e),this.dialogRef=e,this.iframeRef=l}setupMessageListener(){window.addEventListener("message",e=>{if(!e.origin.includes(new URL(this.config.portalUrl).hostname))return;const{type:t,data:a,error:r}=e.data;if(r)this.emit("error",new Error(r.message||"Portal error"));else switch(t){case"connect-result":case"WALLET_CONNECTED":const e={publicKey:a.publickey||a.publicKey||"",credentialId:a.credentialId,isCreated:"create"===a.connectionType||!!a.publickey,connectionType:a.connectionType||(a.publickey?"create":"get"),timestamp:a.timestamp||Date.now(),accountName:a.accountName};this.emit("connect-result",e),this.closeDialog();break;case"sign-result":case"SIGNATURE_CREATED":const t={signature:a.normalized,clientDataJsonBase64:a.clientDataJSONReturn,authenticatorDataBase64:a.authenticatorDataReturn,signedPayload:a.msg};this.emit("sign-result",t),this.closeDialog();break;case"error":this.emit("error",new Error(a?.message||"Unknown portal error"));break;case"close":this.closeDialog()}})}closeDialog(){if(this.isClosing)return;this.isClosing=!0;const e=this.dialogRef,t=this.iframeRef;try{e&&e.setAttribute("data-state","closing"),window.setTimeout(()=>{try{if(t&&(t.parentNode&&t.parentNode.removeChild(t),this.iframeRef=null),e){try{e.open&&e.close()}catch{}e.parentNode&&e.parentNode.removeChild(e),this.dialogRef=null}if(this.popupWindow){try{this.popupWindow.close()}catch{}this.popupWindow=null}this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null),this.logger.debug("Closed dialog (animated)")}catch(e){this.logger.error("Error during animated close:",e)}finally{this.isClosing=!1}},170)}catch(e){this.logger.error("Error closing dialog:",e),this.isClosing=!1}}getIframeRef(){return this.iframeRef}getDialogRef(){return this.dialogRef}getPopupWindow(){return this.popupWindow}getCurrentAction(){return this._currentAction}destroy(){this.isDestroyed||(this.isDestroyed=!0,this.closeDialog(),this.credentialManager.destroy(),this.removeAllListeners(),this.logger.debug("Destroyed dialog manager"))}}const Ue=e=>new Te({portalUrl:e.portalUrl,rpcUrl:e.rpcUrl,paymasterUrl:e.paymasterConfig.paymasterUrl}),Re=e=>Array.from(new Uint8Array(s.sha256.arrayBuffer(Buffer.from(e,"base64")))),Me=(e,t,a)=>{const r=e instanceof Error?e:new Error(String(e));throw t({error:r}),a?.(r),r},He=e=>e?Array.from(Buffer.from(e,"base64")):[],Qe=async(e,t,a)=>{const{isConnecting:r,config:n}=e();if(r)throw new Error("Already connecting");t({isConnecting:!0,error:null});try{const r=await I.getWallet();if((()=>{if("undefined"==typeof window)return;const e=localStorage.getItem("lazorkit-wallet");if(e)try{const t=JSON.parse(e);t.state&&void 0!==t.version&&localStorage.removeItem("lazorkit-wallet")}catch(e){}})(),r)return t({wallet:r}),a?.onSuccess?.(r),r;const i=Ue(n);try{const r=await i.openConnect(),s=new P(n.paymasterConfig),o=new Be(e().connection),l=Re(r.credentialId),c=await o.getSmartWalletByCredentialHash(l);let d,u;if(!r.publicKey&&c?(u=Buffer.from(c.passkeyPublicKey).toString("base64"),localStorage.setItem("PUBLIC_KEY",u)):u=r.publicKey,c)d=c.smartWallet.toBase58();else{const e=await s.getPayer(),t=await o.createSmartWalletTxn({passkeyPublicKey:He(u),payer:e,credentialIdBase64:r.credentialId});await s.signAndSend(t.transaction),d=t.smartWallet.toBase58()}const A={credentialId:r.credentialId,passkeyPubkey:He(u),expo:"web",platform:navigator.platform,smartWallet:d,walletDevice:"",accountName:r.accountName};return await I.saveWallet(A),t({wallet:A}),a?.onSuccess?.(A),A}finally{i.destroy()}}catch(e){return Me(e,t,a?.onFail)}finally{t({isConnecting:!1})}},Ke=r.create()(y((e,t)=>({wallet:null,config:{portalUrl:f.PORTAL_URL,paymasterConfig:{paymasterUrl:f.PAYMASTER_URL},rpcUrl:f.RPC_ENDPOINT},connection:new a.Connection(f.RPC_ENDPOINT,b),isLoading:!1,isConnecting:!1,isSigning:!1,error:null,setConfig:t=>{try{const r=new a.Connection(t.rpcUrl||f.RPC_ENDPOINT,b);e({config:t,connection:r})}catch(e){throw console.error("Failed to update wallet configuration:",e,{config:t}),new Error(`Failed to update configuration: ${e}`)}},setWallet:t=>{try{e({wallet:t})}catch(e){throw console.error("Failed to set wallet:",e,{wallet:t}),e}},setLoading:t=>e({isLoading:t}),setConnecting:t=>e({isConnecting:t}),setSigning:t=>e({isSigning:t}),setConnection:t=>{try{e({connection:t})}catch(e){throw console.error("Failed to set connection:",e,{endpoint:t?.rpcEndpoint}),e}},setError:t=>{e({error:t}),t&&console.error("Error state set:",t)},clearError:()=>{e({error:null})},connect:a=>Qe(t,e,a),disconnect:()=>(async(e,t)=>{try{await I.clearWallet(),e({wallet:null,error:null,isConnecting:!1,isSigning:!1,isLoading:!1}),t?.onSuccess?.()}catch(a){return Me(a,e,t?.onFail)}})(e),signAndSendTransaction:a=>(async(e,t,a)=>{const{isSigning:r,connection:n,wallet:i,config:s}=e();if(r)throw new Error("Already signing");if(!i)throw new Error("No wallet connected");if(!n)throw new Error("No connection available");t({isSigning:!0,error:null});try{const e=new P(s.paymasterConfig),t=new Be(n),r=await e.getPayer(),o=await x(n),l=await t.buildAuthorizationMessage({action:{type:exports.SmartWalletAction.CreateChunk,args:{cpiInstructions:a.instructions}},payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),passkeyPublicKey:i.passkeyPubkey,timestamp:new p.BN(o),credentialHash:Re(i.credentialId)}),c=Buffer.from(l).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=await n.getLatestBlockhash(),u=new p.web3.TransactionMessage({payerKey:r,recentBlockhash:d.blockhash,instructions:a.instructions}).compileToV0Message(),A=new p.web3.VersionedTransaction(u),g=Buffer.from(A.serialize()).toString("base64"),m=Ue(s),h=i.credentialId,y=a.transactionOptions?.clusterSimulation;try{const s=await m.openSign(c,g,h,y),l={msg:c,normalized:s.signature,clientDataJSONReturn:s.clientDataJsonBase64,authenticatorDataReturn:s.authenticatorDataBase64},d=Re(i.credentialId),u=await t.createChunkTxn({payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),passkeySignature:{passkeyPublicKey:i.passkeyPubkey,signature64:l.normalized,clientDataJsonRaw64:l.clientDataJSONReturn,authenticatorDataRaw64:l.authenticatorDataReturn},cpiInstructions:a.instructions,timestamp:o,credentialHash:d}),A=await e.signAndSend(u);await n.confirmTransaction(A),await T(n,t,new p.web3.PublicKey(i.smartWallet));const f=a.transactionOptions?.addressLookupTableAccounts||[],w=await t.executeChunkTxn({payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),cpiInstructions:a.instructions},{addressLookupTables:f,computeUnitLimit:a.transactionOptions?.computeUnitLimit});let b;return b=f.length>0?await e.signAndSendVersionedTransaction(w):await e.signAndSend(w),a.onSuccess?.(b),b}finally{m.destroy()}}catch(e){return Me(e,t,a.onFail)}finally{t({isSigning:!1})}})(t,e,a),signMessage:a=>(async(e,t,a)=>{const{isSigning:r,wallet:n,config:i}=e();if(r)throw new Error("Already signing");if(!n)throw new Error("No wallet connected");t({isSigning:!0,error:null});try{const e=Ue(i);try{const t=await e.openSignMessage(a,n.credentialId);return{signature:t.signature,signedPayload:t.signedPayload}}finally{e.destroy()}}catch(e){throw t({error:e}),e}finally{t({isSigning:!1})}})(t,e,a)}),{name:"lazorkit-wallet-store",storage:m(()=>k),partialize:e=>({wallet:e.wallet,config:e.config})}));function Ne(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}async function Oe(e){let t=e;if(64===t.length){const e=new Uint8Array(65);e[0]=4,e.set(t,1),t=e}return crypto.subtle.importKey("raw",t,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])}async function ze({signedPayload:e,signature:t,publicKey:a}){const r=Ne(e),n=Ne(t),i=Ne(a),s=await Oe(i);return crypto.subtle.verify({name:"ECDSA",hash:"SHA-256"},s,n,r)}const Le="CREDENTIAL_ID",Ve="PUBLIC_KEY",Fe="SMART_WALLET_ADDRESS";const je="Lazorkit Wallet",_e={rpcUrl:"https://api.devnet.solana.com",portalUrl:"https://portal.lazor.sh",paymasterConfig:{paymasterUrl:"https://kora.devnet.lazorkit.com"}};class Ge extends c.BaseWalletAdapter{constructor(e){super(),this.name=je,this.url="https://lazorkit.com",this.icon="data:image/png;base64,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",this.supportedTransactionVersions=new Set(["legacy",0]),this._publicKey=null,this._readyState="undefined"==typeof window||"undefined"==typeof document?c.WalletReadyState.Unsupported:c.WalletReadyState.Installed,this._connecting=!1,this._wallet=null,this._config=_e,e&&(this._config={...this._config,...e})}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==c.WalletReadyState.Installed)throw new c.WalletWindowClosedError;this._connecting=!0,this.emit("readyStateChange",this._readyState);const e=await I.getWallet();if(e)return void this._updateWalletState(e);const t=this._createDialogManager();try{const e=await t.openConnect(),a=await this._ensureWalletOnChain(e);await I.saveWallet(a),this._updateWalletState(a)}finally{t.destroy()}}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}_updateWalletState(e){this._wallet=e,this._publicKey=new a.PublicKey(e.smartWallet),this.emit("connect",this._publicKey)}_createDialogManager(){return new Te({portalUrl:this._config.portalUrl,rpcUrl:this._config.rpcUrl,paymasterUrl:this._config.paymasterConfig.paymasterUrl})}async _ensureWalletOnChain(e){const t=new a.Connection(this._config.rpcUrl),r=new d.KoraClient({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),n=new Be(t),s=Re(e.credentialId),o=await n.getSmartWalletByCredentialHash(s);let l,c;if(!e.publicKey&&o?(c=i.Buffer.from(o.passkeyPublicKey).toString("base64"),localStorage.setItem("PUBLIC_KEY",c)):c=e.publicKey,o)l=o.smartWallet.toBase58();else{const t=await r.getPayerSigner(),a=await n.createSmartWalletTxn({passkeyPublicKey:He(e.publicKey),payer:new p.web3.PublicKey(t.signer_address),credentialIdBase64:e.credentialId});await r.signAndSendTransaction({transaction:i.Buffer.from(a.transaction.serialize({requireAllSignatures:!1})).toString("base64"),signer_key:t.signer_address}),l=a.smartWallet.toBase58()}return{credentialId:e.credentialId,passkeyPubkey:He(c),expo:"web",platform:navigator.platform,smartWallet:l,walletDevice:""}}async disconnect(){await I.clearWallet(),this._wallet=null,this._publicKey=null,this.emit("disconnect")}async sendTransaction(e){try{if(!this._wallet||!this._publicKey)throw new c.WalletDisconnectedError;const t=this._prepareInstructions(e);if(0===t.length)throw new c.WalletSignTransactionError("No instructions to sign");const r=this._initializeClients();let n=[];if("version"in e){const t=e.message.addressTableLookups;n=await Promise.all(t.map(async e=>{const t=await r.connection.getAccountInfo(e.accountKey);if(!t)throw new Error("Lookup table not found");return new a.AddressLookupTableAccount({key:e.accountKey,state:a.AddressLookupTableAccount.deserialize(t.data)})}))}const i=await r.paymaster.getPayerSigner(),s=await x(r.connection),o=Re(this._wallet.credentialId),l=await this._buildAuthorizationMessage(r.smartWallet,t,i.signer_address,s,o),d=await r.connection.getLatestBlockhash(),u=await this._signWithDialog(l,t,d.blockhash,i.signer_address);return await this._executeSmartWalletTransaction(r,t,u,i.signer_address,s,o,n)}catch(e){throw this.emit("error",e),e}}async signTransaction(e){throw new c.WalletSignTransactionError("Lazorkit Wallet does not support signTransaction. Please use sendTransaction or signAndSendTransaction.")}async signAllTransactions(e){throw new c.WalletSignTransactionError("Lazorkit Wallet does not support signAllTransactions. Please use sendTransaction or signAndSendTransaction.")}async signMessage(e){const t=this._createDialogManager();try{if(!this._wallet||!this._publicKey)throw new c.WalletDisconnectedError;const a=i.Buffer.from(e).toString("base64"),r=await t.openSign(a,"",this._wallet.credentialId,this._config.clusterSimulation),n=JSON.stringify({signature:r.signature,signedPayload:r.signedPayload});return new Uint8Array(i.Buffer.from(n))}catch(e){throw this.emit("error",e),e}finally{t.destroy()}}_initializeClients(){const e=new a.Connection(this._config.rpcUrl);return{connection:e,paymaster:new d.KoraClient({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),smartWallet:new Be(e)}}_prepareInstructions(e){return"version"in e?e.message.compiledInstructions.map(t=>new a.TransactionInstruction({keys:t.accountKeyIndexes.map(t=>({pubkey:e.message.staticAccountKeys[t],isSigner:e.message.isAccountSigner(t),isWritable:e.message.isAccountWritable(t)})),programId:new a.PublicKey(e.message.staticAccountKeys[t.programIdIndex]),data:i.Buffer.from(t.data)})):[...e.instructions]}async _buildAuthorizationMessage(e,t,a,r,n){return await e.buildAuthorizationMessage({action:{type:exports.SmartWalletAction.CreateChunk,args:{cpiInstructions:t}},payer:new p.web3.PublicKey(a),smartWallet:this._publicKey,passkeyPublicKey:this._wallet.passkeyPubkey,timestamp:new p.BN(r),credentialHash:n})}async _signWithDialog(e,t,a,r){const n=i.Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,""),s=this._createDialogManager();try{const e=new p.web3.TransactionMessage({payerKey:new p.web3.PublicKey(r),recentBlockhash:a,instructions:t}).compileToV0Message(),o=new p.web3.VersionedTransaction(e),l=i.Buffer.from(o.serialize()).toString("base64");return await s.openSign(n,l,this._wallet.credentialId,this._config.clusterSimulation)}finally{s.destroy()}}async _executeSmartWalletTransaction(e,t,a,r,n,i,s){const o=await e.smartWallet.createChunkTxn({payer:new p.web3.PublicKey(r),smartWallet:this._publicKey,passkeySignature:{passkeyPublicKey:this._wallet.passkeyPubkey,signature64:a.signature,clientDataJsonRaw64:a.clientDataJsonBase64,authenticatorDataRaw64:a.authenticatorDataBase64},cpiInstructions:t,timestamp:n,credentialHash:i}),l=await this._sendToPaymaster(e.paymaster,o,r);await e.connection.confirmTransaction(l,"confirmed"),await T(e.connection,e.smartWallet,this._publicKey);const c=await e.smartWallet.executeChunkTxn({payer:new p.web3.PublicKey(r),smartWallet:this._publicKey,cpiInstructions:t},{addressLookupTables:s});return await this._sendToPaymaster(e.paymaster,c,r)}async _sendToPaymaster(e,t,a){let r;r="version"in t?i.Buffer.from(t.serialize()):i.Buffer.from(t.serialize({requireAllSignatures:!1,verifySignatures:!1}));return(await e.signAndSendTransaction({transaction:r.toString("base64"),signer_key:a})).signature}}class Je{constructor(e){this.version="1.0.0",this.name=je,this.icon="data:image/png;base64,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",this._account=null,this._listeners={},this._adapter=new Ge(e),this._adapter.on("connect",e=>{this._account={address:e.toBase58(),publicKey:e.toBytes(),chains:["solana:mainnet","solana:devnet","solana:testnet"],features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]},this._emit("change",{accounts:[this._account]})}),this._adapter.on("disconnect",()=>{this._account=null,this._emit("change",{accounts:[]})})}get accounts(){return this._account?[this._account]:[]}get chains(){return["solana:mainnet","solana:devnet","solana:testnet"]}get features(){return{"standard:connect":{version:"1.0.0",connect:async()=>(await this._adapter.connect(),{accounts:this.accounts})},"standard:disconnect":{version:"1.0.0",disconnect:async()=>{await this._adapter.disconnect()}},"standard:events":{version:"1.0.0",on:(e,t)=>(this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t),()=>{this._listeners[e]=this._listeners[e]?.filter(e=>e!==t)||[]})},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:async(...e)=>{const t=[];for(const r of e){const e=a.VersionedTransaction.deserialize(r.transaction),n=await this._adapter.sendTransaction(e);t.push({signature:o.decode(n)})}return t}},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:async(...e)=>{throw new Error("signTransaction not supported")}},"solana:signMessage":{version:"1.0.0",signMessage:async(...e)=>{const t=[];for(const a of e){const e=await this._adapter.signMessage(a.message);t.push({message:a.message,signature:e,signedMessage:a.message})}return t}}}}_emit(e,...t){this._listeners[e]?.forEach(e=>e(...t))}}Object.defineProperty(exports,"Connection",{enumerable:!0,get:function(){return a.Connection}}),Object.defineProperty(exports,"Keypair",{enumerable:!0,get:function(){return a.Keypair}}),Object.defineProperty(exports,"PublicKey",{enumerable:!0,get:function(){return a.PublicKey}}),Object.defineProperty(exports,"Transaction",{enumerable:!0,get:function(){return a.Transaction}}),Object.defineProperty(exports,"TransactionInstruction",{enumerable:!0,get:function(){return a.TransactionInstruction}}),exports.API_ENDPOINTS=w,exports.CHUNK_SEED=se,exports.CREDENTIAL_HASH_SIZE=32,exports.DEFAULTS=f,exports.DEFAULT_COMMITMENT=b,exports.DEFAULT_CONFIG=_e,exports.DefaultPolicyClient=ae,exports.DialogManager=Te,exports.EMPTY_PDA_RENT_EXEMPT_BALANCE=Q,exports.LazorkitClient=Be,exports.LazorkitProvider=a=>{const{children:r,rpcUrl:n=f.RPC_ENDPOINT,portalUrl:i=f.PORTAL_URL,paymasterConfig:s={paymasterUrl:f.PAYMASTER_URL}}=a,{setConfig:o}=Ke();return t.useEffect(()=>{o({portalUrl:i,paymasterConfig:s,rpcUrl:n})},[n,i,s,o]),e.jsx(e.Fragment,{children:r})},exports.LazorkitWalletAdapter=Ge,exports.LazorkitWalletName=je,exports.Logger=v,exports.PASSKEY_PUBLIC_KEY_SIZE=33,exports.Paymaster=P,exports.SIGNATURE_SIZE=64,exports.SMART_WALLET_CONFIG_SEED=ne,exports.SMART_WALLET_SEED=re,exports.STORAGE_KEYS=S,exports.StorageManager=I,exports.StorageUtil=class{static saveCredentials(e){try{e.credentialId&&localStorage.setItem(Le,e.credentialId),localStorage.setItem(Ve,e.publickey),localStorage.setItem(Fe,e.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",e.timestamp.toString())}catch(e){console.error("Failed to save credentials to local storage:",e)}}static getCredentials(){try{const e=localStorage.getItem(Le),t=localStorage.getItem(Ve),a=localStorage.getItem(Fe),r=localStorage.getItem("CREDENTIALS_TIMESTAMP");return t&&a?{credentialId:e||void 0,publickey:t,smartWalletAddress:a,timestamp:r?parseInt(r):Date.now()}:null}catch(e){return console.error("Failed to get credentials from local storage:",e),null}}static updateSmartWalletAddress(e){try{localStorage.setItem(Fe,e)}catch(e){console.error("Failed to update smart wallet address in local storage:",e)}}static clearCredentials(){try{localStorage.removeItem(Le),localStorage.removeItem(Ve),localStorage.removeItem(Fe),localStorage.removeItem("CREDENTIALS_TIMESTAMP"),console.log("Credentials cleared from local storage")}catch(e){console.error("Failed to clear credentials from local storage:",e)}}static getItem(e){return localStorage.getItem(e)}static setItem(e,t){localStorage.setItem(e,t)}},exports.ValidationError=K,exports.WALLET_DEVICE_SEED=ie,exports.asCredentialHash=R,exports.asPasskeyPublicKey=U,exports.asSignature=function(e){return e},exports.assertByteArrayLength=z,exports.assertDefined=N,exports.assertNonEmptyArray=G,exports.assertNonEmptyByteArray=function(e,t){if(N(e,t),0===(Array.isArray(e)?e:Array.from(e)).length)throw new K(`${t} cannot be empty`,t)},exports.assertNonEmptyString=_,exports.assertPositiveBN=j,exports.assertPositiveInteger=X,exports.assertPositiveNumber=function(e,t){if(N(e,t),"number"!=typeof e||!Number.isFinite(e)||Number.isNaN(e))throw new K(`${t} must be a finite number (got ${Number.isNaN(e)?"NaN":Number.isFinite(e)?typeof e:e===1/0?"Infinity":"-Infinity"})`,t);if(e<0)throw new K(`${t} must be non-negative, got ${e}`,t)},exports.assertValidBase64=Y,exports.assertValidCredentialHash=V,exports.assertValidPasskeyPublicKey=L,exports.assertValidPasskeySignature=te,exports.assertValidPublicKey=O,exports.assertValidPublicKeyArray=q,exports.assertValidSignature=F,exports.assertValidTransactionInstruction=J,exports.assertValidTransactionInstructionArray=$,exports.base64ToBytes=Ne,exports.buildCreateChunkMessage=be,exports.buildExecuteMessage=function(e,t,a,r,n,s){const o=ye(r,e),l=((e,t,a)=>{const r=W(e,a),n=he(e.programId,r,t);return{cpiDataHash:me(e.data),cpiAccountsHash:n}})(n,e,s??[]),c=new Uint8Array(64);c.set(o.policyDataHash,0),c.set(o.policyAccountsHash,32);const d=me(c),u=new Uint8Array(64);u.set(l.cpiDataHash,0),u.set(l.cpiAccountsHash,32);const A=me(u),p=i.Buffer.alloc(8);p.writeBigUInt64LE(BigInt(t.toString()),0);const g=i.Buffer.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=i.Buffer.concat([p,g,i.Buffer.from(d),i.Buffer.from(A)]),h=me(m);return we("SimpleMessage",{dataHash:Array.from(h)})},exports.buildPasskeyVerificationInstruction=Ie,exports.buildTransaction=Ee,exports.byteArrayEquals=function(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0},exports.calculateVerifyInstructionIndex=We,exports.combineInstructionsWithAuth=De,exports.combineInstructionsWithAuthAndCU=function(e,t,a){return Ce([e,...t],a)},exports.computeMultipleCpiHashes=fe,exports.convertPasskeySignatureToInstructionArgs=ve,exports.createComputeUnitLimitInstruction=Pe,exports.credentialHashFromBase64=B,exports.deriveChunkPda=ue,exports.deriveSmartWalletConfigPda=le,exports.deriveSmartWalletPda=oe,exports.deriveWalletDevicePda=de,exports.detectPlatform=function(){if("undefined"!=typeof window&&window.ReactNativeWebView)return"mobile";const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)?"mobile":"web"},exports.ensureChunkExist=T,exports.getBlockchainTimestamp=x,exports.getRandomBytes=E,exports.importP256PublicKey=Oe,exports.instructionToAccountMetas=W,exports.isAndroid=function(){return/Android/i.test(navigator.userAgent)},exports.isIOS=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},exports.isSafari=function(){const e=navigator.userAgent.toLowerCase();return/^((?!chrome|android).)*safari/i.test(e)},exports.normalizePublicKey=function(e,t="publicKey"){return O(e,t),"string"==typeof e?new p.web3.PublicKey(e):e},exports.prependComputeUnitLimit=Ce,exports.registerLazorkitWallet=function(e){u.registerWallet(new Je(e))},exports.toNumberArray=Z,exports.toNumberArraySafe=ee,exports.useWallet=()=>{const{wallet:e,isLoading:r,isConnecting:n,isSigning:i,error:s,connect:o,disconnect:l,signAndSendTransaction:c,signMessage:d}=Ke(),u=t.useCallback(async e=>{try{return await o(e)}catch(e){throw console.error("Failed to connect wallet:",e),e}},[o]),A=t.useCallback(async()=>{try{await l()}catch(e){throw console.error("Failed to disconnect wallet:",e),e}},[l]),p=t.useCallback(async e=>{try{return await c({instructions:e.instructions,transactionOptions:e.transactionOptions})}catch(e){throw console.error("Failed to sign and send transaction:",e),e}},[c]),g=t.useCallback(async e=>{try{return await d(e)}catch(e){throw console.error("Failed to sign message:",e),e}},[d]),m=t.useCallback(async({signedPayload:e,signature:t,publicKey:a})=>{const r=Buffer.from(e).toString("base64"),n=Buffer.from(t).toString("base64"),i=Buffer.from(a).toString("base64");return await ze({signedPayload:r,signature:n,publicKey:i})},[]);return{smartWalletPubkey:e?.smartWallet?new a.PublicKey(e.smartWallet):null,isConnected:!!e,isLoading:r||n||i,isConnecting:n,isSigning:i,error:s,wallet:e,connect:u,disconnect:A,signAndSendTransaction:p,signMessage:g,verifyMessage:m}},exports.useWalletStore=Ke,exports.validateCredentialHash=function(e,t="credentialHash"){return V(e,t),Array.isArray(e)?e:Array.from(e)},exports.validatePasskeyPublicKey=function(e,t="passkeyPublicKey"){return L(e,t),Array.isArray(e)?e:Array.from(e)},exports.validateSignature=function(e,t="signature"){return F(e,t),Array.isArray(e)?e:Array.from(e)},exports.verifySignatureBrowser=ze;
+"use strict";var e=require("react/jsx-runtime"),t=require("react"),a=require("@solana/web3.js"),r=require("zustand"),n=require("@coral-xyz/anchor"),i=require("buffer"),s=require("js-sha256"),o=require("bs58"),l=require("eventemitter3"),c=require("@solana/wallet-adapter-base"),d=require("@solana/kora"),u=require("@wallet-standard/wallet");function A(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}}),t.default=e,Object.freeze(t)}var p=A(n);function g(e,t){let a;try{a=e()}catch(e){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),n=null!=(t=a.getItem(e))?t:null;return n instanceof Promise?n.then(r):r(n)},setItem:(e,t)=>a.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>a.removeItem(e)}}const m=e=>t=>{try{const a=e(t);return a instanceof Promise?a:{then:e=>m(e)(a),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>m(t)(e)}}},h=(e,t)=>(a,r,n)=>{let i={storage:g(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...e)},r,n);const d=()=>{const e=i.partialize({...r()});return c.setItem(i.name,{state:e,version:i.version})},u=n.setState;n.setState=(e,t)=>(u(e,t),d());const A=e((...e)=>(a(...e),d()),r,n);let p;n.getInitialState=()=>A;const h=()=>{var e,t;if(!c)return;s=!1,o.forEach(e=>{var t;return e(null!=(t=r())?t:A)});const n=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=r())?e:A))||void 0;return m(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate){const t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[n,s]=e;if(p=i.merge(s,null!=(t=r())?t:A),a(p,!0),n)return d()}).then(()=>{null==n||n(p,void 0),p=r(),s=!0,l.forEach(e=>e(p))}).catch(e=>{null==n||n(void 0,e)})};return n.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>h(),hasHydrated:()=>s,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},i.skipHydration||h(),p||A},y={PORTAL_URL:"https://portal.lazor.sh",PAYMASTER_URL:"https://lazorkit-paymaster.onrender.com",RPC_ENDPOINT:"https://api.devnet.solana.com"},f={CONNECT:"connect",SIGN:"sign"},w="confirmed",b={WALLET:"lazorkit-wallet",CREDENTIALS:"lazorkit-credentials",PUBLIC_KEY:"PUBLIC_KEY",CREDENTIAL_ID:"CREDENTIAL_ID",SMART_WALLET_ADDRESS:"SMART_WALLET_ADDRESS"},S={getItem:async e=>{try{if("undefined"==typeof window)return null;return localStorage.getItem(e)}catch(t){return console.error("Error reading from localStorage:",t,{key:e}),null}},setItem:async(e,t)=>{try{if("undefined"==typeof window)return;localStorage.setItem(e,t)}catch(a){console.error("Error writing to localStorage:",a,{key:e,valueLength:t.length})}},removeItem:async e=>{try{if("undefined"==typeof window)return;localStorage.removeItem(e)}catch(t){console.error("Error removing from localStorage:",t,{key:e})}}};class k{static async saveWallet(e){try{await S.setItem(b.WALLET,JSON.stringify(e)),await S.setItem(b.CREDENTIAL_ID,e.credentialId),await S.setItem(b.SMART_WALLET_ADDRESS,e.smartWallet),await S.setItem(b.PUBLIC_KEY,i.Buffer.from(e.passkeyPubkey).toString("base64"))}catch(e){throw console.error("Failed to save wallet to storage:",e),e}}static async getWallet(){try{const e=await S.getItem(b.WALLET);return e?JSON.parse(e):null}catch(e){return console.error("Failed to get wallet from storage:",e),null}}static async saveConfig(e){try{await S.setItem("lazorkit-config",JSON.stringify(e))}catch(e){throw console.error("Failed to save config to storage:",e),e}}static async getConfig(){try{const e=await S.getItem("lazorkit-config");return e?JSON.parse(e):null}catch(e){return console.error("Failed to get config from storage:",e),null}}static async clearWallet(){try{await S.removeItem(b.WALLET),await S.removeItem(b.CREDENTIAL_ID),await S.removeItem(b.SMART_WALLET_ADDRESS),await S.removeItem(b.PUBLIC_KEY),await S.removeItem("CREDENTIALS_TIMESTAMP")}catch(e){throw console.error("Failed to clear wallet from storage:",e),e}}static async getItem(e){return await S.getItem(e)}static async setItem(e,t){await S.setItem(e,t)}static async removeItem(e){await S.removeItem(e)}}class I{constructor(e){this.context=e,this.enabled="production"!==process.env.NODE_ENV}debug(e,t){this.enabled&&console.debug(`[${this.context}] ${e}`,t)}info(e,t){console.info(`[${this.context}] ${e}`,t)}warn(e,t){console.warn(`[${this.context}] ${e}`,t)}error(e,t){console.error(`[${this.context}] ${e}`,t)}}class P{constructor(e){this.logger=new I("Paymaster"),this.endpoint=e.paymasterUrl,this.apiKey=e.apiKey}getHeaders(){const e={"Content-Type":"application/json"};return this.apiKey&&(e["x-api-key"]=this.apiKey),e}async getPayer(){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getPayerSigner",params:[]})});if(!e.ok)throw new Error(`Failed to get payer: ${e.statusText}`);const t=await e.json();return new a.PublicKey(t.result.signer_address)}catch(e){throw this.logger.error("Failed to get payer",e),e}}async getBlockhash(){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"getBlockhash",id:1,params:[]})});if(!e.ok)throw new Error(`Failed to get blockhash: ${e.statusText}`);return(await e.json()).result.blockhash}catch(e){throw this.logger.error("Failed to get blockhash",e),e}}async attemptSign(e,t=1){try{const t=e.serialize({verifySignatures:!1,requireAllSignatures:!1}),r=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signTransaction",id:1,params:[t.toString("base64")]})});if(!r.ok)throw new Error(`Failed to sign transaction: ${r.statusText}`);const n=await r.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return a.Transaction.from(i.Buffer.from(n.result.signed_transaction,"base64"))}catch(e){throw this.logger.error(`Sign attempt ${t} failed:`,e),e}}async sign(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSign(e,r)}catch(e){if(r===t)throw this.logger.error("All sign retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying sign in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign transaction after all retries")}async attemptSignAndSend(e,t=1){try{const t=e.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[t.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign and send transaction: ${a.statusText}`);const r=await a.json();if(r.error)throw new Error(r.error.message||"Unknown paymaster error");return r.result.signature}catch(e){throw this.logger.error(`Attempt ${t} failed:`,e),e}}async signAndSend(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSignAndSend(e,r)}catch(e){if(r===t)throw this.logger.error("All retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign and send transaction after all retries")}async attemptSignAndSendVersionedTransaction(e,t=1){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[i.Buffer.from(e.serialize()).toString("base64")]})});if(!t.ok)throw new Error(`Failed to sign and send transaction: ${t.statusText}`);const a=await t.json();if(a.error)throw new Error(a.error.message||"Unknown paymaster error");return a.result.signature}catch(e){throw this.logger.error(`Attempt ${t} failed:`,e),e}}async signAndSendVersionedTransaction(e,t=3,a=1e3){for(let r=1;r<=t;r++)try{return await this.attemptSignAndSendVersionedTransaction(e,r)}catch(e){if(r===t)throw this.logger.error("All retry attempts failed",e),e;const n=a*Math.pow(2,r-1);this.logger.info(`Retrying in ${n}ms (attempt ${r}/${t})`),await new Promise(e=>setTimeout(e,n))}throw new Error("Failed to sign and send transaction after all retries")}}var v,C={address:"Gsuz7YcA5sbMGVRXT3xSYhJBessW4xFC4xYsihNCqMFh",metadata:{name:"lazorkit",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},docs:["LazorKit: Smart Wallet with WebAuthn Passkey Authentication"],instructions:[{name:"close_chunk",discriminator:[150,183,213,198,0,74,14,170],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0}],args:[]},{name:"create_chunk",discriminator:[83,226,15,219,9,19,186,90],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"wallet_state.last_nonce",account:"WalletState"}]}},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateChunkArgs"}}}]},{name:"create_smart_wallet",discriminator:[129,39,235,18,132,68,203,19],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"arg",path:"args.wallet_id"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"policy_program"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateSmartWalletArgs"}}}]},{name:"delete_smart_wallet",discriminator:[126,239,172,118,134,32,52,102],accounts:[{name:"payer",writable:!0,signer:!0,address:"BE8duRBDmh4cF4Ecz4TBCNgNAMCaonrpQiEiQ1xfQmab"},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"execute",discriminator:[130,221,242,154,13,193,189,29],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"cpi_program"},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"ExecuteArgs"}}}]},{name:"execute_chunk",discriminator:[106,83,113,47,89,243,39,220],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"instruction_data_list",type:{vec:"bytes"}},{name:"split_index",type:"bytes"}]}],accounts:[{name:"Chunk",discriminator:[134,67,80,65,135,143,156,196]},{name:"WalletDevice",discriminator:[35,85,31,31,179,48,136,123]},{name:"WalletState",discriminator:[126,186,0,158,92,223,167,68]}],errors:[{code:6e3,name:"PasskeyMismatch",msg:"Passkey public key mismatch with stored authenticator"},{code:6001,name:"InvalidPolicyDataSize",msg:"Invalid policy data size"},{code:6002,name:"Secp256r1InvalidLength",msg:"Secp256r1 instruction has invalid data length"},{code:6003,name:"Secp256r1HeaderMismatch",msg:"Secp256r1 instruction header validation failed"},{code:6004,name:"Secp256r1DataMismatch",msg:"Secp256r1 signature data validation failed"},{code:6005,name:"InvalidSignature",msg:"Invalid signature provided for passkey verification"},{code:6006,name:"ClientDataInvalidUtf8",msg:"Client data JSON is not valid UTF-8"},{code:6007,name:"ClientDataJsonParseError",msg:"Client data JSON parsing failed"},{code:6008,name:"ChallengeMissing",msg:"Challenge field missing from client data JSON"},{code:6009,name:"ChallengeBase64DecodeError",msg:"Challenge base64 decoding failed"},{code:6010,name:"ChallengeDeserializationError",msg:"Challenge message deserialization failed"},{code:6011,name:"HashMismatch",msg:"Message hash mismatch: expected different value"},{code:6012,name:"InvalidInstructionDiscriminator",msg:"Invalid instruction discriminator"},{code:6013,name:"InsufficientCpiAccounts",msg:"Insufficient remaining accounts for CPI instruction"},{code:6014,name:"AccountSliceOutOfBounds",msg:"Account slice index out of bounds"},{code:6015,name:"InvalidAccountOwner",msg:"Account owner verification failed"},{code:6016,name:"ProgramNotExecutable",msg:"Program not executable"},{code:6017,name:"CredentialIdEmpty",msg:"Credential ID cannot be empty"},{code:6018,name:"PolicyDataTooLarge",msg:"Policy data exceeds maximum allowed size"},{code:6019,name:"TransactionTooOld",msg:"Transaction is too old"},{code:6020,name:"InvalidInstructionData",msg:"Invalid instruction data"},{code:6021,name:"InvalidInstruction",msg:"Invalid instruction"},{code:6022,name:"InsufficientBalanceForFee",msg:"Insufficient balance for fee"},{code:6023,name:"InvalidSequenceNumber",msg:"Invalid sequence number"},{code:6024,name:"InvalidPasskeyFormat",msg:"Invalid passkey format"},{code:6025,name:"ReentrancyDetected",msg:"Reentrancy detected"},{code:6026,name:"UnauthorizedAdmin",msg:"Unauthorized admin"}],types:[{name:"Chunk",docs:["Transaction chunk for deferred execution","","Created after full passkey and policy verification. Contains all bindings","necessary to execute the transaction later without re-verification.","Used for large transactions that need to be split into manageable chunks."],type:{kind:"struct",fields:[{name:"owner_wallet_address",docs:["Smart wallet address that authorized this chunk session"],type:"pubkey"},{name:"cpi_hash",docs:["Combined SHA256 hash of all cpi transaction instruction data"],type:{array:["u8",32]}},{name:"authorized_nonce",docs:["The nonce that was authorized at chunk creation (bound into data hash)"],type:"u64"},{name:"authorized_timestamp",docs:["Timestamp from the original message hash for expiration validation"],type:"i64"},{name:"rent_refund_address",docs:["Address to receive rent refund when closing the chunk session"],type:"pubkey"}]}},{name:"CreateChunkArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"policy_data",type:"bytes"},{name:"timestamp",type:"i64"},{name:"cpi_hash",type:{array:["u8",32]}}]}},{name:"CreateSmartWalletArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"init_policy_data",type:"bytes"},{name:"wallet_id",type:"u64"},{name:"amount",type:"u64"},{name:"policy_data_size",type:"u16"}]}},{name:"ExecuteArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"split_index",type:"u16"},{name:"policy_data",type:"bytes"},{name:"cpi_data",type:"bytes"},{name:"timestamp",type:"i64"}]}},{name:"WalletDevice",docs:["Wallet device account linking a passkey to a smart wallet"],type:{kind:"struct",fields:[{name:"passkey_pubkey",docs:["Secp256r1 compressed public key (33 bytes)"],type:{array:["u8",33]}},{name:"credential_hash",docs:["SHA256 hash of the credential ID"],type:{array:["u8",32]}},{name:"smart_wallet",docs:["Associated smart wallet address"],type:"pubkey"},{name:"bump",docs:["PDA bump seed"],type:"u8"}]}},{name:"WalletState",docs:["Wallet state account storing wallet configuration and execution state"],type:{kind:"struct",fields:[{name:"bump",docs:["PDA bump seed for smart wallet"],type:"u8"},{name:"wallet_id",docs:["Unique wallet identifier"],type:"u64"},{name:"last_nonce",docs:["Last used nonce for anti-replay protection"],type:"u64"},{name:"policy_program",docs:["Policy program that validates transactions"],type:"pubkey"},{name:"policy_data",docs:["Serialized policy data returned from policy initialization"],type:"bytes"}]}}]};function W(e,t){return e.keys.map(e=>({pubkey:e.pubkey,isWritable:e.isWritable,isSigner:!!t&&t.some(t=>t.toString()===e.pubkey.toString())}))}function D(e){if("function"==typeof globalThis.crypto?.getRandomValues){const t=new Uint8Array(e);return globalThis.crypto.getRandomValues(t),t}try{const{randomBytes:t}=require("crypto");return t(e)}catch{throw new Error("No CSPRNG available")}}function E(e,t){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function B(e){const t=i.Buffer.from(e,"base64");return Array.from(new Uint8Array(s.sha256.arrayBuffer(t)))}async function x(e){const t=await e.getSlot(),a=await e.getBlockTime(t);return new p.BN(a||Math.floor(Date.now()/1e3))}function T(e){return e}function U(e){return e}exports.SmartWalletAction=void 0,(v=exports.SmartWalletAction||(exports.SmartWalletAction={})).Execute="execute",v.CreateChunk="create_chunk",v.ExecuteChunk="execute_chunk";var R={address:"BiE9vSdz9MidUiyjVYsu3PG4C1fbPZ8CVPADA9jRfXw7",metadata:{name:"default_policy",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},instructions:[{name:"check_policy",discriminator:[28,88,170,179,239,136,25,35],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet"}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"policy_data",type:"bytes"}]},{name:"init_policy",discriminator:[45,234,110,100,209,146,191,86],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}],returns:{defined:{name:"PolicyStruct"}}}],errors:[{code:6e3,name:"InvalidPasskey",msg:"Invalid passkey format"},{code:6001,name:"Unauthorized",msg:"Unauthorized to access smart wallet"}],types:[{name:"DeviceSlot",type:{kind:"struct",fields:[{name:"passkey_pubkey",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}]}},{name:"PolicyStruct",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"smart_wallet",type:"pubkey"},{name:"device_slots",type:{vec:{defined:{name:"DeviceSlot"}}}}]}}]};const M=i.Buffer.from("policy");const H=890880;class Q extends Error{constructor(e,t){super(e),this.field=t,this.name="ValidationError"}}function N(e,t){if(null==e||void 0===e){throw new Q(`${t} is required but was ${null===e?"null":"undefined"}`,t)}}function K(e,t){N(e,t);try{if("string"==typeof e){if(0===e.trim().length)throw new Q(`${t} cannot be an empty string`,t);new p.web3.PublicKey(e)}else{if(!(e instanceof p.web3.PublicKey||e&&"object"==typeof e&&"toBase58"in e&&"function"==typeof e.toBase58&&"toBytes"in e&&"function"==typeof e.toBytes))throw new Q(`${t} must be a PublicKey instance or valid base58 string`,t)}}catch(e){if(e instanceof Q)throw e;throw new Q(`${t} is not a valid PublicKey: ${e instanceof Error?e.message:"Invalid format"}`,t)}}function O(e,t,a){let r;if(N(e,a),Array.isArray(e))r=e;else if(e instanceof Uint8Array)r=Array.from(e);else{if(!e||"object"!=typeof e||"number"!=typeof e.length)throw new Q(`${a} must be an array or Uint8Array`,a);r=Array.from(e)}if(r.length!==t)throw new Q(`${a} must be exactly ${t} bytes, got ${r.length}`,a);for(let e=0;e<r.length;e++){const t=r[e];if("number"!=typeof t||!Number.isFinite(t)||!Number.isInteger(t)||t<0||t>255)throw new Q(`${a}[${e}] must be a valid byte (0-255), got ${"number"==typeof t?t:typeof t}`,a)}}function z(e,t="passkeyPublicKey"){O(e,33,t)}function L(e,t="credentialHash"){O(e,32,t)}function V(e,t="signature"){O(e,64,t)}function F(e,t){N(e,t);if(!(e instanceof p.BN||e&&"object"==typeof e&&"lt"in e&&"function"==typeof e.lt&&"toString"in e&&"function"==typeof e.toString))throw new Q(`${t} must be a BN instance`,t);if(e.lt(new p.BN(0)))throw new Q(`${t} must be non-negative, got ${e.toString()}`,t)}function _(e,t){if(N(e,t),"string"!=typeof e)throw new Q(`${t} must be a string (got ${typeof e})`,t);if(0===String(e).trim().length)throw new Q(`${t} cannot be empty`,t)}function j(e,t){if(N(e,t),!Array.isArray(e))throw new Q(`${t} must be an array (got ${typeof e}${e&&"object"==typeof e?` with constructor ${e.constructor?.name||"unknown"}`:""})`,t);if(0===e.length)throw new Q(`${t} cannot be empty`,t)}function G(e,t){N(e,t);if(!(e instanceof p.web3.TransactionInstruction||e&&"object"==typeof e&&"programId"in e&&"keys"in e&&Array.isArray(e.keys)&&"data"in e))throw new Q(`${t} must be a TransactionInstruction instance`,t);if(K(e.programId,`${t}.programId`),!e.keys||!Array.isArray(e.keys)||0===e.keys.length)throw new Q(`${t} must have at least one account key`,t)}function J(e){return Array.isArray(e)?e:Array.from(e)}function Z(e,t){_(e,t);if(!/^[A-Za-z0-9+/]*={0,2}$/.test(e))throw new Q(`${t} is not a valid base64 string (invalid characters)`,t);try{"undefined"!=typeof Buffer&&Buffer.from?Buffer.from(e,"base64"):"undefined"!=typeof atob&&atob(e)}catch(e){throw new Q(`${t} is not a valid base64 string: ${e instanceof Error?e.message:"Invalid format"}`,t)}}function Y(e,t){if(N(e,t),"number"!=typeof e||!Number.isFinite(e)||Number.isNaN(e))throw new Q(`${t} must be a finite number (got ${Number.isNaN(e)?"NaN":Number.isFinite(e)?typeof e:e===1/0?"Infinity":"-Infinity"})`,t);if(!Number.isInteger(e))throw new Q(`${t} must be an integer, got ${e}`,t);if(e<=0)throw new Q(`${t} must be a positive integer, got ${e}`,t)}function X(e,t){j(e,t),e.forEach((e,a)=>{K(e,`${t}[${a}]`)})}function q(e,t){j(e,t),e.forEach((e,a)=>{G(e,`${t}[${a}]`)})}function $(e){return Array.isArray(e)?[...e]:Array.from(e)}class ee{constructor(e){N(e,"connection"),this.connection=e,this.program=new p.Program(R,{connection:e}),this.programId=this.program.programId}policyPda(e){return K(e,"smartWallet"),function(e,t){return p.web3.PublicKey.findProgramAddressSync([M,t.toBuffer()],e)[0]}(this.programId,e)}getPolicyDataSize(){return 102}validateInitPolicyParams(e){N(e,"params"),F(e.walletId,"params.walletId"),z(e.passkeyPublicKey,"params.passkeyPublicKey"),L(e.credentialHash,"params.credentialHash"),K(e.policySigner,"params.policySigner"),K(e.smartWallet,"params.smartWallet"),K(e.walletState,"params.walletState")}async buildInitPolicyIx(e){return this.validateInitPolicyParams(e),await this.program.methods.initPolicy(e.walletId,$(e.passkeyPublicKey),$(e.credentialHash)).accountsPartial({smartWallet:e.smartWallet,walletState:e.walletState,policySigner:e.policySigner}).instruction()}validateCheckPolicyParams(e){if(N(e,"params"),F(e.walletId,"params.walletId"),z(e.passkeyPublicKey,"params.passkeyPublicKey"),K(e.policySigner,"params.policySigner"),K(e.smartWallet,"params.smartWallet"),L(e.credentialHash,"params.credentialHash"),N(e.policyData,"params.policyData"),!Buffer.isBuffer(e.policyData))throw new Q("params.policyData must be a Buffer instance","params.policyData")}async buildCheckPolicyIx(e){return this.validateCheckPolicyParams(e),await this.program.methods.checkPolicy(e.walletId,$(e.passkeyPublicKey),$(e.credentialHash),e.policyData).accountsPartial({smartWallet:e.smartWallet,policySigner:e.policySigner}).instruction()}}function te(e,t){const a=i.Buffer.concat([e.toBuffer(),i.Buffer.from(t)]),r=s.sha256.arrayBuffer(a);return i.Buffer.from(r).subarray(0,32)}const ae=32,re=new p.web3.PublicKey("Secp256r1SigVerify1111111111111111111111111"),ne=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),ie=new Uint8Array([127,255,255,255,128,0,0,0,127,255,255,255,255,255,255,255,222,115,125,86,211,139,207,66,121,220,229,97,126,49,146,168]);function se(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);{const t=new ArrayBuffer(2*Object.values(e).length),a=new DataView(t);return Object.values(e).forEach((e,t)=>{a.setUint16(2*t,e,!0)}),new Uint8Array(t)}}function oe(e,t,a){try{const r=a.slice(0,ae),n=a.slice(ae,64),s=i.Buffer.alloc(ae,0),o=i.Buffer.alloc(ae,0);if(r.copy(s,ae-r.length),n.copy(o,ae-n.length),function(e,t){if(e.length!==t.length)return e.length>t.length;for(let a=0;a<e.length;a++)if(e[a]!==t[a])return e[a]>t[a];return!1}(o,ie)){const e=function(e,t){const a=new Uint8Array(e.length);let r=0;for(let n=e.length-1;n>=0;n--){let i=e[n]-t[n]-r;i<0?(i+=256,r=1):r=0,a[n]=i}return a}(ne,o);a=i.Buffer.concat([s,i.Buffer.from(e)])}else a=i.Buffer.concat([s,o]);if(33!==t.length||64!==a.length)throw new Error("Invalid key or signature length");const l=113+e.length,c=new Uint8Array(l),d=1,u=16,A=u+33,g=A+64;c.set(se([d,0]),0);const m={signature_offset:A,signature_instruction_index:65535,public_key_offset:u,public_key_instruction_index:65535,message_data_offset:g,message_data_size:e.length,message_instruction_index:65535};return c.set(se(m),2),c.set(t,u),c.set(a,A),c.set(e,g),new p.web3.TransactionInstruction({keys:[],programId:re,data:i.Buffer.from(c)})}catch(e){throw new Error(`Failed to create secp256r1 instruction: ${e}`)}}const le=i.Buffer.from("smart_wallet"),ce=i.Buffer.from("wallet_state"),de=i.Buffer.from("wallet_device"),ue=i.Buffer.from("chunk");function Ae(e,t){return p.web3.PublicKey.findProgramAddressSync([le,t.toArrayLike(i.Buffer,"le",8)],e)[0]}function pe(e,t){return p.web3.PublicKey.findProgramAddressSync([ce,t.toBuffer()],e)[0]}function ge(e,t,a){return p.web3.PublicKey.findProgramAddressSync([de,te(t,a)],e)}function me(e,t,a){return p.web3.PublicKey.findProgramAddressSync([ue,t.toBuffer(),a.toArrayLike(i.Buffer,"le",8)],e)[0]}class he{constructor(e){this.programId=e}smartWallet(e){return F(e,"walletId"),Ae(this.programId,e)}walletState(e){return K(e,"smartWallet"),pe(this.programId,e)}walletDevice(e,t){return K(e,"smartWallet"),L(t,"credentialHash"),ge(this.programId,e,t)[0]}chunk(e,t){return K(e,"smartWallet"),me(this.programId,e,t)}}class ye{constructor(e,t){this.policyClient=e,this.walletPdas=t}async resolveForExecute({provided:e,smartWallet:t,credentialHash:a,passkeyPublicKey:r,walletStateData:n}){if(null!==e)return e;const i=this.walletPdas.walletDevice(t,a);return this.policyClient.buildCheckPolicyIx({walletId:n.walletId,passkeyPublicKey:r,policySigner:i,smartWallet:t,credentialHash:a,policyData:n.policyData})}async resolveForCreate({provided:e,smartWalletId:t,smartWallet:a,walletState:r,passkeyPublicKey:n,credentialHash:i}){if(null!=e)return e;const s=this.walletPdas.walletDevice(a,i);return this.policyClient.buildInitPolicyIx({walletId:t,passkeyPublicKey:n,credentialHash:i,policySigner:s,smartWallet:a,walletState:r})}}let fe=null;const we=e=>new Uint8Array(s.sha256.arrayBuffer(e)),be=(e,t,a)=>{const r=s.sha256.create();r.update(e.toBytes());for(const e of t)r.update(e.pubkey.toBytes()),r.update(Uint8Array.from([e.isSigner?1:0])),r.update(Uint8Array.from([e.pubkey.toString()===a.toString()||e.isWritable?1:0]));return new Uint8Array(r.arrayBuffer())},Se=(e,t)=>{const a=W(e),r=be(e.programId,a,t);return{policyDataHash:we(e.data),policyAccountsHash:r}},ke=(e,t,a)=>{const r=i.Buffer.alloc(4);r.writeUInt32LE(e.length,0);const n=i.Buffer.concat([r,...e.map(e=>{const t=i.Buffer.from(e.data),a=i.Buffer.alloc(4);return a.writeUInt32LE(t.length,0),i.Buffer.concat([a,t])})]),o=we(n),l=((e,t)=>{const a=new Map;for(const t of e){const e=t.pubkey.toString(),r=a.get(e);r?(r.isSigner=r.isSigner||t.isSigner,r.isWritable=r.isWritable||t.isWritable):a.set(e,{isSigner:t.isSigner,isWritable:t.isWritable})}const r=e.map(e=>{const t=e.pubkey.toString(),r=a.get(t);return{pubkey:e.pubkey,isSigner:r.isSigner,isWritable:r.isWritable}}),n=s.sha256.create();for(const e of r)n.update(e.pubkey.toBytes()),n.update(Uint8Array.from([e.isSigner?1:0])),n.update(Uint8Array.from([e.pubkey.toString()===t.toString()||e.isWritable?1:0]));return new Uint8Array(n.arrayBuffer())})(e.flatMap(e=>[{pubkey:e.programId,isSigner:!1,isWritable:!1},...W(e,a)]),t);return{cpiDataHash:o,cpiAccountsHash:l}},Ie=(e,t)=>{try{const a=(fe||(fe=new p.BorshCoder({version:"0.1.0",name:"lazorkit_msgs",instructions:[],accounts:[],types:[{name:"SimpleMessage",type:{kind:"struct",fields:[{name:"dataHash",type:{array:["u8",32]}}]}}]})),fe).types.encode(e,t);return i.Buffer.from(a)}catch(t){throw new Error(`Failed to encode ${e}: ${t instanceof Error?t.message:"Unknown error"}`)}};function Pe(e,t,a,r,n,s){const o=Se(r,e),l=((e,t,a)=>{const r=W(e,a),n=be(e.programId,r,t);return{cpiDataHash:we(e.data),cpiAccountsHash:n}})(n,e,s??[]),c=new Uint8Array(64);c.set(o.policyDataHash,0),c.set(o.policyAccountsHash,32);const d=we(c),u=new Uint8Array(64);u.set(l.cpiDataHash,0),u.set(l.cpiAccountsHash,32);const A=we(u),p=i.Buffer.alloc(8);p.writeBigUInt64LE(BigInt(t.toString()),0);const g=i.Buffer.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=i.Buffer.concat([p,g,i.Buffer.from(d),i.Buffer.from(A)]),h=we(m);return Ie("SimpleMessage",{dataHash:Array.from(h)})}function ve(e,t,a,r,n,s){const o=Se(r,e),l=ke(n,e,s),c=new Uint8Array(64);c.set(o.policyDataHash,0),c.set(o.policyAccountsHash,32);const d=we(c),u=new Uint8Array(64);u.set(l.cpiDataHash,0),u.set(l.cpiAccountsHash,32);const A=we(u),p=i.Buffer.alloc(8);p.writeBigUInt64LE(BigInt(t.toString()),0);const g=i.Buffer.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=i.Buffer.concat([p,g,i.Buffer.from(d),i.Buffer.from(A)]),h=we(m);return Ie("SimpleMessage",{dataHash:Array.from(h)})}function Ce(e){z(e.passkeyPublicKey,"passkeySignature.passkeyPublicKey"),Z(e.signature64,"passkeySignature.signature64"),Z(e.clientDataJsonRaw64,"passkeySignature.clientDataJsonRaw64"),Z(e.authenticatorDataRaw64,"passkeySignature.authenticatorDataRaw64");const t=Buffer.from(e.authenticatorDataRaw64,"base64"),a=Buffer.from(e.clientDataJsonRaw64,"base64"),r=Buffer.from(e.signature64,"base64");V(J(r),"passkeySignature.signature64 (decoded)");const n=Buffer.concat([t,Buffer.from(s.sha256.arrayBuffer(a))]);return oe(Buffer.from(s.sha256.arrayBuffer(n)),e.passkeyPublicKey,r)}function We(e){const t=Buffer.from(e.signature64,"base64");return V(J(t),"passkeySignature.signature64 (decoded)"),{passkeyPublicKey:e.passkeyPublicKey,signature:J(t),clientDataJsonRaw:Buffer.from(e.clientDataJsonRaw64,"base64"),authenticatorDataRaw:Buffer.from(e.authenticatorDataRaw64,"base64")}}function De(e){return p.web3.ComputeBudgetProgram.setComputeUnitLimit({units:e})}function Ee(e,t){return void 0===t?e:[De(t),...e]}function Be(e,t){return[e,...t]}function xe(e){return void 0!==e?1:0}async function Te(e,t,a,r={}){const{addressLookupTables:n,recentBlockhash:i,computeUnitLimit:s}=r,o=Ee(a,s),l=n||[],c=i||(await e.getLatestBlockhash()).blockhash;if(l.length>0){console.log("lookupTables in buildTransaction",l);const e=new p.web3.TransactionMessage({payerKey:t,recentBlockhash:c,instructions:o}).compileToV0Message(l);return{transaction:new p.web3.VersionedTransaction(e),isVersioned:!0,recentBlockhash:c}}{const e=(new p.web3.Transaction).add(...o);return e.feePayer=t,e.recentBlockhash=c,{transaction:e,isVersioned:!1,recentBlockhash:c}}}"undefined"!=typeof globalThis&&(globalThis.Buffer=i.Buffer),i.Buffer.prototype.subarray=function(e,t){const a=Uint8Array.prototype.subarray.apply(this,[e,t]);return Object.setPrototypeOf(a,i.Buffer.prototype),a};class Ue{constructor(e){this.connection=e,this.program=new p.Program(C,{connection:e}),this.programId=this.program.programId,this.defaultPolicyProgram=new ee(e),this.walletPdas=new he(this.programId),this.policyResolver=new ye(this.defaultPolicyProgram,this.walletPdas)}getSmartWalletPubkey(e){return this.walletPdas.smartWallet(e)}getWalletStatePubkey(e){return this.walletPdas.walletState(e)}getWalletDevicePubkey(e,t){return this.walletPdas.walletDevice(e,t)}getChunkPubkey(e,t){return this.walletPdas.chunk(e,t)}generateWalletId(){return new p.BN(D(8),"le")}async fetchWalletStateContext(e){const t=this.getWalletStatePubkey(e);return{walletState:t,data:await this.program.account.walletState.fetch(t)}}async fetchChunkContext(e,t){const a=this.getChunkPubkey(e,t);return{chunk:a,data:await this.program.account.chunk.fetch(a)}}validateCreateSmartWalletParams(e){N(e,"params"),K(e.payer,"params.payer"),z(e.passkeyPublicKey,"params.passkeyPublicKey"),Z(e.credentialIdBase64,"params.credentialIdBase64"),void 0!==e.amount&&F(e.amount,"params.amount"),void 0!==e.smartWalletId&&F(e.smartWalletId,"params.smartWalletId"),void 0!==e.policyDataSize&&Y(e.policyDataSize,"params.policyDataSize"),null!==e.policyInstruction&&void 0!==e.policyInstruction&&G(e.policyInstruction,"params.policyInstruction")}validateExecuteParams(e){N(e,"params"),K(e.payer,"params.payer"),K(e.smartWallet,"params.smartWallet"),L(e.credentialHash,"params.credentialHash"),G(e.cpiInstruction,"params.cpiInstruction"),F(e.timestamp,"params.timestamp"),null!==e.policyInstruction&&G(e.policyInstruction,"params.policyInstruction")}validateCreateChunkParams(e){N(e,"params"),K(e.payer,"params.payer"),K(e.smartWallet,"params.smartWallet"),L(e.credentialHash,"params.credentialHash"),q(e.cpiInstructions,"params.cpiInstructions"),F(e.timestamp,"params.timestamp"),null!==e.policyInstruction&&G(e.policyInstruction,"params.policyInstruction"),void 0!==e.cpiSigners&&X(e.cpiSigners,"params.cpiSigners")}validateExecuteChunkParams(e){N(e,"params"),K(e.payer,"params.payer"),K(e.smartWallet,"params.smartWallet"),q(e.cpiInstructions,"params.cpiInstructions"),void 0!==e.cpiSigners&&X(e.cpiSigners,"params.cpiSigners")}validateCloseChunkParams(e){N(e,"params"),K(e.payer,"params.payer"),K(e.smartWallet,"params.smartWallet"),F(e.nonce,"params.nonce")}async getWalletStateData(e){const{data:t}=await this.fetchWalletStateContext(e);return t}async getChunkData(e){return await this.program.account.chunk.fetch(e)}async getSmartWalletByPasskey(e){z(e,"passkeyPublicKey");const t=C.accounts?.find(e=>"WalletState"===e.name)?.discriminator;if(!t)throw new Q("WalletState discriminator not found in IDL","passkeyPublicKey");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:o.encode(t)}}]});for(const t of a)try{const a=this.program.coder.accounts.decode("WalletState",t.account.data);for(const r of a.devices)if(E(r.passkeyPubkey,e)){return{smartWallet:this.getSmartWalletPubkey(a.walletId),walletState:t.pubkey,deviceSlot:{passkeyPubkey:r.passkeyPubkey,credentialHash:r.credentialHash}}}}catch(e){continue}return{smartWallet:null,walletState:null,deviceSlot:null}}async getSmartWalletByCredentialHash(e){L(e,"credentialHash");const t=C.accounts?.find(e=>"WalletDevice"===e.name)?.discriminator;if(!t)throw new Q("WalletDevice discriminator not found in IDL","credentialHash");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:o.encode(t)}},{memcmp:{offset:41,bytes:o.encode(e)}}]});if(0===a.length)return null;for(const e of a){const t=await this.program.account.walletDevice.fetch(e.pubkey);return{smartWallet:t.smartWallet,walletState:this.getWalletStatePubkey(t.smartWallet),walletDevice:e.pubkey,passkeyPubkey:t.passkeyPubkey}}return null}async buildCreateSmartWalletIns(e,t,a,r){return K(e,"payer"),K(t,"smartWallet"),G(a,"policyInstruction"),N(r,"args"),z(r.passkeyPublicKey,"args.passkeyPublicKey"),L(r.credentialHash,"args.credentialHash"),F(r.walletId,"args.walletId"),F(r.amount,"args.amount"),await this.program.methods.createSmartWallet(r).accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),walletDevice:this.getWalletDevicePubkey(t,r.credentialHash),policyProgram:a.programId,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(a)]).instruction()}async buildExecuteIns(e,t,a,r,n,i,s){return K(e,"payer"),K(t,"smartWallet"),K(a,"walletDevice"),N(r,"args"),G(n,"policyInstruction"),G(i,"cpiInstruction"),void 0!==s&&X(s,"cpiSigners"),await this.program.methods.execute(r).accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),walletDevice:a,policyProgram:n.programId,cpiProgram:i.programId,ixSysvar:p.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(n),...W(i,s)]).instruction()}async buildCreateChunkIns(e,t,a,r,n){K(e,"payer"),K(t,"smartWallet"),K(a,"walletDevice"),N(r,"args"),G(n,"policyInstruction");const{walletState:i,data:s}=await this.fetchWalletStateContext(t),o=this.getChunkPubkey(t,s.lastNonce);return await this.program.methods.createChunk(r).accountsPartial({payer:e,smartWallet:t,walletState:i,walletDevice:a,policyProgram:n.programId,chunk:o,ixSysvar:p.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts([...W(n)]).instruction()}async buildExecuteChunkIns(e,t,a,r){K(e,"payer"),K(t,"smartWallet"),q(a,"cpiInstructions"),void 0!==r&&X(r,"cpiSigners");const{data:n}=await this.fetchWalletStateContext(t),s=n.lastNonce.sub(new p.BN(1)),{chunk:o,data:l}=await this.fetchChunkContext(t,s),c=a.map(e=>i.Buffer.from(e.data)),d=function(e){const t=[];let a=0;for(let r=0;r<e.length-1;r++)a+=e[r].keys.length+1,t.push(a);return t}(a),u=function(e,t){return e.flatMap(e=>[{pubkey:e.programId,isSigner:!1,isWritable:!1},...W(e,t)])}(a,r);return await this.program.methods.executeChunk(c,i.Buffer.from(d)).accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),chunk:o,sessionRefund:l.rentRefundAddress,systemProgram:p.web3.SystemProgram.programId}).remainingAccounts(u).instruction()}async buildCloseChunkIns(e,t,a){K(e,"payer"),K(t,"smartWallet"),F(a,"nonce");const{chunk:r,data:n}=await this.fetchChunkContext(t,a);return await this.program.methods.closeChunk().accountsPartial({payer:e,smartWallet:t,walletState:this.getWalletStatePubkey(t),chunk:r,sessionRefund:n.rentRefundAddress}).instruction()}async createSmartWalletTxn(e,t={}){this.validateCreateSmartWalletParams(e);const a=e.smartWalletId??this.generateWalletId(),r=this.getSmartWalletPubkey(a),n=this.getWalletStatePubkey(r),i=e.amount??new p.BN(H),s=e.policyDataSize??this.defaultPolicyProgram.getPolicyDataSize(),o=B(e.credentialIdBase64),l=await this.policyResolver.resolveForCreate({provided:e.policyInstruction,smartWalletId:a,smartWallet:r,walletState:n,passkeyPublicKey:e.passkeyPublicKey,credentialHash:o}),c={passkeyPublicKey:e.passkeyPublicKey,credentialHash:o,initPolicyData:l.data,walletId:a,amount:i,policyDataSize:s},d=await this.buildCreateSmartWalletIns(e.payer,r,l,c);return{transaction:(await Te(this.connection,e.payer,[d],t)).transaction,smartWalletId:a,smartWallet:r}}async executeTxn(e,t={}){this.validateExecuteParams(e);const a=Ce(e.passkeySignature),r=await this.getWalletStateData(e.smartWallet),n=this.getWalletDevicePubkey(e.smartWallet,e.credentialHash),i=await this.policyResolver.resolveForExecute({provided:e.policyInstruction,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:e.passkeySignature.passkeyPublicKey,walletStateData:r}),s=We(e.passkeySignature),o=Be(a,[await this.buildExecuteIns(e.payer,e.smartWallet,n,{...s,verifyInstructionIndex:xe(t.computeUnitLimit),splitIndex:i.keys.length,policyData:i.data,cpiData:e.cpiInstruction.data,timestamp:e.timestamp},i,e.cpiInstruction,[...e.cpiSigners??[],e.payer])]);return(await Te(this.connection,e.payer,o,t)).transaction}async createChunkTxn(e,t={}){this.validateCreateChunkParams(e);const a=Ce(e.passkeySignature),r=await this.getWalletStateData(e.smartWallet),n=this.getWalletDevicePubkey(e.smartWallet,e.credentialHash),i=await this.policyResolver.resolveForExecute({provided:e.policyInstruction,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:e.passkeySignature.passkeyPublicKey,walletStateData:r}),o=We(e.passkeySignature),l=function(e,t,a){const r=ke(e,t,a),n=new Uint8Array(64);return n.set(r.cpiDataHash,0),n.set(r.cpiAccountsHash,32),Array.from(new Uint8Array(s.sha256.arrayBuffer(n)))}(e.cpiInstructions,e.smartWallet,[...e.cpiSigners??[],e.payer]),c=Be(a,[await this.buildCreateChunkIns(e.payer,e.smartWallet,n,{...o,policyData:i.data,verifyInstructionIndex:xe(t.computeUnitLimit),timestamp:e.timestamp,cpiHash:Array.from(l)},i)]);return(await Te(this.connection,e.payer,c,t)).transaction}async executeChunkTxn(e,t={}){this.validateExecuteChunkParams(e);const a=await this.buildExecuteChunkIns(e.payer,e.smartWallet,e.cpiInstructions,e.cpiSigners);return(await Te(this.connection,e.payer,[a],t)).transaction}async closeChunkTxn(e,t={}){this.validateCloseChunkParams(e);const a=await this.buildCloseChunkIns(e.payer,e.smartWallet,e.nonce);return(await Te(this.connection,e.payer,[a],t)).transaction}async buildAuthorizationMessage(e){let t;const{action:a,smartWallet:r,passkeyPublicKey:n,credentialHash:i,timestamp:s}=e;switch(a.type){case exports.SmartWalletAction.Execute:{const{policyInstruction:i,cpiInstruction:o,cpiSigners:l}=a.args,c=await this.getWalletStateData(e.smartWallet),d=await this.policyResolver.resolveForExecute({provided:i,smartWallet:e.smartWallet,credentialHash:e.credentialHash,passkeyPublicKey:n,walletStateData:c});t=Pe(r,(await this.getWalletStateData(r)).lastNonce,s,d,o,[...l??[],e.payer]);break}case exports.SmartWalletAction.CreateChunk:{const{policyInstruction:o,cpiInstructions:l,cpiSigners:c}=a.args,d=await this.getWalletStateData(r);if(o)t=ve(r,d.lastNonce,s,o,l,[...c??[],e.payer]);else{const a=this.getWalletDevicePubkey(r,i),o=await this.defaultPolicyProgram.buildCheckPolicyIx({walletId:d.walletId,passkeyPublicKey:n,policySigner:a,smartWallet:r,credentialHash:i,policyData:d.policyData});t=ve(r,d.lastNonce,s,o,l,[...c??[],e.payer])}break}default:throw new Q(`Unsupported SmartWalletAction: ${a.type}`,"action.type")}return t}}"function"!=typeof globalThis.structuredClone&&(globalThis.structuredClone=e=>JSON.parse(JSON.stringify(e)));class Re extends l.EventEmitter{constructor(){super(),this.iframeRef=null,this.retryDelays=[200,400,800,1500,3e3]}setIframeRef(e){this.iframeRef=e}notifyCredentialsUpdated(e){this.emit("credentials-updated",e);const t=new CustomEvent("lazorkit:credentials-updated",{detail:e,bubbles:!0,cancelable:!0});window.dispatchEvent(t)}syncCredentials(e=!1){this.iframeRef&&this.iframeRef.contentWindow?this.performCredentialSync(e):setTimeout(()=>this.syncCredentials(e),500)}performCredentialSync(e){if(!this.iframeRef?.contentWindow)throw new Error("Cannot sync credentials: iframe reference not available");const t=localStorage.getItem("CREDENTIAL_ID")||"",a=localStorage.getItem("PUBLIC_KEY")||"",r=localStorage.getItem("SMART_WALLET_ADDRESS")||"";if(!(e||t&&a))return;const n={type:"SYNC_CREDENTIALS",data:{credentialId:t,publickey:a,smartWalletAddress:r,timestamp:Date.now()}};try{this.iframeRef.contentWindow.postMessage(n,"*"),this.retryDelays.forEach(e=>{setTimeout(()=>{try{this.iframeRef?.contentWindow&&this.iframeRef.contentWindow.postMessage(n,"*")}catch(e){}},e)})}catch(e){}}storeCredential(e){e.credentialId&&localStorage.setItem("CREDENTIAL_ID",e.credentialId),e.publickey&&localStorage.setItem("PUBLIC_KEY",e.publickey),e.smartWalletAddress&&localStorage.setItem("SMART_WALLET_ADDRESS",e.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",(new Date).toISOString())}destroy(){this.removeAllListeners(),this.iframeRef=null}}class Me extends l.EventEmitter{constructor(e){super(),this.dialogRef=null,this.iframeRef=null,this.popupWindow=null,this.popupCloseInterval=null,this.isClosing=!1,this.isDestroyed=!1,this.logger=new I("DialogManager"),this._currentAction=null,this.config=e,this.credentialManager=new Re,this.logger.debug("Created dialog manager"),this.setupMessageListener()}async openConnect(){return new Promise((e,t)=>{const a=()=>{this.off("connect-result",r),this.off("error",n)},r=t=>{a(),e(t)},n=e=>{a(),t(e)};this.on("connect-result",r),this.on("error",n);const i=setTimeout(()=>{a(),t(new Error("Connection timed out after 60 seconds"))},6e4),s=e,o=t;e=e=>{clearTimeout(i),s(e)},t=e=>{clearTimeout(i),o(e)},this._currentAction=f.CONNECT;if(this.shouldUsePopup("connect")){const e=`${this.config.portalUrl}?action=${f.CONNECT}`;this.openPopup(e).catch(t)}else this.openConnectDialog().catch(t)})}async openSign(e,t,a,r){return new Promise((n,i)=>{const s=()=>{this.off("sign-result",o),this.off("error",l)},o=e=>{s(),n(e)},l=e=>{s(),i(e)};this.on("sign-result",o),this.on("error",l);const c=setTimeout(()=>{s(),i(new Error("Signing timed out after 60 seconds"))},6e4),d=n,u=i;n=e=>{clearTimeout(c),d(e)},i=e=>{clearTimeout(c),u(e)},this._currentAction=f.SIGN;const A=this.shouldUsePopup("sign"),p=encodeURIComponent(e);let g=`${this.config.portalUrl}?action=${f.SIGN}&message=${p}&transaction=${encodeURIComponent(t)}&credentialId=${encodeURIComponent(a)}`;r&&(g+=`&clusterSimulation=${r}`),A?this.openPopup(g).catch(i):this.openSignDialog(g).catch(i)})}async openSignMessage(e,t){return new Promise((a,r)=>{const n=()=>{this.off("sign-result",i),this.off("error",s)},i=e=>{n(),a(e)},s=e=>{n(),r(e)};this.on("sign-result",i),this.on("error",s);const o=setTimeout(()=>{n(),r(new Error("Signing timed out after 60 seconds"))},6e4),l=a,c=r;a=e=>{clearTimeout(o),l(e)},r=e=>{clearTimeout(o),c(e)},this._currentAction=f.SIGN;const d=encodeURIComponent(e),u=`${this.config.portalUrl}?action=${f.SIGN}&message=${d}&credentialId=${encodeURIComponent(t)}`;this.shouldUsePopup("sign")?this.openPopup(u).catch(r):this.openSignDialog(u).catch(r)})}async openConnectDialog(){const e=`${this.config.portalUrl}?action=${f.CONNECT}`;await this.openModal(e)}ensureFonts(){const e="lazorkit-font-roboto-flex";if(document.getElementById(e))return;const t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&display=swap",document.head.appendChild(t)}ensureDialogBackdropCSS(){const e="lazorkit-dialog-backdrop-style";if(document.getElementById(e))return;const t=document.createElement("style");t.id=e,t.textContent='\n    /* ===== Backdrop (overlay nh) ===== */\n    dialog#lazorkit-dialog::backdrop {\n      background: rgba(0,0,0,0);\n      animation: lazor-backdrop-in 160ms ease-out forwards;\n    }\n\n    dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n      animation: lazor-backdrop-out 140ms ease-in forwards;\n    }\n\n    @keyframes lazor-backdrop-in {\n      from { background: rgba(0,0,0,0); }\n      to   { background: rgba(0,0,0,0.12); } /*  overlay nh */\n    }\n\n    @keyframes lazor-backdrop-out {\n      from { background: rgba(0,0,0,0.12); }\n      to   { background: rgba(0,0,0,0); }\n    }\n\n    /* ===== Panel animations ===== */\n    @keyframes lazor-drawer-in {\n      from { transform: translateY(16px); opacity: 0.98; }\n      to   { transform: translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-drawer-out {\n      from { transform: translateY(0); opacity: 1; }\n      to   { transform: translateY(16px); opacity: 0.98; }\n    }\n\n    @keyframes lazor-float-in {\n      from { transform: scale(0.985) translateY(4px); opacity: 0; }\n      to   { transform: scale(1) translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-float-out {\n      from { transform: scale(1) translateY(0); opacity: 1; }\n      to   { transform: scale(0.985) translateY(4px); opacity: 0; }\n    }\n\n    #lazorkit-panel {\n      will-change: transform, opacity;\n      transform-origin: center;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-drawer-in 180ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-drawer-out 150ms ease-in forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-float-in 170ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-float-out 140ms ease-in forwards;\n    }\n\n    /* ===== Reduced motion ===== */\n    @media (prefers-reduced-motion: reduce) {\n      dialog#lazorkit-dialog::backdrop {\n        animation: none !important;\n        background: rgba(0,0,0,0.12) !important;\n      }\n      dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n        background: rgba(0,0,0,0) !important;\n      }\n      dialog#lazorkit-dialog #lazorkit-panel {\n        animation: none !important;\n      }\n    }\n  ',document.head.appendChild(t)}createCloseButton(e){const t=document.createElement("button");return t.type="button",t.title="Close Dialog",t.setAttribute("aria-label","Close Dialog"),Object.assign(t.style,{width:"36px",height:"36px",borderRadius:"10px",border:"none",background:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0",color:"rgba(255, 255, 255, 0.6)",outline:"none",webkitTapHighlightColor:"transparent"}),t.addEventListener("mouseenter",()=>{t.style.background="rgba(255,255,255,0.1)",t.style.color="#ffffff"}),t.addEventListener("mouseleave",()=>{t.style.background="transparent",t.style.color="rgba(255, 255, 255, 0.6)"}),t.onclick=e,t.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg"\n      width="20" height="20" viewBox="0 0 24 24"\n      fill="none" stroke="currentColor" stroke-width="2"\n      stroke-linecap="round" stroke-linejoin="round">\n      <line x1="18" y1="6" x2="6" y2="18" />\n      <line x1="6" y1="6" x2="18" y2="18" />\n    </svg>\n  ',t}async openSignDialog(e){await this.openModal(e),this.iframeRef&&(this.credentialManager.setIframeRef(this.iframeRef),setTimeout(()=>{this.credentialManager.syncCredentials(!0)},500))}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}shouldUsePopup(e){const t=this.isMobileDevice();return!(!this.isSafari()||"connect"!==e)||(!(!t||"connect"!==e)||!(!t&&"sign"===e)&&(!t||"sign"!==e))}getPopupDimensions(){if(!window.top)return{width:450,height:600,top:0,left:0};const e=window.top.outerWidth/2+window.top.screenX-225;return{width:450,height:600,top:window.top.outerHeight/2+window.top.screenY-300,left:e}}async openPopup(e){if(this.popupWindow&&!this.popupWindow.closed)try{this.popupWindow.close()}catch(e){}const t=this.getPopupDimensions();if(this.popupWindow=window.open(e,"lazorkit-popup",`width=${t.width},height=${t.height},top=${t.top},left=${t.left},resizable,scrollbars,status`),this.startPopupMonitor(),!this.popupWindow)throw this.logger.error("Popup was blocked by browser"),new Error("Popup was blocked by browser")}startPopupMonitor(){this.popupCloseInterval&&clearInterval(this.popupCloseInterval),this.popupCloseInterval=setInterval(()=>{this.popupWindow?.closed&&(this.popupWindow=null,this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null))},500)}async openModal(e){this.dialogRef||this.createModal(),this.iframeRef&&(this.iframeRef.src=e),this.dialogRef&&!this.dialogRef.open&&(this.dialogRef.setAttribute("data-state","opening"),this.dialogRef.showModal(),window.setTimeout(()=>{this.dialogRef?.open&&this.dialogRef.setAttribute("data-state","idle")},220))}createModal(){this.ensureFonts(),this.ensureDialogBackdropCSS();const e=document.createElement("dialog");e.id="lazorkit-dialog",e.style.colorScheme="dark",e.setAttribute("data-theme","dark");const t=this.isMobileDevice(),a=(e=>({overlay:{position:"fixed",inset:0,padding:0,border:"none",background:"transparent",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",overflow:"visible",zIndex:2147483647,display:"grid",placeItems:e?"end center":"center"},panel:{width:e?"100%":"360px",maxWidth:e?"100%":"90vw",height:e?"55vh":"650px",maxHeight:e?"55vh":"90vh",background:"white",borderRadius:e?"20px 20px 0 0":"20px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",position:"relative"},closeButton:{zIndex:10},iframeContainer:{position:"relative",width:"100%",height:"100%",border:"none",margin:0,padding:0,overflow:"hidden",borderRadius:"inherit",background:"white"},iframe:{width:"100%",height:"100%",border:0,borderRadius:"inherit",display:"block"}}))(t);Object.assign(e.style,a.overlay),Object.assign(e.style,{"--background-color-th_base":"#191919","--background-color-th_frame":"#191919","--text-color-th_base":"#eeeeee","--border-color-th_frame":"rgba(255,255,255,0.10)"});const r=document.createElement("div"),n=t?"drawer":"floating";e.setAttribute("data-variant",n),e.setAttribute("data-state","idle"),r.id="lazorkit-panel",Object.assign(r.style,a.panel),Object.assign(r.style,{display:"flex",flexDirection:"column"}),Object.assign(r.style,{background:"var(--background-color-th_base, #fcfcfc)",color:"var(--text-color-th_base, #202020)",fontFamily:'"Roboto Flex", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'});const i=document.createElement("div");Object.assign(i.style,{height:"32px",flex:"0 0 auto",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 12px",boxSizing:"border-box",borderBottom:"1px solid rgba(0,0,0,0.08)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, var(--background-color-th_base, #fcfcfc))",color:"var(--text-color-th_base, #202020)",borderBottom:"1px solid var(--border-color-th_frame, rgba(0,0,0,0.08))"});const s=document.createElement("div");Object.assign(s.style,a.iframeContainer),Object.assign(s.style,{flex:"1 1 auto"}),Object.assign(s.style,{background:"var(--background-color-th_base, #fcfcfc)"}),Object.assign(r.style,{background:"var(--background-color-th_base, #191919)",color:"var(--text-color-th_base, #eeeeee)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, #191919)",color:"var(--text-color-th_base, #eeeeee)",borderBottom:"1px solid var(--border-color-th_frame, rgba(255,255,255,0.10))"}),Object.assign(s.style,{background:"var(--background-color-th_base, #191919)"});const o=this.createCloseButton(()=>{this.closeDialog(),this.emit("close")});Object.assign(o.style,{position:"static",top:"",right:""}),o.id="lazorkit-dialog-close",o.ariaLabel="Close",Object.assign(o.style,a.closeButton);const l=document.createElement("iframe");l.id="lazorkit-iframe",Object.assign(l.style,a.iframe),l.allow=`publickey-credentials-get ${this.config.portalUrl}; publickey-credentials-create ${this.config.portalUrl}; clipboard-write; camera; microphone`;const c=l.sandbox;c.add("allow-forms"),c.add("allow-scripts"),c.add("allow-same-origin"),c.add("allow-popups"),c.add("allow-popups-to-escape-sandbox"),c.add("allow-modals"),l.setAttribute("aria-label","Lazor Wallet"),l.tabIndex=0,l.title="Lazor",e.addEventListener("cancel",()=>this.closeDialog()),e.addEventListener("click",t=>{t.target===e&&this.closeDialog()}),i.appendChild(o),r.appendChild(i),s.appendChild(l),r.appendChild(s),e.appendChild(r),document.body.appendChild(e),this.dialogRef=e,this.iframeRef=l}setupMessageListener(){window.addEventListener("message",e=>{if(!e.origin.includes(new URL(this.config.portalUrl).hostname))return;const{type:t,data:a,error:r}=e.data;if(r)this.emit("error",new Error(r.message||"Portal error"));else switch(t){case"connect-result":case"WALLET_CONNECTED":const e={publicKey:a.publickey||a.publicKey||"",credentialId:a.credentialId,isCreated:"create"===a.connectionType||!!a.publickey,connectionType:a.connectionType||(a.publickey?"create":"get"),timestamp:a.timestamp||Date.now(),accountName:a.accountName};this.emit("connect-result",e),this.closeDialog();break;case"sign-result":case"SIGNATURE_CREATED":const t={signature:a.normalized,clientDataJsonBase64:a.clientDataJSONReturn,authenticatorDataBase64:a.authenticatorDataReturn,signedPayload:a.msg};this.emit("sign-result",t),this.closeDialog();break;case"error":this.emit("error",new Error(a?.message||"Unknown portal error"));break;case"close":this.closeDialog()}})}closeDialog(){if(this.isClosing)return;this.isClosing=!0;const e=this.dialogRef,t=this.iframeRef;try{e&&e.setAttribute("data-state","closing"),window.setTimeout(()=>{try{if(t&&(t.parentNode&&t.parentNode.removeChild(t),this.iframeRef=null),e){try{e.open&&e.close()}catch{}e.parentNode&&e.parentNode.removeChild(e),this.dialogRef=null}if(this.popupWindow){try{this.popupWindow.close()}catch{}this.popupWindow=null}this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null),this.logger.debug("Closed dialog (animated)")}catch(e){this.logger.error("Error during animated close:",e)}finally{this.isClosing=!1}},170)}catch(e){this.logger.error("Error closing dialog:",e),this.isClosing=!1}}getIframeRef(){return this.iframeRef}getDialogRef(){return this.dialogRef}getPopupWindow(){return this.popupWindow}getCurrentAction(){return this._currentAction}destroy(){this.isDestroyed||(this.isDestroyed=!0,this.closeDialog(),this.credentialManager.destroy(),this.removeAllListeners(),this.logger.debug("Destroyed dialog manager"))}}const He=e=>new Me({portalUrl:e.portalUrl,rpcUrl:e.rpcUrl,paymasterUrl:e.paymasterConfig.paymasterUrl}),Qe=e=>Array.from(new Uint8Array(s.sha256.arrayBuffer(Buffer.from(e,"base64")))),Ne=(e,t,a)=>{const r=e instanceof Error?e:new Error(String(e));throw t({error:r}),a?.(r),r},Ke=e=>e?Array.from(Buffer.from(e,"base64")):[],Oe=async(e,t,a)=>{const{isConnecting:r,config:n}=e();if(r)throw new Error("Already connecting");t({isConnecting:!0,error:null});try{const r=await k.getWallet();if((()=>{if("undefined"==typeof window)return;const e=localStorage.getItem("lazorkit-wallet");if(e)try{const t=JSON.parse(e);t.state&&void 0!==t.version&&localStorage.removeItem("lazorkit-wallet")}catch(e){}})(),r)return t({wallet:r}),a?.onSuccess?.(r),r;const i=He(n);try{const r=await i.openConnect(),s=new P(n.paymasterConfig),o=new Ue(e().connection),l=Qe(r.credentialId),c=await o.getSmartWalletByCredentialHash(l);let d,u;if(!r.publicKey&&c?(u=Buffer.from(c.passkeyPubkey).toString("base64"),localStorage.setItem("PUBLIC_KEY",u)):u=r.publicKey,c)d=c.smartWallet.toBase58();else{const e=await s.getPayer(),t=await o.createSmartWalletTxn({passkeyPublicKey:Ke(u),payer:e,credentialIdBase64:r.credentialId});await s.signAndSend(t.transaction),d=t.smartWallet.toBase58()}const A={credentialId:r.credentialId,passkeyPubkey:Ke(u),expo:"web",platform:navigator.platform,smartWallet:d,walletDevice:"",accountName:r.accountName};return await k.saveWallet(A),t({wallet:A}),a?.onSuccess?.(A),A}finally{i.destroy()}}catch(e){return Ne(e,t,a?.onFail)}finally{t({isConnecting:!1})}},ze=r.create()(h((e,t)=>({wallet:null,config:{portalUrl:y.PORTAL_URL,paymasterConfig:{paymasterUrl:y.PAYMASTER_URL},rpcUrl:y.RPC_ENDPOINT},connection:new a.Connection(y.RPC_ENDPOINT,w),isLoading:!1,isConnecting:!1,isSigning:!1,error:null,setConfig:t=>{try{const r=new a.Connection(t.rpcUrl||y.RPC_ENDPOINT,w);e({config:t,connection:r})}catch(e){throw console.error("Failed to update wallet configuration:",e,{config:t}),new Error(`Failed to update configuration: ${e}`)}},setWallet:t=>{try{e({wallet:t})}catch(e){throw console.error("Failed to set wallet:",e,{wallet:t}),e}},setLoading:t=>e({isLoading:t}),setConnecting:t=>e({isConnecting:t}),setSigning:t=>e({isSigning:t}),setConnection:t=>{try{e({connection:t})}catch(e){throw console.error("Failed to set connection:",e,{endpoint:t?.rpcEndpoint}),e}},setError:t=>{e({error:t}),t&&console.error("Error state set:",t)},clearError:()=>{e({error:null})},connect:a=>Oe(t,e,a),disconnect:()=>(async(e,t)=>{try{await k.clearWallet(),e({wallet:null,error:null,isConnecting:!1,isSigning:!1,isLoading:!1}),t?.onSuccess?.()}catch(a){return Ne(a,e,t?.onFail)}})(e),signAndSendTransaction:a=>(async(e,t,a)=>{const{isSigning:r,connection:n,wallet:i,config:s}=e();if(r)throw new Error("Already signing");if(!i)throw new Error("No wallet connected");if(!n)throw new Error("No connection available");t({isSigning:!0,error:null});try{const e=new P(s.paymasterConfig),t=new Ue(n),r=await e.getPayer(),o=await x(n),l=await t.buildAuthorizationMessage({action:{type:exports.SmartWalletAction.CreateChunk,args:{policyInstruction:null,cpiInstructions:a.instructions}},payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),passkeyPublicKey:i.passkeyPubkey,timestamp:new p.BN(o),credentialHash:Qe(i.credentialId)}),c=Buffer.from(l).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=await n.getLatestBlockhash(),u=new p.web3.TransactionMessage({payerKey:r,recentBlockhash:d.blockhash,instructions:a.instructions}).compileToV0Message(),A=new p.web3.VersionedTransaction(u),g=Buffer.from(A.serialize()).toString("base64"),m=He(s),h=i.credentialId,y=a.transactionOptions?.clusterSimulation;try{const s=await m.openSign(c,g,h,y),l={msg:c,normalized:s.signature,clientDataJSONReturn:s.clientDataJsonBase64,authenticatorDataReturn:s.authenticatorDataBase64},d=Qe(i.credentialId),u=await t.createChunkTxn({payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),passkeySignature:{passkeyPublicKey:i.passkeyPubkey,signature64:l.normalized,clientDataJsonRaw64:l.clientDataJSONReturn,authenticatorDataRaw64:l.authenticatorDataReturn},policyInstruction:null,cpiInstructions:a.instructions,timestamp:o,credentialHash:d}),A=await e.signAndSend(u);await n.confirmTransaction(A);const f=a.transactionOptions?.addressLookupTableAccounts||[],w=await t.executeChunkTxn({payer:r,smartWallet:new p.web3.PublicKey(i.smartWallet),cpiInstructions:a.instructions},{addressLookupTables:f,computeUnitLimit:a.transactionOptions?.computeUnitLimit});let b;return b=f.length>0?await e.signAndSendVersionedTransaction(w):await e.signAndSend(w),a.onSuccess?.(b),b}finally{m.destroy()}}catch(e){return Ne(e,t,a.onFail)}finally{t({isSigning:!1})}})(t,e,a),signMessage:a=>(async(e,t,a)=>{const{isSigning:r,wallet:n,config:i}=e();if(r)throw new Error("Already signing");if(!n)throw new Error("No wallet connected");t({isSigning:!0,error:null});try{const e=He(i);try{const t=await e.openSignMessage(a,n.credentialId);return{signature:t.signature,signedPayload:t.signedPayload}}finally{e.destroy()}}catch(e){throw t({error:e}),e}finally{t({isSigning:!1})}})(t,e,a)}),{name:"lazorkit-wallet-store",storage:g(()=>S),partialize:e=>({wallet:e.wallet,config:e.config})}));function Le(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}async function Ve(e){let t=e;if(64===t.length){const e=new Uint8Array(65);e[0]=4,e.set(t,1),t=e}return crypto.subtle.importKey("raw",t,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])}async function Fe({signedPayload:e,signature:t,publicKey:a}){const r=Le(e),n=Le(t),i=Le(a),s=await Ve(i);return crypto.subtle.verify({name:"ECDSA",hash:"SHA-256"},s,n,r)}const _e="CREDENTIAL_ID",je="PUBLIC_KEY",Ge="SMART_WALLET_ADDRESS";const Je="Lazorkit Wallet",Ze={rpcUrl:"https://api.devnet.solana.com",portalUrl:"https://portal.lazor.sh",paymasterConfig:{paymasterUrl:"https://kora.devnet.lazorkit.com"}};class Ye extends c.BaseWalletAdapter{constructor(e){super(),this.name=Je,this.url="https://lazorkit.com",this.icon="data:image/png;base64,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",this.supportedTransactionVersions=new Set(["legacy",0]),this._publicKey=null,this._readyState="undefined"==typeof window||"undefined"==typeof document?c.WalletReadyState.Unsupported:c.WalletReadyState.Installed,this._connecting=!1,this._wallet=null,this._config=Ze,e&&(this._config={...this._config,...e})}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==c.WalletReadyState.Installed)throw new c.WalletWindowClosedError;this._connecting=!0,this.emit("readyStateChange",this._readyState);const e=await k.getWallet();if(e)return void this._updateWalletState(e);const t=this._createDialogManager();try{const e=await t.openConnect(),a=await this._ensureWalletOnChain(e);await k.saveWallet(a),this._updateWalletState(a)}finally{t.destroy()}}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}_updateWalletState(e){this._wallet=e,this._publicKey=new a.PublicKey(e.smartWallet),this.emit("connect",this._publicKey)}_createDialogManager(){return new Me({portalUrl:this._config.portalUrl,rpcUrl:this._config.rpcUrl,paymasterUrl:this._config.paymasterConfig.paymasterUrl})}async _ensureWalletOnChain(e){const t=new a.Connection(this._config.rpcUrl),r=new d.KoraClient({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),n=new Ue(t),s=Qe(e.credentialId),o=await n.getSmartWalletByCredentialHash(s);let l,c;if(!e.publicKey&&o?(c=i.Buffer.from(o.passkeyPubkey).toString("base64"),localStorage.setItem("PUBLIC_KEY",c)):c=e.publicKey,o)l=o.smartWallet.toBase58();else{const t=await r.getPayerSigner(),a=await n.createSmartWalletTxn({passkeyPublicKey:Ke(e.publicKey),payer:new p.web3.PublicKey(t.signer_address),credentialIdBase64:e.credentialId});await r.signAndSendTransaction({transaction:i.Buffer.from(a.transaction.serialize({requireAllSignatures:!1})).toString("base64"),signer_key:t.signer_address}),l=a.smartWallet.toBase58()}return{credentialId:e.credentialId,passkeyPubkey:Ke(c),expo:"web",platform:navigator.platform,smartWallet:l,walletDevice:""}}async disconnect(){await k.clearWallet(),this._wallet=null,this._publicKey=null,this.emit("disconnect")}async sendTransaction(e){try{if(!this._wallet||!this._publicKey)throw new c.WalletDisconnectedError;const t=this._prepareInstructions(e);if(0===t.length)throw new c.WalletSignTransactionError("No instructions to sign");const r=this._initializeClients();let n=[];if("version"in e){const t=e.message.addressTableLookups;n=await Promise.all(t.map(async e=>{const t=await r.connection.getAccountInfo(e.accountKey);if(!t)throw new Error("Lookup table not found");return new a.AddressLookupTableAccount({key:e.accountKey,state:a.AddressLookupTableAccount.deserialize(t.data)})}))}const i=await r.paymaster.getPayerSigner(),s=await x(r.connection),o=Qe(this._wallet.credentialId),l=await this._buildAuthorizationMessage(r.smartWallet,t,i.signer_address,s,o),d=await r.connection.getLatestBlockhash(),u=await this._signWithDialog(l,t,d.blockhash,i.signer_address);return await this._executeSmartWalletTransaction(r,t,u,i.signer_address,s,o,n)}catch(e){throw this.emit("error",e),e}}async signTransaction(e){throw new c.WalletSignTransactionError("Lazorkit Wallet does not support signTransaction. Please use sendTransaction or signAndSendTransaction.")}async signAllTransactions(e){throw new c.WalletSignTransactionError("Lazorkit Wallet does not support signAllTransactions. Please use sendTransaction or signAndSendTransaction.")}async signMessage(e){const t=this._createDialogManager();try{if(!this._wallet||!this._publicKey)throw new c.WalletDisconnectedError;const a=i.Buffer.from(e).toString("base64"),r=await t.openSign(a,"",this._wallet.credentialId,this._config.clusterSimulation),n=JSON.stringify({signature:r.signature,signedPayload:r.signedPayload});return new Uint8Array(i.Buffer.from(n))}catch(e){throw this.emit("error",e),e}finally{t.destroy()}}_initializeClients(){const e=new a.Connection(this._config.rpcUrl);return{connection:e,paymaster:new d.KoraClient({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),smartWallet:new Ue(e)}}_prepareInstructions(e){return"version"in e?e.message.compiledInstructions.map(t=>new a.TransactionInstruction({keys:t.accountKeyIndexes.map(t=>({pubkey:e.message.staticAccountKeys[t],isSigner:e.message.isAccountSigner(t),isWritable:e.message.isAccountWritable(t)})),programId:new a.PublicKey(e.message.staticAccountKeys[t.programIdIndex]),data:i.Buffer.from(t.data)})):[...e.instructions]}async _buildAuthorizationMessage(e,t,a,r,n){return await e.buildAuthorizationMessage({action:{type:exports.SmartWalletAction.CreateChunk,args:{policyInstruction:null,cpiInstructions:t}},payer:new p.web3.PublicKey(a),smartWallet:this._publicKey,passkeyPublicKey:this._wallet.passkeyPubkey,timestamp:new p.BN(r),credentialHash:n})}async _signWithDialog(e,t,a,r){const n=i.Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,""),s=this._createDialogManager();try{const e=new p.web3.TransactionMessage({payerKey:new p.web3.PublicKey(r),recentBlockhash:a,instructions:t}).compileToV0Message(),o=new p.web3.VersionedTransaction(e),l=i.Buffer.from(o.serialize()).toString("base64");return await s.openSign(n,l,this._wallet.credentialId,this._config.clusterSimulation)}finally{s.destroy()}}async _executeSmartWalletTransaction(e,t,a,r,n,i,s){const o=await e.smartWallet.createChunkTxn({payer:new p.web3.PublicKey(r),smartWallet:this._publicKey,passkeySignature:{passkeyPublicKey:this._wallet.passkeyPubkey,signature64:a.signature,clientDataJsonRaw64:a.clientDataJsonBase64,authenticatorDataRaw64:a.authenticatorDataBase64},policyInstruction:null,cpiInstructions:t,timestamp:n,credentialHash:i}),l=await this._sendToPaymaster(e.paymaster,o,r);await e.connection.confirmTransaction(l,"confirmed");const c=await e.smartWallet.executeChunkTxn({payer:new p.web3.PublicKey(r),smartWallet:this._publicKey,cpiInstructions:t},{addressLookupTables:s});return await this._sendToPaymaster(e.paymaster,c,r)}async _sendToPaymaster(e,t,a){let r;r="version"in t?i.Buffer.from(t.serialize()):i.Buffer.from(t.serialize({requireAllSignatures:!1,verifySignatures:!1}));return(await e.signAndSendTransaction({transaction:r.toString("base64"),signer_key:a})).signature}}class Xe{constructor(e){this.version="1.0.0",this.name=Je,this.icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABXCAAAAAA8UASIAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAACYktHRAD/h4/MvwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB+kMEAUXDRWPYLQAAAB3dEVYdFJhdyBwcm9maWxlIHR5cGUgOGJpbQAKOGJpbQogICAgICA0MAozODQyNDk0ZDA0MDQwMDAwMDAwMDAwMDAzODQyNDk0ZDA0MjUwMDAwMDAwMDAwMTBkNDFkOGNkOThmMDBiMjA0ZTk4MDA5OTgKZWNmODQyN2UKplPDjgAAAAFvck5UAc+id5oAAAg8SURBVGje7ZlNkFVHFcf/53T3ve/NmzcDBASBVCVAEhBC+AoYRciHAwSDliRllS5MlS50kY1WWeXGrSuLilVaxU5LF1bhB4pgCAmJkErkc6pgwghJDMQKhO9hhnkz797bfY6L92YYPmbefeM4btKLe2/fvn1+fU6f7j7dl+YTCAQQABAIVH9Ry4x4uutCNKKwLoCUuFZ4WxExJiEp1E4GB4pJ0QegSdFnsvoHmBy7KXRy9JlIP9Axymiy/O1Tzqec/ytneBQEE4hFUF9KbiutrSq1vHLgAA405gAaXZ8okAbEw4IVUFANpaogIiICwRuNKI3Ga7eMSGJKg9barQTUm1y7iIqIiLCxIUUhNOCMui7YYDBIzg+t57ct7fXlnQjwLok1aLDj5KQRYIy3AQCUbl1JSWsZIiJwHFITJU7HyYkgEtuQ2VsRBQ1FF7X+qsUhtrfFVceeRcfkZNLedz20Uz9GckBaD3i4fldO+rTY1j9eu5m4t+3HpXNJex2j9f4ZiqmknrVyfU5x+6UZaXOc4bESIlM5uHnRP9+8YtpDsCCpB2eBrQqp8WSVOVSmrF/wR3x3+U+gqrX23CvRqHGiOu3xj6ycd/1wFxXgvDGqRJBYUzZKviXT4sBg21NLut7qeGDauR3MPFqcCBqdQwpjJE3aVyyPzxy54MoizFAFgUmJKTjfN3XtmmOHl6w9cfibvwrMXBtl9+SYaaNwOAiRcAGnDl+Ys3Fpdj6FgVdDauGtTUA3XcdX+3/bulV2/P3Fsx8UmRR1n2xGH7EswkzieKDStmzF1FPHPzFFyoywUSVzs7Bm9b/3T996ec+llnnPvlwWACDm0KzdglpWJQNvo8EBN/Pxxb3HTg+4yGVa8APm82sv/nXalmTf+1NM/w/3/ovrQX3T/QOHTA0rB2KAkSUti1dPfa/zLJVsH69+8souu7Vl77uFcjawdtH26UGYoPXQsyl9RA2TKoMgzMoUqjJr5aPJka5sacfNHeGF6fuOx+XgY3np132mNryIWJrV5879D4GpmrnFK+7z4U/XXpj31tvWxamlK99O/vCZrC7hbruxNscBK6yKqejs9MZzyw69oZEzwYhMe3Fbi1BmMGb/5N8vkIowo4XOd6zv+tlAm0ZZML546XtvJKUsNg0q5+YQiDVA497v07br5ZJ4scLmxhPh0NSMk4Ifs3YTcXwAE8gOLiz/wk8hR84IMrYbdrV4YuMb1M7NIVWIEpIvH2gNIB+CkIuubzh7zhmBldHtgOb2CwRV0vSx4jvFOONgLFE2OGfpqzF55nRU+2utbm6OgogtpRv3lGTQeudJxFY3Hbnc5oUDy9i18+8bSYyKVtYMniqkThUMaLpgzutTErJhRIg3Sivz242Dso+/tDeGMULCmeXK1j/HeWvnxYgJzOmKgTOxiFgWcVJ56lq3m2gOp1Fgu253SQxSViJF/MzOQt76+fuHfHxt7eVzsWfDXlhN75bOnrhRHNo0x0eatqzb3RJcFuJAYm489Mgr5byYJvQJLX0b3r9gwUGVGMZ/ZX/WMNxtnsMYnLJqz1RI6qIEsD1fsO+UKMomilOLb1Vgbm5694pVw6LEUPfMzkhVJswPWAUSEAVMf/hgqSppIYETurrp/IdlCDWKq/PrwySwlLirG05dipyhpJgSJ3OX7ZoywCY0mghyc6DEBDLZ3M+90h5EnEhULdzccuwS29zeloujjEzj3ufeSWE8qc0Q9yy977WZA2zgTQ5GLo4weXXat2D2/rKohUfkEb72atA4ZTSap/NzCAAxpOOQD5RSBtKof13f8bbgC5kvNFpHc3Ocl5grfP9nXy9FaaRRnFFSXv+XsohNLWUTZreAKJHWnudfUyUV6yXYmxu7P46JhdVMnF9LnIZC7zIcbbNVR4EkSh9YtHta1YMhkns+adw/XuKqbD7g2ZOBN6Drz+/LfIGgSowJ8wPRKCTLwpG2VKOMLfoKP7h4sEzeqAKSF9M4HrU+RIMdfytYyhKTVmZ+Z9rR0qqTFEdgo4FdTodryKHg+lYnp8tVG9nLs74x62j3Svfw0x91fgwbG4S8AUZDThpT6Pid9U77+VsP/qN7Db/e1Tp7+dez905edq3G53S4xvsFe+XZhT+fIb2t61d3nlsf7T9ZiiittM5fMr/n+OmKK4zYFIxrP1f/xSPQH/3m2qB9csUHZ1bNOHg8skbBhMG0tGTV1LPd3ewKHJQRLIdgx7XPAhGZvs2zts14Yv0HpxYuePtwKLAlVYaylYqfuXRh6+kTF1C0SggUYg08Tk5mXtq+5JlznYseOnHAlwwyQwKCGmUrWcDcxQtD18keUzAg9VRMx8mpbPriR+6tB1acfLPamsU8EDEpiNSIGgaQiLv/8Qcvdp2uxJbEVe04OekvP9xZXv3RvqszMrjEOE8EECmYFMwAKBsoPvrYjPOdn0SF1I23f2zrlZ+u+v2ltmKlAG/rExoBYiiAoawgh2pl+srZp17ubwnj9TdN2uf6kqXA3rI3arQmw6qCSQVMEDU29FPpDJNgnPtgU/RdhjSw1WBIDBRMACnIqLBVgWEAYoWKGDUuGZNDgAqkdcR55a3dfv0cdiirBKjSaAtSjulJFapauwOKW1nUs/XnsVKe+HhICCnp0AWoHx0qQEoNz2FzTrf1BitGHJUPt0EbUnLpQ7c90u2vbh3O/Lf6DJ3y3iE8h+zmOKq4U+gdtpsYzrBEvftVfh7n+G4M+9NYfTOy7H/5P2ukH+bjaNMFdybO4TfDf8vuIbaZuDfnt3q3L+f3Oabmvm8qjRA71D/UqEZt5rn9YKrxBDpc/B9wB8PpHagItQAAECRlWElmTU0AKgAAAAgABgESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAAITAAMAAAABAAEAAIdpAAQAAAABAAAAZgAAAMAAAABIAAAAAQAAAEgAAAABAAeQAAAHAAAABDAyMjGRAQAHAAAABAECAwCgAAAHAAAABDAxMDCgAQADAAAAAQABAACgAgAEAAAAAQAAAvygAwAEAAAAAQAAAoikBgADAAAAAQAAAAAAAAAAAAYBAwADAAAAAQAGAAABGgAFAAAAAQAAAQ4BGwAFAAAAAQAAARYBKAADAAAAAQACAAACAQAEAAAAAQAAAR4CAgAEAAAAAQAADwQAAAAAAAAASAAAAAEAAABIAAAAAf/Y/9sAhAABAQEBAQECAQECAwICAgMEAwMDAwQFBAQEBAQFBgUFBQUFBQYGBgYGBgYGBwcHBwcHCAgICAgJCQkJCQkJCQkJAQEBAQICAgQCAgQJBgUGCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQn/3QAEAAr/wAARCACIAKADASIAAhEBAxEB/8QBogAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoLEAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+foBAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKCxEAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+SCIcVpx8DHpWZD0rTjoAsp6VpwHisuOtO36UAaydK0IutZ6dK0IutAGlEBxV+ICqMXar8NAGjDjgCtGHPes6LtWhDQBpRVp2wBYVlw1q2vUUAaqDmtJPu4rNTrWknSgCxGf0rSh/hrMjrTg6LQBrJ0rTjA4FZidK1I+1AGhD0q3HkNxVSHpVuP71AH//0P5IIelacdZkPStOOgCxHWnb9KzI607fpQBrJ0rQi61np0rQi60AacXar8NUIu1X4aANGLPGa0Iaz4u1aMNAGhDWra9RWXFWpbdRQBqp1rSTpWanWtJOlAE8dacHRazI604Oi0AaydK1I+1ZadK1I+1AGhD0q3H96qkPSrUf3qAP/9H+SCHpWnHWZD0rTjoAsR1p2/SsyOtO36UAaydK+vf2Xv2ePhx+0DPqeleLfijoPw+1K02GytdcjnUX4IO4QzovkK6kABJHRmz8ua+Qk6VfjAb5WGRQB+gnxB/Y/wDht8IryGx+JnxJbRGuc/Z3uvDWsLDcAfxQTCIxTL7xswriYvg5+zP/ANFotP8AwQat/wDGq84+GP7SXxl+FelP4X8OaubrQJ8CfRNTij1DS5gOz2V0skBx2IUMvVSDzXqf/CVfsmfFS1Y+LdCvvhprjYxd+H92o6M7eslhdS/arcevk3Eq9lRBxQBJF8HP2ascfGa0/wDBDq3/AMarQj+Dv7NfQfGW0/8ABDqv/wAbrG1f9kn4lf2NN4u+FVzp/wARNDt082a78NSm5mt09bqwdY723A7s8HlA8CQ184rG8MjQSja6cFSMEexHagD62j+D37NvX/hctp/4IdV/+N1fi+EH7N6kbfjHaf8Agh1X/wCNV85+BfAnjT4keI4PB/w+0m61rVLniK1sommlb32oDgDuTgAdcCvu34UfsjeGrfWZrXx7ct4u1bTo/Ou9F8OXMK2OngdTrOvy/wCg2ca/x+SZmH3QQ/AAMb4e/stfC/4p67/wjnw7+JY1i8SPzZEtvD2rMIoxwZJX8vbFGO7uVUetdbrf7A/ju98ayeFvghr+meP9MsbKW61LxBZFrTR7KS3R5Z7dr26CQSywxpucQPIFzt6giuy8dftFfCjwB4bk+H2kRWHiaKKQNH4e0BJ9P8IwuowJLudmTUtblXpmd0jP94p8lc/8R/jR8RtF+BME/jTUt3iX4h2nlWtjbolta6L4YRyBDbWkKpDbHUZU6RoP9Gj5z55wAfAqgAkAg47jp+FaUHRazI604Oi0AaydK1I+1ZadK1I+1AGhD0q3Hw1VIelW4/vcUAf/0v5IIelacdZkPStOOgCxHWnb9KzI607fpQBrJ0rQi61np0rQi60AacXar8NUIu1X4aAOn8O69rvhfWLbxD4YvbjTNQtGDwXVpK8E0TDo0ckZVkPupFfZ3gz48+Nfjx4osfBPxZ8FWXxT1O+/0e2lEZsdaLYzkX1j5TylQNxa5EowCWOK+G4s8Zr7O8AOnwP/AGeNU+Ke/wAvxL8QBc+H9EHSS20pAF1S9X0NxkWMZH8BuO+2gD6f8W/Fv4XfCDw3ceAdSlsJ7acDzfBXge4eLTWI6LrniEM93f8AP3ra3laPPWWMrtr4x+IXx++IvxQ0u28I6hNDpXhmxffZ6DpUS2mmwHs3kp/rZMf8tZi8n+1jivAYQoACjAA4ArUtgWYIgyx4AA5J9AKAPoz9nn4caB488Zz6r49ZoPCPhe1bV9elQhWNnCwVbaInjz7uUpbw+jPuI2o2Od+KXxK1z4v+P9S+IniFI4Z9QkGy3hG2G2giURW9tCvaOCJUjQei5POa9k+NYX4J/DzTv2YLJFXWWki1nxfKPvDUDGfsumZH8NhE580dDcyOMfugT8sx/doAnjrTg6LWZHWnB0WgDWTpWpH2rLTpWpH2oA0IelW4/vcVUh6Vaj+9QB//0/5IIelacdZkPStOOgCxHWnb9KzI607fpQBrJ0rQi61np0rQi60AacXar8NUIu1X4aAPXfgv8MNX+MnxM0j4b6PKls2oy/vrqX/VWlrEpkubqX0jt4UeV/ZcDnFd1+0J8T9K+KPxIe58IRNa+F9DtotH8PWr4zDplnlYSwHHmzEtPMR1lkftiu50OOD4H/szXHiidceKPimkljp3Z7Tw/azBbu5Hp9uuI/s0frHDP2K18oxHPtQBoxV9efs16Pp3gnT9V/ae8WQh7LwcyRaLDIBtvfEEyk2cQB4ZLUD7XOOgSNFODIlfM/gnwj4j8f8Ai3TPA3hG1a91XWLmKztIEHzSTTMERR+J+gHPSvof9ofxdoUeo6V8C/h1epfeFPASSWdvdRDCahqEpDahqA9VmmGyEnnyI4unQAHhmo6rqeu6pca3rdw93e3kjT3E8py8ksh3O7H1YnJp6dKzU61pJ0oAnjrTg6LWZHWnB0WgDWTpWpH2rLTpWpH2oA0IelW48buaqQ9KtR/eoA//1P5IIelacdZkPStOOgCxHWnb9KzI607fpQBrJ0rQi61np0rQi60AacXavaPgT8K5vjN8TdO8CtcjT7B/MutTvn/1dlp1ohnvLlz2WGBHb3ICjJIFeLR9Bivs9n/4UV+zFHYLG0Pir4tJ5srnhoPDNrN+7Re4+33kJZv70dunYnIB5t8d/ihb/Fv4nXviXRomtdDtlj07RLNuPsulWSCCzhwOAwiVS+Orlj3ryuGs2NlA3HAAr6++D37JHj74gJpfiPxk3/CLeG9TmWO3u7xHN3f8jdHpdhGr3N7KRwvlx+Upx5kiLzQB0nw18z4B/BG9+OErCLxN4yS50PwwpH7yCy/1eqanGf4Dj/QoW7s823/VnHypa9RX0J+1hf8Ajq6+L9xZ+NPDN74NtNLhj0rRtGvYXhaz06zGy3hG8Dc2MvKw+9KzseSa+e7XqKANVOtaSdKzU61pJ0oAnjrTg6LWZHWnB0WgDWTpWpH2rLTpWpH2oA0IelW4/vcVUh6Vbj+9xQB//9X+SCHpWnHWZD0rTjoAsR1p2/SsyOtO36UAaydK0IutZ6dK0IutAHvn7PXwx0v4sfE200HxRdNp3h2wil1PXb5ettplmvm3LL28xlHlQg9ZXQV79rfw6+K37VvjLUPj1qNta+D/AAZd3CWVjfam5t7C1s7ZVgtbCwjw092beFUjEVrHI2R82GbJd+xx+0H8M/hPp+rfDfx1o+nxReMr2yj1HxHqVrLqkenadZkzeWmlxPCLovOI3KySGMtHHuRlUqfs74lftC/Bi/1me6+Dfxk/sm6dBAPEepaLf3XiDyAMCG2mjjjttLgA+7Dp8MOwfKHxkUAYFn8O/wBnT9kdVv8AxoRFrSRCSO61qzjvdalJ6f2d4dZjb6cD1W41h/OCkMlvGwAPzb8TP22/iJ4qvbhPhn9o8Lw3Efkz6i1095r93EBgJc6s4WUR44Fvarb2y/wxDknjJfhL+ztfXMl7ffGmGaeVi7ySaFqbM7HklieST61Zh+DX7NnX/hclt/4INS/woAxvBP7UPxq8IadF4dm1Ya/ocQ2jSNfij1awC/3VgvFkWMf9c9uO1ehW3if9k34nyBfF+g3/AMNtTk/5fdAZtS0nd6vp10/2qFf7xhupQP4IQMCsaP4N/s2jj/hclr/4IdS/wq/D8Hf2cFwV+Mdr/wCCHUv8KANBv2UPHviCGbU/ghqGnfEaxh5xoMpa/wBoHU6ZMI73jvshfHevnu6sb3TLqTT9She2uIWKSRSqUdGHBVlYAgj0Ir6MsvhR+z5ZXMd5Z/GWCGWMgo6aHqaspHQggZH4V9U6d8UvhzqunJoPxh+Kei/ETT0QRp/wkPhzU5r2JRwBDqUZjvVwOFVpXjXslAH5jx1pwdFr7R+N3gH9haLwE/ir4EeO9T/4SSIru0C50+eW0mDMATb3siQvEEUltsqyE4wGFfF8P8NAGqnStSPtWWnStSPtQBoQ9Ktx/eqpD0q1H96gD//W/kgh6Vpx1mQ9K046ALEdadv0rMjrTt+lAGsnStCLrWenStCLrQBpxdqvw1Qi7VfhoA0YhjFaMNZ0WOMVow0AaMWe9alr1FZcWe9alr1FAGqnWtJOlZqda0k6UATx1pwdFrMjrTg6LQBrJ0rUj7Vlp0rUj7UAaEPSrcf3qqQ9Ktx/eoA//9f+SCLgVpx9M1lR9BWrF/qxQBZQVpwDis1Pu1qQfcoA006VoRdaz06VoRdaANKIjgVfiIFZ0XWr8dAGpFzjFaMII4NZ0H3R9K0060AX4hjitO2IDCs1OtaEH3hQBsJ1rST7tZcfatSP7goAsRitKH+Gs+PoK0Yuq0AaqdK04yOKzE6VoJ0oA1IelW4wd3FVIOhq7D94fhQB/9kAAO26j/EAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMTItMTZUMDU6MjM6MTMrMDA6MDDRx6XwAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTEyLTE2VDA1OjIzOjEzKzAwOjAwoJodTAAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0xMi0xNlQwNToyMzoxMyswMDowMPePPJMAAAARdEVYdGV4aWY6Q29sb3JTcGFjZQAxD5sCSQAAACB0RVh0ZXhpZjpDb21wb25lbnRzQ29uZmlndXJhdGlvbgAuLi5q8qFkAAAAE3RFWHRleGlmOkV4aWZPZmZzZXQAMTAyc0IppwAAABV0RVh0ZXhpZjpFeGlmVmVyc2lvbgAwMjIx5Fw1LQAAABl0RVh0ZXhpZjpGbGFzaFBpeFZlcnNpb24AMDEwMBLUKKwAAAAYdEVYdGV4aWY6UGl4ZWxYRGltZW5zaW9uADc2NBOIX0AAAAAYdEVYdGV4aWY6UGl4ZWxZRGltZW5zaW9uADY0OLTF+qgAAAAXdEVYdGV4aWY6U2NlbmVDYXB0dXJlVHlwZQAwIrQxYwAAABx0RVh0ZXhpZjp0aHVtYm5haWw6Q29tcHJlc3Npb24ANvllcFcAAAAodEVYdGV4aWY6dGh1bWJuYWlsOkpQRUdJbnRlcmNoYW5nZUZvcm1hdAAyODaLUk57AAAAL3RFWHRleGlmOnRodW1ibmFpbDpKUEVHSW50ZXJjaGFuZ2VGb3JtYXRMZW5ndGgAMzg0NI983bUAAAAfdEVYdGV4aWY6dGh1bWJuYWlsOlJlc29sdXRpb25Vbml0ADIlQF7TAAAAH3RFWHRleGlmOnRodW1ibmFpbDpYUmVzb2x1dGlvbgA3Mi8x2ocYLAAAAB90RVh0ZXhpZjp0aHVtYm5haWw6WVJlc29sdXRpb24ANzIvMXTvib0AAAAXdEVYdGV4aWY6WUNiQ3JQb3NpdGlvbmluZwAxrA+AYwAAAABJRU5ErkJggg==",this._account=null,this._listeners={},this._adapter=new Ye(e),this._adapter.on("connect",e=>{this._account={address:e.toBase58(),publicKey:e.toBytes(),chains:["solana:mainnet","solana:devnet","solana:testnet"],features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]},this._emit("change",{accounts:[this._account]})}),this._adapter.on("disconnect",()=>{this._account=null,this._emit("change",{accounts:[]})})}get accounts(){return this._account?[this._account]:[]}get chains(){return["solana:mainnet","solana:devnet","solana:testnet"]}get features(){return{"standard:connect":{version:"1.0.0",connect:async()=>(await this._adapter.connect(),{accounts:this.accounts})},"standard:disconnect":{version:"1.0.0",disconnect:async()=>{await this._adapter.disconnect()}},"standard:events":{version:"1.0.0",on:(e,t)=>(this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t),()=>{this._listeners[e]=this._listeners[e]?.filter(e=>e!==t)||[]})},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:async(...e)=>{const t=[];for(const r of e){const e=a.VersionedTransaction.deserialize(r.transaction),n=await this._adapter.sendTransaction(e);t.push({signature:o.decode(n)})}return t}},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:async(...e)=>{throw new Error("signTransaction not supported")}},"solana:signMessage":{version:"1.0.0",signMessage:async(...e)=>{const t=[];for(const a of e){const e=await this._adapter.signMessage(a.message);t.push({message:a.message,signature:e,signedMessage:a.message})}return t}}}}_emit(e,...t){this._listeners[e]?.forEach(e=>e(...t))}}Object.defineProperty(exports,"Connection",{enumerable:!0,get:function(){return a.Connection}}),Object.defineProperty(exports,"Keypair",{enumerable:!0,get:function(){return a.Keypair}}),Object.defineProperty(exports,"PublicKey",{enumerable:!0,get:function(){return a.PublicKey}}),Object.defineProperty(exports,"Transaction",{enumerable:!0,get:function(){return a.Transaction}}),Object.defineProperty(exports,"TransactionInstruction",{enumerable:!0,get:function(){return a.TransactionInstruction}}),exports.API_ENDPOINTS=f,exports.CHUNK_SEED=ue,exports.CREDENTIAL_HASH_SIZE=32,exports.DEFAULTS=y,exports.DEFAULT_COMMITMENT=w,exports.DEFAULT_CONFIG=Ze,exports.DefaultPolicyClient=ee,exports.DialogManager=Me,exports.EMPTY_PDA_RENT_EXEMPT_BALANCE=H,exports.LazorkitClient=Ue,exports.LazorkitProvider=a=>{const{children:r,rpcUrl:n=y.RPC_ENDPOINT,portalUrl:i=y.PORTAL_URL,paymasterConfig:s={paymasterUrl:y.PAYMASTER_URL}}=a,{setConfig:o}=ze();return t.useEffect(()=>{o({portalUrl:i,paymasterConfig:s,rpcUrl:n})},[n,i,s,o]),e.jsx(e.Fragment,{children:r})},exports.LazorkitWalletAdapter=Ye,exports.LazorkitWalletName=Je,exports.Logger=I,exports.PASSKEY_PUBLIC_KEY_SIZE=33,exports.Paymaster=P,exports.SIGNATURE_SIZE=64,exports.SMART_WALLET_CONFIG_SEED=ce,exports.SMART_WALLET_SEED=le,exports.STORAGE_KEYS=b,exports.StorageManager=k,exports.StorageUtil=class{static saveCredentials(e){try{e.credentialId&&localStorage.setItem(_e,e.credentialId),localStorage.setItem(je,e.publickey),localStorage.setItem(Ge,e.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",e.timestamp.toString())}catch(e){console.error("Failed to save credentials to local storage:",e)}}static getCredentials(){try{const e=localStorage.getItem(_e),t=localStorage.getItem(je),a=localStorage.getItem(Ge),r=localStorage.getItem("CREDENTIALS_TIMESTAMP");return t&&a?{credentialId:e||void 0,publickey:t,smartWalletAddress:a,timestamp:r?parseInt(r):Date.now()}:null}catch(e){return console.error("Failed to get credentials from local storage:",e),null}}static updateSmartWalletAddress(e){try{localStorage.setItem(Ge,e)}catch(e){console.error("Failed to update smart wallet address in local storage:",e)}}static clearCredentials(){try{localStorage.removeItem(_e),localStorage.removeItem(je),localStorage.removeItem(Ge),localStorage.removeItem("CREDENTIALS_TIMESTAMP"),console.log("Credentials cleared from local storage")}catch(e){console.error("Failed to clear credentials from local storage:",e)}}static getItem(e){return localStorage.getItem(e)}static setItem(e,t){localStorage.setItem(e,t)}},exports.ValidationError=Q,exports.WALLET_DEVICE_SEED=de,exports.asCredentialHash=U,exports.asPasskeyPublicKey=T,exports.asSignature=function(e){return e},exports.assertByteArrayLength=O,exports.assertDefined=N,exports.assertNonEmptyArray=j,exports.assertNonEmptyByteArray=function(e,t){if(N(e,t),0===(Array.isArray(e)?e:Array.from(e)).length)throw new Q(`${t} cannot be empty`,t)},exports.assertNonEmptyString=_,exports.assertPositiveBN=F,exports.assertPositiveInteger=Y,exports.assertPositiveNumber=function(e,t){if(N(e,t),"number"!=typeof e||!Number.isFinite(e)||Number.isNaN(e))throw new Q(`${t} must be a finite number (got ${Number.isNaN(e)?"NaN":Number.isFinite(e)?typeof e:e===1/0?"Infinity":"-Infinity"})`,t);if(e<0)throw new Q(`${t} must be non-negative, got ${e}`,t)},exports.assertValidBase64=Z,exports.assertValidCredentialHash=L,exports.assertValidPasskeyPublicKey=z,exports.assertValidPublicKey=K,exports.assertValidPublicKeyArray=X,exports.assertValidSignature=V,exports.assertValidTransactionInstruction=G,exports.assertValidTransactionInstructionArray=q,exports.base64ToBytes=Le,exports.buildCreateChunkMessage=ve,exports.buildExecuteMessage=Pe,exports.buildPasskeyVerificationInstruction=Ce,exports.buildTransaction=Te,exports.byteArrayEquals=E,exports.calculateVerifyInstructionIndex=xe,exports.combineInstructionsWithAuth=Be,exports.combineInstructionsWithAuthAndCU=function(e,t,a){return Ee([e,...t],a)},exports.computeMultipleCpiHashes=ke,exports.convertPasskeySignatureToInstructionArgs=We,exports.createComputeUnitLimitInstruction=De,exports.credentialHashFromBase64=B,exports.deriveChunkPda=me,exports.deriveSmartWalletConfigPda=pe,exports.deriveSmartWalletPda=Ae,exports.deriveWalletDevicePda=ge,exports.detectPlatform=function(){if("undefined"!=typeof window&&window.ReactNativeWebView)return"mobile";const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)?"mobile":"web"},exports.getBlockchainTimestamp=x,exports.getRandomBytes=D,exports.importP256PublicKey=Ve,exports.instructionToAccountMetas=W,exports.isAndroid=function(){return/Android/i.test(navigator.userAgent)},exports.isIOS=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},exports.isSafari=function(){const e=navigator.userAgent.toLowerCase();return/^((?!chrome|android).)*safari/i.test(e)},exports.normalizePublicKey=function(e,t="publicKey"){return K(e,t),"string"==typeof e?new p.web3.PublicKey(e):e},exports.prependComputeUnitLimit=Ee,exports.registerLazorkitWallet=function(e){u.registerWallet(new Xe(e))},exports.toNumberArray=J,exports.toNumberArraySafe=$,exports.useWallet=()=>{const{wallet:e,isLoading:r,isConnecting:n,isSigning:i,error:s,connect:o,disconnect:l,signAndSendTransaction:c,signMessage:d}=ze(),u=t.useCallback(async e=>{try{return await o(e)}catch(e){throw console.error("Failed to connect wallet:",e),e}},[o]),A=t.useCallback(async()=>{try{await l()}catch(e){throw console.error("Failed to disconnect wallet:",e),e}},[l]),p=t.useCallback(async e=>{try{return await c({instructions:e.instructions,transactionOptions:e.transactionOptions})}catch(e){throw console.error("Failed to sign and send transaction:",e),e}},[c]),g=t.useCallback(async e=>{try{return await d(e)}catch(e){throw console.error("Failed to sign message:",e),e}},[d]),m=t.useCallback(async({signedPayload:e,signature:t,publicKey:a})=>{const r=Buffer.from(e).toString("base64"),n=Buffer.from(t).toString("base64"),i=Buffer.from(a).toString("base64");return await Fe({signedPayload:r,signature:n,publicKey:i})},[]);return{smartWalletPubkey:e?.smartWallet?new a.PublicKey(e.smartWallet):null,isConnected:!!e,isLoading:r||n||i,isConnecting:n,isSigning:i,error:s,wallet:e,connect:u,disconnect:A,signAndSendTransaction:p,signMessage:g,verifyMessage:m}},exports.useWalletStore=ze,exports.validateCredentialHash=function(e,t="credentialHash"){return L(e,t),Array.isArray(e)?e:Array.from(e)},exports.validatePasskeyPublicKey=function(e,t="passkeyPublicKey"){return z(e,t),Array.isArray(e)?e:Array.from(e)},exports.validateSignature=function(e,t="signature"){return V(e,t),Array.isArray(e)?e:Array.from(e)},exports.verifySignatureBrowser=Fe;
 //# sourceMappingURL=index.js.map
diff --git a/node_modules/@lazorkit/wallet/dist/index.js.map b/node_modules/@lazorkit/wallet/dist/index.js.map
index c76eaf2..88380f1 100644
--- a/node_modules/@lazorkit/wallet/dist/index.js.map
+++ b/node_modules/@lazorkit/wallet/dist/index.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.js","sources":["../../../node_modules/.pnpm/zustand@5.0.9_@types+react@18.3.27_react@19.2.3/node_modules/zustand/esm/middleware.mjs","../../config/defaults.ts","../../config/endpoints.ts","../../config/constants.ts","../../core/storage/StorageManager.ts","../../utils/logger.ts","../../core/paymaster/paymaster.ts","../../core/contract/types.ts","../../core/contract/utils.ts","../../core/contract/pda/defaultPolicy.ts","../../core/contract/constants.ts","../../core/contract/validation.ts","../../core/contract/client/defaultPolicy.ts","../../core/contract/pda/lazorkit.ts","../../core/contract/client/internal/walletPdas.ts","../../core/contract/client/internal/policyResolver.ts","../../core/contract/messages.ts","../../core/contract/webauthn/secp256r1.ts","../../core/contract/auth.ts","../../core/contract/transaction.ts","../../core/contract/client/lazorkit.ts","../../core/contract/client/internal/cpi.ts","../../core/contract/index.ts","../../core/portal/CredentialManager.ts","../../core/portal/DialogManager.ts","../../core/portal/styles/DialogStyles.ts","../../core/wallet/utils.ts","../../core/wallet/actions.ts","../../react/store.ts","../../utils/verify.ts","../../utils/storage.ts","../../core/adapter/adapter.ts","../../core/adapter/standard.ts","../../react/LazorkitProvider.tsx","../../utils/platform.ts","../../react/useWallet.ts"],"sourcesContent":["const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...args) => api.dispatch(...args), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst removeStoreFromTrackedConnections = (name, store) => {\n  if (store === void 0) return;\n  const connectionInfo = trackedConnections.get(name);\n  if (!connectionInfo) return;\n  delete connectionInfo.stores[store];\n  if (Object.keys(connectionInfo.stores).length === 0) {\n    trackedConnections.delete(name);\n  }\n};\nconst findCallerName = (stack) => {\n  var _a, _b;\n  if (!stack) return void 0;\n  const traceLines = stack.split(\"\\n\");\n  const apiSetStateLineIndex = traceLines.findIndex(\n    (traceLine) => traceLine.includes(\"api.setState\")\n  );\n  if (apiSetStateLineIndex < 0) return void 0;\n  const callerLine = ((_a = traceLines[apiSetStateLineIndex + 1]) == null ? void 0 : _a.trim()) || \"\";\n  return (_b = /.+ (.+) .+/.exec(callerLine)) == null ? void 0 : _b[1];\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = ((state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? {\n      type: anonymousActionType || findCallerName(new Error().stack) || \"anonymous\"\n    } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  });\n  api.devtools = {\n    cleanup: () => {\n      if (connection && typeof connection.unsubscribe === \"function\") {\n        connection.unsubscribe();\n      }\n      removeStoreFromTrackedConnections(options.name, store);\n    }\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && args[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...args);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, fn) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) fn(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = ((selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  });\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nfunction combine(initialState, create) {\n  return (...args) => Object.assign({}, initialState, create(...args));\n}\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(name, JSON.stringify(newValue, options == null ? void 0 : options.replacer)),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst persistImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    return setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      return setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            const migration = options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n            if (migration instanceof Promise) {\n              return migration.then((result) => [true, result]);\n            }\n            return [true, migration];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persist = persistImpl;\n\nfunction ssrSafe(config, isSSR = typeof window === \"undefined\") {\n  return (set, get, api) => {\n    if (!isSSR) {\n      return config(set, get, api);\n    }\n    const ssrSet = () => {\n      throw new Error(\"Cannot set state of Zustand store in SSR\");\n    };\n    api.setState = ssrSet;\n    return config(ssrSet, get, api);\n  };\n}\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector, ssrSafe as unstable_ssrSafe };\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["createJSONStorage","getStorage","options","storage","e","getItem","name","_a","parse","str2","JSON","str","Promise","then","setItem","newValue","stringify","removeItem","toThenable","fn","input","result","onFulfilled","_onRejected","this","_onFulfilled","catch","onRejected","persist","config","baseOptions","set","get","api","localStorage","partialize","state","version","merge","persistedState","currentState","hasHydrated","hydrationListeners","Set","finishHydrationListeners","args","console","warn","savedSetState","setState","replace","configResult","stateFromStorage","getInitialState","hydrate","_b","forEach","cb","_a2","postRehydrationCallback","onRehydrateStorage","call","bind","deserializedStorageValue","migrate","migration","error","migrationResult","migrated","migratedState","setOptions","newOptions","clearStorage","getOptions","rehydrate","onHydrate","add","delete","onFinishHydration","skipHydration","DEFAULTS","PORTAL_URL","PAYMASTER_URL","RPC_ENDPOINT","API_ENDPOINTS","CONNECT","SIGN","DEFAULT_COMMITMENT","STORAGE_KEYS","WALLET","CREDENTIALS","PUBLIC_KEY","CREDENTIAL_ID","SMART_WALLET_ADDRESS","async","window","key","value","valueLength","length","StorageManager","saveWallet","wallet","credentialId","smartWallet","Buffer","from","passkeyPubkey","toString","getWallet","walletData","saveConfig","getConfig","configData","clearWallet","Logger","constructor","context","enabled","process","env","NODE_ENV","debug","message","data","info","Paymaster","logger","endpoint","paymasterUrl","apiKey","getHeaders","headers","getPayer","response","fetch","method","body","jsonrpc","id","params","ok","Error","statusText","json","PublicKey","signer_address","getBlockhash","blockhash","attemptSign","transaction","attempt","serialized","serialize","verifySignatures","requireAllSignatures","Transaction","signed_transaction","sign","maxRetries","baseDelay","delay","Math","pow","resolve","setTimeout","attemptSignAndSend","signature","signAndSend","attemptSignAndSendVersionedTransaction","signAndSendVersionedTransaction","SmartWalletAction","instructionToAccountMetas","ix","signers","keys","map","k","pubkey","isWritable","isSigner","some","s","getRandomBytes","len","globalThis","crypto","getRandomValues","arr","Uint8Array","randomBytes","require","credentialHashFromBase64","credentialIdBase64","Array","sha256","arrayBuffer","getBlockchainTimestamp","connection","slot","getSlot","blockTime","getBlockTime","anchor","BN","ensureChunkExist","client","smartWalletPubkey","retries","nounce","getWalletStateData","chunkAddress","getChunkPubkey","lastNonce","getAccountInfo","asPasskeyPublicKey","asCredentialHash","POLICY_SEED","EMPTY_PDA_RENT_EXEMPT_BALANCE","ValidationError","field","super","assertDefined","fieldName","assertValidPublicKey","trim","web3","toBase58","toBytes","assertByteArrayLength","expectedLength","array","isArray","i","byte","Number","isFinite","isInteger","assertValidPasskeyPublicKey","assertValidCredentialHash","assertValidSignature","assertPositiveBN","lt","assertNonEmptyString","String","assertNonEmptyArray","assertValidTransactionInstruction","TransactionInstruction","programId","toNumberArray","assertValidBase64","test","atob","assertPositiveInteger","isNaN","Infinity","assertValidPublicKeyArray","pk","index","assertValidTransactionInstructionArray","toNumberArraySafe","assertValidPasskeySignature","passkeyPublicKey","signature64","clientDataJsonRaw64","authenticatorDataRaw64","DefaultPolicyClient","program","Program","DefaultPolicyIdl","policyPda","findProgramAddressSync","toBuffer","derivePolicyPda","getPolicyDataSize","validateInitPolicyParams","walletId","credentialHash","policySigner","walletState","buildInitPolicyIx","methods","initPolicy","accountsPartial","instruction","validateCheckPolicyParams","policyData","isBuffer","buildCheckPolicyIx","checkPolicy","SMART_WALLET_SEED","SMART_WALLET_CONFIG_SEED","WALLET_DEVICE_SEED","CHUNK_SEED","deriveSmartWalletPda","toArrayLike","deriveSmartWalletConfigPda","createWalletDeviceHash","rawBuffer","concat","hash","subarray","deriveWalletDevicePda","deriveChunkPda","WalletPdaFactory","walletDevice","chunk","nonce","PolicyInstructionResolver","policyClient","walletPdas","resolveForExecute","provided","walletStateData","undefined","resolveForCreate","smartWalletId","coder","computeHash","computeSingleInsAccountsHash","metas","h","create","update","meta","computePolicyHashes","policyIns","policyMetas","policyAccountsHash","policyDataHash","computeMultipleCpiHashes","cpiInstructions","cpiSigners","lengthBuffer","alloc","writeUInt32LE","serializedData","dataLengthBuffer","cpiDataHash","cpiAccountsHash","pubkeyProperties","Map","existing","processedMetas","properties","computeAllInsAccountsHash","flatMap","encodeMessage","messageType","encoded","BorshCoder","instructions","accounts","types","type","kind","fields","encode","buildCreateChunkMessage","timestamp","policyHashes","cpiHashes","policyCombined","policyHash","cpiCombined","cpiHash","nonceBuffer","writeBigUInt64LE","BigInt","timestampBuffer","writeBigInt64LE","finalData","dataHash","SECP256R1_NATIVE_PROGRAM","bytesOf","buffer","ArrayBuffer","Object","values","view","DataView","setUint16","buildPasskeyVerificationInstruction","passkeySignature","authenticatorDataRaw","clientDataJsonRaw","totalSize","DATA_START","instructionData","offsets","signature_offset","publicKeyOffset","signature_instruction_index","public_key_offset","SIGNATURE_OFFSETS_SERIALIZED_SIZE","public_key_instruction_index","message_data_offset","signatureOffset","message_data_size","message_instruction_index","buildSecp256r1VerifyIx","convertPasskeySignatureToInstructionArgs","createComputeUnitLimitInstruction","limit","ComputeBudgetProgram","setComputeUnitLimit","units","prependComputeUnitLimit","computeUnitLimit","combineInstructionsWithAuth","authInstruction","smartWalletInstructions","calculateVerifyInstructionIndex","buildTransaction","payer","addressLookupTables","recentBlockhash","customBlockhash","finalInstructions","shouldUseVersioned","getLatestBlockhash","TransactionMessage","payerKey","compileToV0Message","VersionedTransaction","isVersioned","feePayer","global","prototype","begin","end","apply","setPrototypeOf","LazorkitClient","LazorkitIdl","defaultPolicyProgram","policyResolver","getSmartWalletPubkey","getWalletStatePubkey","getWalletDevicePubkey","generateWalletId","fetchWalletStateContext","account","fetchChunkContext","validateCreateSmartWalletParams","amount","policyDataSize","policyInstruction","validateExecuteParams","cpiInstruction","validateCreateChunkParams","validateExecuteChunkParams","getChunkData","getSmartWalletByCredentialHash","discriminator","find","a","getProgramAccounts","filters","memcmp","offset","bytes","bs58","default","buildCreateSmartWalletIns","createSmartWallet","policyProgram","systemProgram","SystemProgram","remainingAccounts","buildExecuteIns","execute","cpiProgram","ixSysvar","SYSVAR_INSTRUCTIONS_PUBKEY","buildCreateChunkIns","chunkPda","createChunk","buildExecuteChunkIns","chunkData","instructionDataList","splitIndex","currentIndex","push","calculateSplitIndex","allAccountMetas","collectCpiAccountMetas","executeChunk","accountsStrict","sessionRefund","rentRefundAddress","createSmartWalletTxn","initPolicyData","executeTxn","signatureArgs","verifyInstructionIndex","cpiData","createChunkTxn","calculateCpiHash","executeChunkTxn","buildAuthorizationMessage","action","types.SmartWalletAction","CreateChunk","structuredClone","obj","CredentialManager","EventEmitter","iframeRef","retryDelays","setIframeRef","iframe","notifyCredentialsUpdated","credentials","emit","event","CustomEvent","detail","bubbles","cancelable","dispatchEvent","syncCredentials","force","contentWindow","performCredentialSync","publickey","smartWalletAddress","Date","now","postMessage","err","storeCredential","credential","toISOString","destroy","removeAllListeners","DialogManager","dialogRef","popupWindow","popupCloseInterval","isClosing","isDestroyed","_currentAction","credentialManager","setupMessageListener","openConnect","reject","cleanup","off","connectHandler","errorHandler","on","timeoutId","originalResolve","originalReject","clearTimeout","reason","shouldUsePopup","connectUrl","portalUrl","openPopup","openConnectDialog","openSign","clusterSimulation","signHandler","encodedMessage","encodeURIComponent","signUrl","openSignDialog","openSignMessage","openModal","ensureFonts","document","getElementById","link","createElement","rel","href","head","appendChild","ensureDialogBackdropCSS","style","textContent","createCloseButton","onClose","btn","title","setAttribute","assign","width","height","borderRadius","border","background","cursor","display","alignItems","justifyContent","padding","color","outline","webkitTapHighlightColor","addEventListener","onclick","innerHTML","url","isMobileDevice","navigator","userAgent","isSafari","isMobile","getPopupDimensions","top","left","outerWidth","screenX","outerHeight","screenY","closed","close","dimensions","open","startPopupMonitor","clearInterval","setInterval","createModal","src","showModal","dialog","colorScheme","styles","overlay","position","inset","maxWidth","maxHeight","overflow","zIndex","placeItems","panel","boxShadow","closeButton","iframeContainer","margin","getDialogStyles","variant","flexDirection","fontFamily","header","flex","boxSizing","borderBottom","closeDialog","right","ariaLabel","allow","sandbox","tabIndex","target","origin","includes","URL","hostname","transformedData","publicKey","isCreated","connectionType","accountName","transformedDataSignResult","normalized","clientDataJsonBase64","clientDataJSONReturn","authenticatorDataBase64","authenticatorDataReturn","signedPayload","msg","parentNode","removeChild","getIframeRef","getDialogRef","getPopupWindow","getCurrentAction","createDialogManager","rpcUrl","paymasterConfig","getCredentialHash","handleActionError","onFail","getPasskeyPublicKey","publicKeyBase64","connectAction","isConnecting","existingWallet","oldZustandData","parsed","cleanupLegacyStorage","onSuccess","dialogManager","dialogResult","paymaster","smartWalletData","initSmartWalletTxn","walletInfo","expo","platform","useWalletStore","Connection","isLoading","isSigning","setConfig","setWallet","setLoading","setConnecting","setSigning","setConnection","rpcEndpoint","setError","clearError","connect","disconnect","disconnectAction","signAndSendTransaction","payload","encodedChallenge","latest","messageV0","base64Tx","transactionOptions","signResult","signResponse","createChunkTransaction","createChunkSignature","confirmTransaction","addressLookupTableAccounts","executeChunkTransaction","signAndSendTransactionAction","signMessage","signMessageAction","base64ToBytes","b64","c","charCodeAt","importP256PublicKey","publicKeyBytes","rawKey","newKey","subtle","importKey","namedCurve","verifySignatureBrowser","payloadBytes","signatureBytes","cryptoKey","verify","CREDENTIAL_ID_KEY","PUBLIC_KEY_KEY","SMART_WALLET_KEY","LazorkitWalletName","DEFAULT_CONFIG","LazorkitWalletAdapter","BaseWalletAdapter","icon","supportedTransactionVersions","_publicKey","_readyState","WalletReadyState","Unsupported","Installed","_connecting","_wallet","_config","connecting","readyState","connected","WalletWindowClosedError","_updateWalletState","_createDialogManager","_ensureWalletOnChain","KoraClient","getPayerSigner","signer_key","sendTransaction","WalletDisconnectedError","_prepareInstructions","WalletSignTransactionError","clients","_initializeClients","lookups","addressTableLookups","all","lookup","acc","accountKey","AddressLookupTableAccount","deserialize","_buildAuthorizationMessage","_signWithDialog","_executeSmartWalletTransaction","signTransaction","_transaction","signAllTransactions","_transactions","messageBase64","compiledInstructions","accountKeyIndexes","keyIndex","staticAccountKeys","isAccountSigner","isAccountWritable","programIdIndex","feePayerAddress","createDeferredExecutionTxn","_sendToPaymaster","executeDeferredTransactionTxn","signerKey","LazorkitWalletStandard","_account","_listeners","_adapter","address","chains","features","_emit","listener","filter","l","inputs","results","tx","decode","_inputs","signedMessage","props","children","useEffect","_jsx","_Fragment","saveCredentials","getCredentials","parseInt","updateSmartWalletAddress","clearCredentials","log","cpiIns","cpiMetas","computeCpiHashes","b","ReactNativeWebView","toLowerCase","registerWallet","handleConnect","useCallback","handleDisconnect","handleSignAndSendTransaction","handleSignMessage","handleVerifyMessage","signedPayloadB64","signatureB64","publicKeyB64","isConnected","verifyMessage"],"mappings":"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","x_google_ignoreList":[0]}
\ No newline at end of file
+{"version":3,"file":"index.js","sources":["../../../node_modules/.pnpm/zustand@5.0.9_@types+react@18.3.27_react@19.2.3/node_modules/zustand/esm/middleware.mjs","../../config/defaults.ts","../../config/endpoints.ts","../../config/constants.ts","../../core/storage/StorageManager.ts","../../utils/logger.ts","../../core/paymaster/paymaster.ts","../../core/contract/types.ts","../../core/contract/utils.ts","../../core/contract/pda/defaultPolicy.ts","../../core/contract/constants.ts","../../core/contract/validation.ts","../../core/contract/client/defaultPolicy.ts","../../core/contract/webauthn/secp256r1.ts","../../core/contract/pda/lazorkit.ts","../../core/contract/client/internal/walletPdas.ts","../../core/contract/client/internal/policyResolver.ts","../../core/contract/messages.ts","../../core/contract/auth.ts","../../core/contract/transaction.ts","../../core/contract/client/lazorkit.ts","../../core/contract/client/internal/cpi.ts","../../core/contract/index.ts","../../core/portal/CredentialManager.ts","../../core/portal/DialogManager.ts","../../core/portal/styles/DialogStyles.ts","../../core/wallet/utils.ts","../../core/wallet/actions.ts","../../react/store.ts","../../utils/verify.ts","../../utils/storage.ts","../../core/adapter/adapter.ts","../../core/adapter/standard.ts","../../react/LazorkitProvider.tsx","../../utils/platform.ts","../../react/useWallet.ts"],"sourcesContent":["const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...args) => api.dispatch(...args), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst removeStoreFromTrackedConnections = (name, store) => {\n  if (store === void 0) return;\n  const connectionInfo = trackedConnections.get(name);\n  if (!connectionInfo) return;\n  delete connectionInfo.stores[store];\n  if (Object.keys(connectionInfo.stores).length === 0) {\n    trackedConnections.delete(name);\n  }\n};\nconst findCallerName = (stack) => {\n  var _a, _b;\n  if (!stack) return void 0;\n  const traceLines = stack.split(\"\\n\");\n  const apiSetStateLineIndex = traceLines.findIndex(\n    (traceLine) => traceLine.includes(\"api.setState\")\n  );\n  if (apiSetStateLineIndex < 0) return void 0;\n  const callerLine = ((_a = traceLines[apiSetStateLineIndex + 1]) == null ? void 0 : _a.trim()) || \"\";\n  return (_b = /.+ (.+) .+/.exec(callerLine)) == null ? void 0 : _b[1];\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = ((state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? {\n      type: anonymousActionType || findCallerName(new Error().stack) || \"anonymous\"\n    } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  });\n  api.devtools = {\n    cleanup: () => {\n      if (connection && typeof connection.unsubscribe === \"function\") {\n        connection.unsubscribe();\n      }\n      removeStoreFromTrackedConnections(options.name, store);\n    }\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && args[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...args);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, fn) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) fn(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = ((selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  });\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nfunction combine(initialState, create) {\n  return (...args) => Object.assign({}, initialState, create(...args));\n}\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(name, JSON.stringify(newValue, options == null ? void 0 : options.replacer)),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst persistImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    return setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      return setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            const migration = options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n            if (migration instanceof Promise) {\n              return migration.then((result) => [true, result]);\n            }\n            return [true, migration];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persist = persistImpl;\n\nfunction ssrSafe(config, isSSR = typeof window === \"undefined\") {\n  return (set, get, api) => {\n    if (!isSSR) {\n      return config(set, get, api);\n    }\n    const ssrSet = () => {\n      throw new Error(\"Cannot set state of Zustand store in SSR\");\n    };\n    api.setState = ssrSet;\n    return config(ssrSet, get, api);\n  };\n}\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector, ssrSafe as unstable_ssrSafe };\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["createJSONStorage","getStorage","options","storage","e","getItem","name","_a","parse","str2","JSON","str","Promise","then","setItem","newValue","stringify","removeItem","toThenable","fn","input","result","onFulfilled","_onRejected","this","_onFulfilled","catch","onRejected","persist","config","baseOptions","set","get","api","localStorage","partialize","state","version","merge","persistedState","currentState","hasHydrated","hydrationListeners","Set","finishHydrationListeners","args","console","warn","savedSetState","setState","replace","configResult","stateFromStorage","getInitialState","hydrate","_b","forEach","cb","_a2","postRehydrationCallback","onRehydrateStorage","call","bind","deserializedStorageValue","migrate","migration","error","migrationResult","migrated","migratedState","setOptions","newOptions","clearStorage","getOptions","rehydrate","onHydrate","add","delete","onFinishHydration","skipHydration","DEFAULTS","PORTAL_URL","PAYMASTER_URL","RPC_ENDPOINT","API_ENDPOINTS","CONNECT","SIGN","DEFAULT_COMMITMENT","STORAGE_KEYS","WALLET","CREDENTIALS","PUBLIC_KEY","CREDENTIAL_ID","SMART_WALLET_ADDRESS","async","window","key","value","valueLength","length","StorageManager","saveWallet","wallet","credentialId","smartWallet","Buffer","from","passkeyPubkey","toString","getWallet","walletData","saveConfig","getConfig","configData","clearWallet","Logger","constructor","context","enabled","process","env","NODE_ENV","debug","message","data","info","Paymaster","logger","endpoint","paymasterUrl","apiKey","getHeaders","headers","getPayer","response","fetch","method","body","jsonrpc","id","params","ok","Error","statusText","json","PublicKey","signer_address","getBlockhash","blockhash","attemptSign","transaction","attempt","serialized","serialize","verifySignatures","requireAllSignatures","Transaction","signed_transaction","sign","maxRetries","baseDelay","delay","Math","pow","resolve","setTimeout","attemptSignAndSend","signature","signAndSend","attemptSignAndSendVersionedTransaction","signAndSendVersionedTransaction","SmartWalletAction","instructionToAccountMetas","ix","signers","keys","map","k","pubkey","isWritable","isSigner","some","s","getRandomBytes","len","globalThis","crypto","getRandomValues","arr","Uint8Array","randomBytes","require","byteArrayEquals","a","b","i","credentialHashFromBase64","credentialIdBase64","Array","sha256","arrayBuffer","getBlockchainTimestamp","connection","slot","getSlot","blockTime","getBlockTime","anchor","BN","floor","Date","now","asPasskeyPublicKey","asCredentialHash","POLICY_SEED","EMPTY_PDA_RENT_EXEMPT_BALANCE","ValidationError","field","super","assertDefined","fieldName","assertValidPublicKey","trim","web3","toBase58","toBytes","assertByteArrayLength","expectedLength","array","isArray","byte","Number","isFinite","isInteger","assertValidPasskeyPublicKey","assertValidCredentialHash","assertValidSignature","assertPositiveBN","lt","assertNonEmptyString","String","assertNonEmptyArray","assertValidTransactionInstruction","TransactionInstruction","programId","toNumberArray","assertValidBase64","test","atob","assertPositiveInteger","isNaN","Infinity","assertValidPublicKeyArray","pk","index","assertValidTransactionInstructionArray","toNumberArraySafe","DefaultPolicyClient","program","Program","DefaultPolicyIdl","policyPda","findProgramAddressSync","toBuffer","derivePolicyPda","getPolicyDataSize","validateInitPolicyParams","walletId","passkeyPublicKey","credentialHash","policySigner","walletState","buildInitPolicyIx","methods","initPolicy","accountsPartial","instruction","validateCheckPolicyParams","policyData","isBuffer","buildCheckPolicyIx","checkPolicy","createWalletDeviceHash","rawBuffer","concat","hash","subarray","FIELD_SIZE","SECP256R1_NATIVE_PROGRAM","SECP256R1_ORDER","SECP256R1_HALF_ORDER","bytesOf","buffer","ArrayBuffer","Object","values","view","DataView","setUint16","buildSecp256r1VerifyIx","r","slice","paddedR","alloc","paddedS","copy","isGreaterThan","newS","borrow","diff","subtractBigNumbers","totalSize","DATA_START","instructionData","numSignatures","publicKeyOffset","SIGNATURE_OFFSETS_SERIALIZED_SIZE","signatureOffset","messageDataOffset","offsets","signature_offset","signature_instruction_index","public_key_offset","public_key_instruction_index","message_data_offset","message_data_size","message_instruction_index","SMART_WALLET_SEED","SMART_WALLET_CONFIG_SEED","WALLET_DEVICE_SEED","CHUNK_SEED","deriveSmartWalletPda","toArrayLike","deriveSmartWalletConfigPda","deriveWalletDevicePda","deriveChunkPda","lastNonce","WalletPdaFactory","walletDevice","chunk","nonce","PolicyInstructionResolver","policyClient","walletPdas","resolveForExecute","provided","walletStateData","resolveForCreate","smartWalletId","coder","computeHash","computeSingleInsAccountsHash","metas","h","create","update","meta","computePolicyHashes","policyIns","policyMetas","policyAccountsHash","policyDataHash","computeMultipleCpiHashes","cpiInstructions","cpiSigners","lengthBuffer","writeUInt32LE","serializedData","dataLengthBuffer","cpiDataHash","cpiAccountsHash","pubkeyProperties","Map","existing","processedMetas","properties","computeAllInsAccountsHash","flatMap","encodeMessage","messageType","encoded","BorshCoder","instructions","accounts","types","type","kind","fields","encode","buildExecuteMessage","timestamp","cpiIns","policyHashes","cpiHashes","cpiMetas","computeCpiHashes","policyCombined","policyHash","cpiCombined","cpiHash","nonceBuffer","writeBigUInt64LE","BigInt","timestampBuffer","writeBigInt64LE","finalData","dataHash","buildCreateChunkMessage","buildPasskeyVerificationInstruction","passkeySignature","signature64","clientDataJsonRaw64","authenticatorDataRaw64","authenticatorDataRaw","clientDataJsonRaw","rawMessage","convertPasskeySignatureToInstructionArgs","createComputeUnitLimitInstruction","limit","ComputeBudgetProgram","setComputeUnitLimit","units","prependComputeUnitLimit","computeUnitLimit","undefined","combineInstructionsWithAuth","authInstruction","smartWalletInstructions","calculateVerifyInstructionIndex","buildTransaction","payer","addressLookupTables","recentBlockhash","customBlockhash","finalInstructions","lookupTables","getLatestBlockhash","log","TransactionMessage","payerKey","compileToV0Message","VersionedTransaction","isVersioned","feePayer","prototype","begin","end","apply","setPrototypeOf","LazorkitClient","LazorkitIdl","defaultPolicyProgram","policyResolver","getSmartWalletPubkey","getWalletStatePubkey","getWalletDevicePubkey","getChunkPubkey","generateWalletId","fetchWalletStateContext","account","fetchChunkContext","validateCreateSmartWalletParams","amount","policyDataSize","policyInstruction","validateExecuteParams","cpiInstruction","validateCreateChunkParams","validateExecuteChunkParams","validateCloseChunkParams","getWalletStateData","getChunkData","getSmartWalletByPasskey","discriminator","find","getProgramAccounts","filters","memcmp","offset","bytes","bs58","decode","device","devices","deviceSlot","getSmartWalletByCredentialHash","buildCreateSmartWalletIns","createSmartWallet","policyProgram","systemProgram","SystemProgram","remainingAccounts","buildExecuteIns","execute","cpiProgram","ixSysvar","SYSVAR_INSTRUCTIONS_PUBKEY","buildCreateChunkIns","chunkPda","createChunk","buildExecuteChunkIns","latestNonce","sub","chunkData","instructionDataList","splitIndex","currentIndex","push","calculateSplitIndex","allAccountMetas","collectCpiAccountMetas","executeChunk","sessionRefund","rentRefundAddress","buildCloseChunkIns","closeChunk","createSmartWalletTxn","initPolicyData","executeTxn","signatureArgs","verifyInstructionIndex","cpiData","createChunkTxn","calculateCpiHash","executeChunkTxn","closeChunkTxn","buildAuthorizationMessage","action","types.SmartWalletAction","Execute","CreateChunk","smartWalletConfig","defaultPolicyInstruction","structuredClone","obj","CredentialManager","EventEmitter","iframeRef","retryDelays","setIframeRef","iframe","notifyCredentialsUpdated","credentials","emit","event","CustomEvent","detail","bubbles","cancelable","dispatchEvent","syncCredentials","force","contentWindow","performCredentialSync","publickey","smartWalletAddress","postMessage","err","storeCredential","credential","toISOString","destroy","removeAllListeners","DialogManager","dialogRef","popupWindow","popupCloseInterval","isClosing","isDestroyed","_currentAction","credentialManager","setupMessageListener","openConnect","reject","cleanup","off","connectHandler","errorHandler","on","timeoutId","originalResolve","originalReject","clearTimeout","reason","shouldUsePopup","connectUrl","portalUrl","openPopup","openConnectDialog","openSign","clusterSimulation","signHandler","encodedMessage","encodeURIComponent","signUrl","openSignDialog","openSignMessage","openModal","ensureFonts","document","getElementById","link","createElement","rel","href","head","appendChild","ensureDialogBackdropCSS","style","textContent","createCloseButton","onClose","btn","title","setAttribute","assign","width","height","borderRadius","border","background","cursor","display","alignItems","justifyContent","padding","color","outline","webkitTapHighlightColor","addEventListener","onclick","innerHTML","url","isMobileDevice","navigator","userAgent","isSafari","isMobile","getPopupDimensions","top","left","outerWidth","screenX","outerHeight","screenY","closed","close","dimensions","open","startPopupMonitor","clearInterval","setInterval","createModal","src","showModal","dialog","colorScheme","styles","overlay","position","inset","maxWidth","maxHeight","overflow","zIndex","placeItems","panel","boxShadow","closeButton","iframeContainer","margin","getDialogStyles","variant","flexDirection","fontFamily","header","flex","boxSizing","borderBottom","closeDialog","right","ariaLabel","allow","sandbox","tabIndex","target","origin","includes","URL","hostname","transformedData","publicKey","isCreated","connectionType","accountName","transformedDataSignResult","normalized","clientDataJsonBase64","clientDataJSONReturn","authenticatorDataBase64","authenticatorDataReturn","signedPayload","msg","parentNode","removeChild","getIframeRef","getDialogRef","getPopupWindow","getCurrentAction","createDialogManager","rpcUrl","paymasterConfig","getCredentialHash","handleActionError","onFail","getPasskeyPublicKey","publicKeyBase64","connectAction","isConnecting","existingWallet","oldZustandData","parsed","cleanupLegacyStorage","onSuccess","dialogManager","dialogResult","paymaster","smartWalletData","initSmartWalletTxn","walletInfo","expo","platform","useWalletStore","Connection","isLoading","isSigning","setConfig","setWallet","setLoading","setConnecting","setSigning","setConnection","rpcEndpoint","setError","clearError","connect","disconnect","disconnectAction","signAndSendTransaction","payload","encodedChallenge","latest","messageV0","base64Tx","transactionOptions","signResult","signResponse","createChunkTransaction","createChunkSignature","confirmTransaction","addressLookupTableAccounts","executeChunkTransaction","signAndSendTransactionAction","signMessage","signMessageAction","base64ToBytes","b64","c","charCodeAt","importP256PublicKey","publicKeyBytes","rawKey","newKey","subtle","importKey","namedCurve","verifySignatureBrowser","payloadBytes","signatureBytes","cryptoKey","verify","CREDENTIAL_ID_KEY","PUBLIC_KEY_KEY","SMART_WALLET_KEY","LazorkitWalletName","DEFAULT_CONFIG","LazorkitWalletAdapter","BaseWalletAdapter","icon","supportedTransactionVersions","_publicKey","_readyState","WalletReadyState","Unsupported","Installed","_connecting","_wallet","_config","connecting","readyState","connected","WalletWindowClosedError","_updateWalletState","_createDialogManager","_ensureWalletOnChain","KoraClient","getPayerSigner","signer_key","sendTransaction","WalletDisconnectedError","_prepareInstructions","WalletSignTransactionError","clients","_initializeClients","lookups","addressTableLookups","all","lookup","acc","getAccountInfo","accountKey","AddressLookupTableAccount","deserialize","_buildAuthorizationMessage","_signWithDialog","_executeSmartWalletTransaction","signTransaction","_transaction","signAllTransactions","_transactions","messageBase64","compiledInstructions","accountKeyIndexes","keyIndex","staticAccountKeys","isAccountSigner","isAccountWritable","programIdIndex","feePayerAddress","createDeferredExecutionTxn","_sendToPaymaster","executeDeferredTransactionTxn","signerKey","LazorkitWalletStandard","_account","_listeners","_adapter","address","chains","features","_emit","listener","filter","l","inputs","results","tx","_inputs","signedMessage","props","children","useEffect","_jsx","_Fragment","saveCredentials","getCredentials","parseInt","updateSmartWalletAddress","clearCredentials","ReactNativeWebView","toLowerCase","registerWallet","handleConnect","useCallback","handleDisconnect","handleSignAndSendTransaction","handleSignMessage","handleVerifyMessage","signedPayloadB64","signatureB64","publicKeyB64","smartWalletPubkey","isConnected","verifyMessage"],"mappings":"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","x_google_ignoreList":[0]}
\ No newline at end of file
diff --git a/node_modules/@lazorkit/wallet/dist/index.mjs b/node_modules/@lazorkit/wallet/dist/index.mjs
index 7e20456..9e4f986 100644
--- a/node_modules/@lazorkit/wallet/dist/index.mjs
+++ b/node_modules/@lazorkit/wallet/dist/index.mjs
@@ -1,2 +1,2 @@
-import{jsx as t,Fragment as e}from"react/jsx-runtime";import{useEffect as a,useCallback as n}from"react";import{PublicKey as r,Transaction as i,Connection as s,AddressLookupTableAccount as o,TransactionInstruction as l,VersionedTransaction as c}from"@solana/web3.js";export{Connection,Keypair,PublicKey,Transaction,TransactionInstruction}from"@solana/web3.js";import{create as d}from"zustand";import*as A from"@coral-xyz/anchor";import{Buffer as u}from"buffer";import{sha256 as p}from"js-sha256";import*as g from"bs58";import m from"bs58";import{EventEmitter as h}from"eventemitter3";import{BaseWalletAdapter as y,WalletReadyState as f,WalletWindowClosedError as w,WalletDisconnectedError as b,WalletSignTransactionError as S}from"@solana/wallet-adapter-base";import{KoraClient as k}from"@solana/kora";import{registerWallet as I}from"@wallet-standard/wallet";function v(t,e){let a;try{a=t()}catch(t){return}return{getItem:t=>{var e;const n=t=>null===t?null:JSON.parse(t,void 0),r=null!=(e=a.getItem(t))?e:null;return r instanceof Promise?r.then(n):n(r)},setItem:(t,e)=>a.setItem(t,JSON.stringify(e,void 0)),removeItem:t=>a.removeItem(t)}}const D=t=>e=>{try{const a=t(e);return a instanceof Promise?a:{then:t=>D(t)(a),catch(t){return this}}}catch(t){return{then(t){return this},catch:e=>D(e)(t)}}},C=(t,e)=>(a,n,r)=>{let i={storage:v(()=>localStorage),partialize:t=>t,version:0,merge:(t,e)=>({...e,...t}),...e},s=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return t((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...t)},n,r);const d=()=>{const t=i.partialize({...n()});return c.setItem(i.name,{state:t,version:i.version})},A=r.setState;r.setState=(t,e)=>(A(t,e),d());const u=t((...t)=>(a(...t),d()),n,r);let p;r.getInitialState=()=>u;const g=()=>{var t,e;if(!c)return;s=!1,o.forEach(t=>{var e;return t(null!=(e=n())?e:u)});const r=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,null!=(t=n())?t:u))||void 0;return D(c.getItem.bind(c))(i.name).then(t=>{if(t){if("number"!=typeof t.version||t.version===i.version)return[!1,t.state];if(i.migrate){const e=i.migrate(t.state,t.version);return e instanceof Promise?e.then(t=>[!0,t]):[!0,e]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(t=>{var e;const[r,s]=t;if(p=i.merge(s,null!=(e=n())?e:u),a(p,!0),r)return d()}).then(()=>{null==r||r(p,void 0),p=n(),s=!0,l.forEach(t=>t(p))}).catch(t=>{null==r||r(void 0,t)})};return r.persist={setOptions:t=>{i={...i,...t},t.storage&&(c=t.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>s,onHydrate:t=>(o.add(t),()=>{o.delete(t)}),onFinishHydration:t=>(l.add(t),()=>{l.delete(t)})},i.skipHydration||g(),p||u},P={PORTAL_URL:"https://portal.lazor.sh",PAYMASTER_URL:"https://lazorkit-paymaster.onrender.com",RPC_ENDPOINT:"https://api.devnet.solana.com"},W={CONNECT:"connect",SIGN:"sign"},E="confirmed",B={WALLET:"lazorkit-wallet",CREDENTIALS:"lazorkit-credentials",PUBLIC_KEY:"PUBLIC_KEY",CREDENTIAL_ID:"CREDENTIAL_ID",SMART_WALLET_ADDRESS:"SMART_WALLET_ADDRESS"},x={getItem:async t=>{try{if("undefined"==typeof window)return null;return localStorage.getItem(t)}catch(e){return console.error("Error reading from localStorage:",e,{key:t}),null}},setItem:async(t,e)=>{try{if("undefined"==typeof window)return;localStorage.setItem(t,e)}catch(a){console.error("Error writing to localStorage:",a,{key:t,valueLength:e.length})}},removeItem:async t=>{try{if("undefined"==typeof window)return;localStorage.removeItem(t)}catch(e){console.error("Error removing from localStorage:",e,{key:t})}}};class U{static async saveWallet(t){try{await x.setItem(B.WALLET,JSON.stringify(t)),await x.setItem(B.CREDENTIAL_ID,t.credentialId),await x.setItem(B.SMART_WALLET_ADDRESS,t.smartWallet),await x.setItem(B.PUBLIC_KEY,u.from(t.passkeyPubkey).toString("base64"))}catch(t){throw console.error("Failed to save wallet to storage:",t),t}}static async getWallet(){try{const t=await x.getItem(B.WALLET);return t?JSON.parse(t):null}catch(t){return console.error("Failed to get wallet from storage:",t),null}}static async saveConfig(t){try{await x.setItem("lazorkit-config",JSON.stringify(t))}catch(t){throw console.error("Failed to save config to storage:",t),t}}static async getConfig(){try{const t=await x.getItem("lazorkit-config");return t?JSON.parse(t):null}catch(t){return console.error("Failed to get config from storage:",t),null}}static async clearWallet(){try{await x.removeItem(B.WALLET),await x.removeItem(B.CREDENTIAL_ID),await x.removeItem(B.SMART_WALLET_ADDRESS),await x.removeItem(B.PUBLIC_KEY),await x.removeItem("CREDENTIALS_TIMESTAMP")}catch(t){throw console.error("Failed to clear wallet from storage:",t),t}}static async getItem(t){return await x.getItem(t)}static async setItem(t,e){await x.setItem(t,e)}static async removeItem(t){await x.removeItem(t)}}class R{constructor(t){this.context=t,this.enabled="production"!==process.env.NODE_ENV}debug(t,e){this.enabled&&console.debug(`[${this.context}] ${t}`,e)}info(t,e){console.info(`[${this.context}] ${t}`,e)}warn(t,e){console.warn(`[${this.context}] ${t}`,e)}error(t,e){console.error(`[${this.context}] ${t}`,e)}}class T{constructor(t){this.logger=new R("Paymaster"),this.endpoint=t.paymasterUrl,this.apiKey=t.apiKey}getHeaders(){const t={"Content-Type":"application/json"};return this.apiKey&&(t["x-api-key"]=this.apiKey),t}async getPayer(){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getPayerSigner",params:[]})});if(!t.ok)throw new Error(`Failed to get payer: ${t.statusText}`);const e=await t.json();return new r(e.result.signer_address)}catch(t){throw this.logger.error("Failed to get payer",t),t}}async getBlockhash(){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"getBlockhash",id:1,params:[]})});if(!t.ok)throw new Error(`Failed to get blockhash: ${t.statusText}`);return(await t.json()).result.blockhash}catch(t){throw this.logger.error("Failed to get blockhash",t),t}}async attemptSign(t,e=1){try{const e=t.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signTransaction",id:1,params:[e.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign transaction: ${a.statusText}`);const n=await a.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return i.from(u.from(n.result.signed_transaction,"base64"))}catch(t){throw this.logger.error(`Sign attempt ${e} failed:`,t),t}}async sign(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSign(t,n)}catch(t){if(n===e)throw this.logger.error("All sign retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying sign in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign transaction after all retries")}async attemptSignAndSend(t,e=1){try{const e=t.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[e.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign and send transaction: ${a.statusText}`);const n=await a.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return n.result.signature}catch(t){throw this.logger.error(`Attempt ${e} failed:`,t),t}}async signAndSend(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSignAndSend(t,n)}catch(t){if(n===e)throw this.logger.error("All retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign and send transaction after all retries")}async attemptSignAndSendVersionedTransaction(t,e=1){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[u.from(t.serialize()).toString("base64")]})});if(!e.ok)throw new Error(`Failed to sign and send transaction: ${e.statusText}`);const a=await e.json();if(a.error)throw new Error(a.error.message||"Unknown paymaster error");return a.result.signature}catch(t){throw this.logger.error(`Attempt ${e} failed:`,t),t}}async signAndSendVersionedTransaction(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSignAndSendVersionedTransaction(t,n)}catch(t){if(n===e)throw this.logger.error("All retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign and send transaction after all retries")}}var M,H={address:"Gsuz7YcA5sbMGVRXT3xSYhJBessW4xFC4xYsihNCqMFh",metadata:{name:"lazorkit",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},docs:["LazorKit: Smart Wallet with WebAuthn Passkey Authentication"],instructions:[{name:"create_chunk",discriminator:[83,226,15,219,9,19,186,90],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"wallet_state.last_nonce",account:"WalletState"}]}},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateChunkArgs"}}}]},{name:"create_smart_wallet",discriminator:[129,39,235,18,132,68,203,19],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"arg",path:"args.wallet_id"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"policy_program"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateSmartWalletArgs"}}}]},{name:"execute",discriminator:[130,221,242,154,13,193,189,29],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"cpi_program"},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"ExecuteArgs"}}}]},{name:"execute_chunk",discriminator:[106,83,113,47,89,243,39,220],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"instruction_data_list",type:{vec:"bytes"}},{name:"split_index",type:"bytes"}]}],accounts:[{name:"Chunk",discriminator:[134,67,80,65,135,143,156,196]},{name:"WalletDevice",discriminator:[35,85,31,31,179,48,136,123]},{name:"WalletState",discriminator:[126,186,0,158,92,223,167,68]}],errors:[{code:6e3,name:"PasskeyMismatch",msg:"Passkey public key mismatch with stored authenticator"},{code:6001,name:"InvalidPolicyDataSize",msg:"Invalid policy data size"},{code:6002,name:"Secp256r1InvalidLength",msg:"Secp256r1 instruction has invalid data length"},{code:6003,name:"Secp256r1HeaderMismatch",msg:"Secp256r1 instruction header validation failed"},{code:6004,name:"Secp256r1DataMismatch",msg:"Secp256r1 signature data validation failed"},{code:6005,name:"InvalidSignature",msg:"Invalid signature provided for passkey verification"},{code:6006,name:"ClientDataInvalidUtf8",msg:"Client data JSON is not valid UTF-8"},{code:6007,name:"ClientDataJsonParseError",msg:"Client data JSON parsing failed"},{code:6008,name:"ChallengeMissing",msg:"Challenge field missing from client data JSON"},{code:6009,name:"ChallengeBase64DecodeError",msg:"Challenge base64 decoding failed"},{code:6010,name:"ChallengeDeserializationError",msg:"Challenge message deserialization failed"},{code:6011,name:"HashMismatch",msg:"Message hash mismatch: expected different value"},{code:6012,name:"InvalidInstructionDiscriminator",msg:"Invalid instruction discriminator"},{code:6013,name:"InsufficientCpiAccounts",msg:"Insufficient remaining accounts for CPI instruction"},{code:6014,name:"AccountSliceOutOfBounds",msg:"Account slice index out of bounds"},{code:6015,name:"InvalidAccountOwner",msg:"Account owner verification failed"},{code:6016,name:"ProgramNotExecutable",msg:"Program not executable"},{code:6017,name:"CredentialIdEmpty",msg:"Credential ID cannot be empty"},{code:6018,name:"PolicyDataTooLarge",msg:"Policy data exceeds maximum allowed size"},{code:6019,name:"TransactionTooOld",msg:"Transaction is too old"},{code:6020,name:"InvalidInstructionData",msg:"Invalid instruction data"},{code:6021,name:"InvalidInstruction",msg:"Invalid instruction"},{code:6022,name:"InsufficientBalanceForFee",msg:"Insufficient balance for fee"},{code:6023,name:"InvalidSequenceNumber",msg:"Invalid sequence number"},{code:6024,name:"InvalidPasskeyFormat",msg:"Invalid passkey format"},{code:6025,name:"ReentrancyDetected",msg:"Reentrancy detected"},{code:6026,name:"UnauthorizedAdmin",msg:"Unauthorized admin"}],types:[{name:"Chunk",docs:["Transaction chunk for deferred execution","","Created after full passkey and policy verification. Contains all bindings","necessary to execute the transaction later without re-verification.","Used for large transactions that need to be split into manageable chunks."],type:{kind:"struct",fields:[{name:"owner_wallet_address",docs:["Smart wallet address that authorized this chunk session"],type:"pubkey"},{name:"cpi_hash",docs:["Combined SHA256 hash of all cpi transaction instruction data"],type:{array:["u8",32]}},{name:"authorized_nonce",docs:["The nonce that was authorized at chunk creation (bound into data hash)"],type:"u64"},{name:"authorized_timestamp",docs:["Timestamp from the original message hash for expiration validation"],type:"i64"},{name:"rent_refund_address",docs:["Address to receive rent refund when closing the chunk session"],type:"pubkey"}]}},{name:"CreateChunkArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"policy_data",type:"bytes"},{name:"timestamp",type:"i64"},{name:"cpi_hash",type:{array:["u8",32]}}]}},{name:"CreateSmartWalletArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"init_policy_data",type:"bytes"},{name:"wallet_id",type:"u64"},{name:"amount",type:"u64"},{name:"policy_data_size",type:"u16"}]}},{name:"ExecuteArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"split_index",type:"u16"},{name:"policy_data",type:"bytes"},{name:"cpi_data",type:"bytes"},{name:"timestamp",type:"i64"}]}},{name:"WalletDevice",docs:["Wallet device account linking a passkey to a smart wallet"],type:{kind:"struct",fields:[{name:"passkey_pubkey",docs:["Secp256r1 compressed public key (33 bytes)"],type:{array:["u8",33]}},{name:"credential_hash",docs:["SHA256 hash of the credential ID"],type:{array:["u8",32]}},{name:"smart_wallet",docs:["Associated smart wallet address"],type:"pubkey"},{name:"bump",docs:["PDA bump seed"],type:"u8"}]}},{name:"WalletState",docs:["Wallet state account storing wallet configuration and execution state"],type:{kind:"struct",fields:[{name:"bump",docs:["PDA bump seed for smart wallet"],type:"u8"},{name:"wallet_id",docs:["Unique wallet identifier"],type:"u64"},{name:"last_nonce",docs:["Last used nonce for anti-replay protection"],type:"u64"},{name:"policy_program",docs:["Policy program that validates transactions"],type:"pubkey"},{name:"policy_data",docs:["Serialized policy data returned from policy initialization"],type:"bytes"}]}}]};function Q(t,e){return t.keys.map(t=>({pubkey:t.pubkey,isWritable:t.isWritable,isSigner:!!e&&e.some(e=>e.toString()===t.pubkey.toString())}))}function K(t){if("function"==typeof globalThis.crypto?.getRandomValues){const e=new Uint8Array(t);return globalThis.crypto.getRandomValues(e),e}try{const{randomBytes:e}=require("crypto");return e(t)}catch{throw new Error("No CSPRNG available")}}function N(t,e){if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0}function O(t){const e=u.from(t,"base64");return Array.from(new Uint8Array(p.arrayBuffer(e)))}async function z(t){const e=await t.getSlot(),a=await t.getBlockTime(e);if(null===a)throw new Error("Failed to get blockchain timestamp");return new A.BN(a)}async function V(t,e,a){let n=0;for(;n<3;){try{const n=await e.getWalletStateData(a),r=e.getChunkPubkey(a,n.lastNonce);if(await t.getAccountInfo(r))return}catch(t){console.warn(`Attempt ${n+1} failed to find chunk:`,t)}n++,n<3&&await new Promise(t=>setTimeout(t,3e3))}throw new Error("Chunk not found")}function F(t){return t}function L(t){return t}function j(t){return t}!function(t){t.CreateChunk="create_chunk",t.ExecuteChunk="execute_chunk"}(M||(M={}));var J={address:"BiE9vSdz9MidUiyjVYsu3PG4C1fbPZ8CVPADA9jRfXw7",metadata:{name:"default_policy",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},instructions:[{name:"check_policy",discriminator:[28,88,170,179,239,136,25,35],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet"}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"policy_data",type:"bytes"}]},{name:"init_policy",discriminator:[45,234,110,100,209,146,191,86],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}],returns:{defined:{name:"PolicyStruct"}}}],errors:[{code:6e3,name:"InvalidPasskey",msg:"Invalid passkey format"},{code:6001,name:"Unauthorized",msg:"Unauthorized to access smart wallet"}],types:[{name:"DeviceSlot",type:{kind:"struct",fields:[{name:"passkey_pubkey",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}]}},{name:"PolicyStruct",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"smart_wallet",type:"pubkey"},{name:"device_slots",type:{vec:{defined:{name:"DeviceSlot"}}}}]}}]};const G=u.from("policy");const _=890880,Z=33,Y=32,X=64;class q extends Error{constructor(t,e){super(t),this.field=e,this.name="ValidationError"}}function $(t,e){if(null==t||void 0===t){throw new q(`${e} is required but was ${null===t?"null":"undefined"}`,e)}}function tt(t,e){$(t,e);try{if("string"==typeof t){if(0===t.trim().length)throw new q(`${e} cannot be an empty string`,e);new A.web3.PublicKey(t)}else{if(!(t instanceof A.web3.PublicKey||t&&"object"==typeof t&&"toBase58"in t&&"function"==typeof t.toBase58&&"toBytes"in t&&"function"==typeof t.toBytes))throw new q(`${e} must be a PublicKey instance or valid base58 string`,e)}}catch(t){if(t instanceof q)throw t;throw new q(`${e} is not a valid PublicKey: ${t instanceof Error?t.message:"Invalid format"}`,e)}}function et(t,e,a){let n;if($(t,a),Array.isArray(t))n=t;else if(t instanceof Uint8Array)n=Array.from(t);else{if(!t||"object"!=typeof t||"number"!=typeof t.length)throw new q(`${a} must be an array or Uint8Array`,a);n=Array.from(t)}if(n.length!==e)throw new q(`${a} must be exactly ${e} bytes, got ${n.length}`,a);for(let t=0;t<n.length;t++){const e=n[t];if("number"!=typeof e||!Number.isFinite(e)||!Number.isInteger(e)||e<0||e>255)throw new q(`${a}[${t}] must be a valid byte (0-255), got ${"number"==typeof e?e:typeof e}`,a)}}function at(t,e){$(t,e);if(0===(Array.isArray(t)?t:Array.from(t)).length)throw new q(`${e} cannot be empty`,e)}function nt(t,e="passkeyPublicKey"){et(t,33,e)}function rt(t,e="passkeyPublicKey"){return nt(t,e),Array.isArray(t)?t:Array.from(t)}function it(t,e="credentialHash"){et(t,32,e)}function st(t,e="credentialHash"){return it(t,e),Array.isArray(t)?t:Array.from(t)}function ot(t,e="signature"){et(t,64,e)}function lt(t,e="signature"){return ot(t,e),Array.isArray(t)?t:Array.from(t)}function ct(t,e){$(t,e);if(!(t instanceof A.BN||t&&"object"==typeof t&&"lt"in t&&"function"==typeof t.lt&&"toString"in t&&"function"==typeof t.toString))throw new q(`${e} must be a BN instance`,e);if(t.lt(new A.BN(0)))throw new q(`${e} must be non-negative, got ${t.toString()}`,e)}function dt(t,e){if($(t,e),"number"!=typeof t||!Number.isFinite(t)||Number.isNaN(t))throw new q(`${e} must be a finite number (got ${Number.isNaN(t)?"NaN":Number.isFinite(t)?typeof t:t===1/0?"Infinity":"-Infinity"})`,e);if(t<0)throw new q(`${e} must be non-negative, got ${t}`,e)}function At(t,e){if($(t,e),"string"!=typeof t)throw new q(`${e} must be a string (got ${typeof t})`,e);if(0===String(t).trim().length)throw new q(`${e} cannot be empty`,e)}function ut(t,e){if($(t,e),!Array.isArray(t))throw new q(`${e} must be an array (got ${typeof t}${t&&"object"==typeof t?` with constructor ${t.constructor?.name||"unknown"}`:""})`,e);if(0===t.length)throw new q(`${e} cannot be empty`,e)}function pt(t,e){$(t,e);if(!(t instanceof A.web3.TransactionInstruction||t&&"object"==typeof t&&"programId"in t&&"keys"in t&&Array.isArray(t.keys)&&"data"in t))throw new q(`${e} must be a TransactionInstruction instance`,e);if(tt(t.programId,`${e}.programId`),!t.keys||!Array.isArray(t.keys)||0===t.keys.length)throw new q(`${e} must have at least one account key`,e)}function gt(t){return Array.isArray(t)?t:Array.from(t)}function mt(t,e="publicKey"){return tt(t,e),"string"==typeof t?new A.web3.PublicKey(t):t}function ht(t,e){At(t,e);if(!/^[A-Za-z0-9+/]*={0,2}$/.test(t))throw new q(`${e} is not a valid base64 string (invalid characters)`,e);try{"undefined"!=typeof Buffer&&Buffer.from?Buffer.from(t,"base64"):"undefined"!=typeof atob&&atob(t)}catch(t){throw new q(`${e} is not a valid base64 string: ${t instanceof Error?t.message:"Invalid format"}`,e)}}function yt(t,e){if($(t,e),"number"!=typeof t||!Number.isFinite(t)||Number.isNaN(t))throw new q(`${e} must be a finite number (got ${Number.isNaN(t)?"NaN":Number.isFinite(t)?typeof t:t===1/0?"Infinity":"-Infinity"})`,e);if(!Number.isInteger(t))throw new q(`${e} must be an integer, got ${t}`,e);if(t<=0)throw new q(`${e} must be a positive integer, got ${t}`,e)}function ft(t,e){if($(t,e),!Array.isArray(t))throw new q(`${e} must be an array (got ${typeof t})`,e);t.forEach((t,a)=>{tt(t,`${e}[${a}]`)})}function wt(t,e){ut(t,e),t.forEach((t,a)=>{pt(t,`${e}[${a}]`)})}function bt(t){return Array.isArray(t)?[...t]:Array.from(t)}function St(t,e="passkeySignature"){if($(t,e),"object"!=typeof t||null===t)throw new q(`${e} must be an object`,e);nt(t.passkeyPublicKey,`${e}.passkeyPublicKey`),ht(t.signature64,`${e}.signature64`),ht(t.clientDataJsonRaw64,`${e}.clientDataJsonRaw64`),ht(t.authenticatorDataRaw64,`${e}.authenticatorDataRaw64`)}class kt{constructor(t){$(t,"connection"),this.connection=t,this.program=new A.Program(J,{connection:t}),this.programId=this.program.programId}policyPda(t){return tt(t,"smartWallet"),function(t,e){return A.web3.PublicKey.findProgramAddressSync([G,e.toBuffer()],t)[0]}(this.programId,t)}getPolicyDataSize(){return 102}validateInitPolicyParams(t){$(t,"params"),ct(t.walletId,"params.walletId"),nt(t.passkeyPublicKey,"params.passkeyPublicKey"),it(t.credentialHash,"params.credentialHash"),tt(t.policySigner,"params.policySigner"),tt(t.smartWallet,"params.smartWallet"),tt(t.walletState,"params.walletState")}async buildInitPolicyIx(t){return this.validateInitPolicyParams(t),await this.program.methods.initPolicy(t.walletId,bt(t.passkeyPublicKey),bt(t.credentialHash)).accountsPartial({smartWallet:t.smartWallet,walletState:t.walletState,policySigner:t.policySigner}).instruction()}validateCheckPolicyParams(t){if($(t,"params"),ct(t.walletId,"params.walletId"),nt(t.passkeyPublicKey,"params.passkeyPublicKey"),tt(t.policySigner,"params.policySigner"),tt(t.smartWallet,"params.smartWallet"),it(t.credentialHash,"params.credentialHash"),$(t.policyData,"params.policyData"),!Buffer.isBuffer(t.policyData))throw new q("params.policyData must be a Buffer instance","params.policyData")}async buildCheckPolicyIx(t){return this.validateCheckPolicyParams(t),await this.program.methods.checkPolicy(t.walletId,bt(t.passkeyPublicKey),bt(t.credentialHash),t.policyData).accountsPartial({smartWallet:t.smartWallet,policySigner:t.policySigner}).instruction()}}const It=u.from("smart_wallet"),vt=u.from("wallet_state"),Dt=u.from("wallet_device"),Ct=u.from("chunk");function Pt(t,e){return A.web3.PublicKey.findProgramAddressSync([It,e.toArrayLike(u,"le",8)],t)[0]}function Wt(t,e){return A.web3.PublicKey.findProgramAddressSync([vt,e.toBuffer()],t)[0]}function Et(t,e){const a=u.concat([t.toBuffer(),u.from(e)]),n=p.arrayBuffer(a);return u.from(n).subarray(0,32)}function Bt(t,e,a){return A.web3.PublicKey.findProgramAddressSync([Dt,Et(e,a)],t)}function xt(t,e,a){return A.web3.PublicKey.findProgramAddressSync([Ct,e.toBuffer(),a.toArrayLike(u,"le",8)],t)[0]}class Ut{constructor(t){this.programId=t}smartWallet(t){return ct(t,"walletId"),Pt(this.programId,t)}walletState(t){return tt(t,"smartWallet"),Wt(this.programId,t)}walletDevice(t,e){return tt(t,"smartWallet"),it(e,"credentialHash"),Bt(this.programId,t,e)[0]}chunk(t,e){return tt(t,"smartWallet"),xt(this.programId,t,e)}}class Rt{constructor(t,e){this.policyClient=t,this.walletPdas=e}async resolveForExecute({provided:t,smartWallet:e,credentialHash:a,passkeyPublicKey:n,walletStateData:r}){if(void 0!==t)return t;const i=this.walletPdas.walletDevice(e,a);return this.policyClient.buildCheckPolicyIx({walletId:r.walletId,passkeyPublicKey:n,policySigner:i,smartWallet:e,credentialHash:a,policyData:r.policyData})}async resolveForCreate({provided:t,smartWalletId:e,smartWallet:a,walletState:n,passkeyPublicKey:r,credentialHash:i}){if(void 0!==t)return t;const s=this.walletPdas.walletDevice(a,i);return this.policyClient.buildInitPolicyIx({walletId:e,passkeyPublicKey:r,credentialHash:i,policySigner:s,smartWallet:a,walletState:n})}}let Tt=null;const Mt=t=>new Uint8Array(p.arrayBuffer(t)),Ht=(t,e,a)=>{const n=p.create();n.update(t.toBytes());for(const t of e)n.update(t.pubkey.toBytes()),n.update(Uint8Array.from([t.isSigner?1:0])),n.update(Uint8Array.from([t.pubkey.toString()===a.toString()||t.isWritable?1:0]));return new Uint8Array(n.arrayBuffer())},Qt=(t,e)=>{const a=Q(t),n=Ht(t.programId,a,e);return{policyDataHash:Mt(t.data),policyAccountsHash:n}},Kt=(t,e,a)=>{const n=u.alloc(4);n.writeUInt32LE(t.length,0);const r=u.concat([n,...t.map(t=>{const e=u.from(t.data),a=u.alloc(4);return a.writeUInt32LE(e.length,0),u.concat([a,e])})]),i=Mt(r),s=((t,e)=>{const a=new Map;for(const e of t){const t=e.pubkey.toString(),n=a.get(t);n?(n.isSigner=n.isSigner||e.isSigner,n.isWritable=n.isWritable||e.isWritable):a.set(t,{isSigner:e.isSigner,isWritable:e.isWritable})}const n=t.map(t=>{const e=t.pubkey.toString(),n=a.get(e);return{pubkey:t.pubkey,isSigner:n.isSigner,isWritable:n.isWritable}}),r=p.create();for(const t of n)r.update(t.pubkey.toBytes()),r.update(Uint8Array.from([t.isSigner?1:0])),r.update(Uint8Array.from([t.pubkey.toString()===e.toString()||t.isWritable?1:0]));return new Uint8Array(r.arrayBuffer())})(t.flatMap(t=>[{pubkey:t.programId,isSigner:!1,isWritable:!1},...Q(t,a)]),e);return{cpiDataHash:i,cpiAccountsHash:s}},Nt=(t,e)=>{try{const a=(Tt||(Tt=new A.BorshCoder({version:"0.1.0",name:"lazorkit_msgs",instructions:[],accounts:[],types:[{name:"SimpleMessage",type:{kind:"struct",fields:[{name:"dataHash",type:{array:["u8",32]}}]}}]})),Tt).types.encode(t,e);return u.from(a)}catch(e){throw new Error(`Failed to encode ${t}: ${e instanceof Error?e.message:"Unknown error"}`)}};function Ot(t,e,a,n,r,i){const s=Qt(n,t),o=((t,e,a)=>{const n=Q(t,a),r=Ht(t.programId,n,e);return{cpiDataHash:Mt(t.data),cpiAccountsHash:r}})(r,t,i??[]),l=new Uint8Array(64);l.set(s.policyDataHash,0),l.set(s.policyAccountsHash,32);const c=Mt(l),d=new Uint8Array(64);d.set(o.cpiDataHash,0),d.set(o.cpiAccountsHash,32);const A=Mt(d),p=u.alloc(8);p.writeBigUInt64LE(BigInt(e.toString()),0);const g=u.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=u.concat([p,g,u.from(c),u.from(A)]),h=Mt(m);return Nt("SimpleMessage",{dataHash:Array.from(h)})}function zt(t,e,a,n,r,i){const s=Qt(n,t),o=Kt(r,t,i),l=new Uint8Array(64);l.set(s.policyDataHash,0),l.set(s.policyAccountsHash,32);const c=Mt(l),d=new Uint8Array(64);d.set(o.cpiDataHash,0),d.set(o.cpiAccountsHash,32);const A=Mt(d),p=u.alloc(8);p.writeBigUInt64LE(BigInt(e.toString()),0);const g=u.alloc(8);g.writeBigInt64LE(BigInt(a.toString()),0);const m=u.concat([p,g,u.from(c),u.from(A)]),h=Mt(m);return Nt("SimpleMessage",{dataHash:Array.from(h)})}const Vt=new A.web3.PublicKey("Secp256r1SigVerify1111111111111111111111111");function Ft(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);{const e=new ArrayBuffer(2*Object.values(t).length),a=new DataView(e);return Object.values(t).forEach((t,e)=>{a.setUint16(2*e,t,!0)}),new Uint8Array(e)}}function Lt(t){nt(t.passkeyPublicKey,"passkeySignature.passkeyPublicKey"),ht(t.signature64,"passkeySignature.signature64"),ht(t.clientDataJsonRaw64,"passkeySignature.clientDataJsonRaw64"),ht(t.authenticatorDataRaw64,"passkeySignature.authenticatorDataRaw64");const e=Buffer.from(t.authenticatorDataRaw64,"base64"),a=Buffer.from(t.clientDataJsonRaw64,"base64"),n=Buffer.from(t.signature64,"base64");ot(gt(n),"passkeySignature.signature64 (decoded)");return function(t,e,a){if(33!==e.length||64!==a.length)throw new Error("Invalid key or signature length");const n=113+t.length,r=new Uint8Array(n);r.set(Ft([1,0]),0);const i={signature_offset:49,signature_instruction_index:65535,public_key_offset:16,public_key_instruction_index:65535,message_data_offset:113,message_data_size:t.length,message_instruction_index:65535};return r.set(Ft(i),2),r.set(e,16),r.set(a,49),r.set(t,113),new A.web3.TransactionInstruction({keys:[],programId:Vt,data:u.from(r)})}(Buffer.concat([e,Buffer.from(p.arrayBuffer(a))]),t.passkeyPublicKey,n)}function jt(t){const e=Buffer.from(t.signature64,"base64");return ot(gt(e),"passkeySignature.signature64 (decoded)"),{passkeyPublicKey:t.passkeyPublicKey,signature:gt(e),clientDataJsonRaw:Buffer.from(t.clientDataJsonRaw64,"base64"),authenticatorDataRaw:Buffer.from(t.authenticatorDataRaw64,"base64")}}function Jt(t){return A.web3.ComputeBudgetProgram.setComputeUnitLimit({units:t})}function Gt(t,e){return void 0===e?t:[Jt(e),...t]}function _t(t,e){return[t,...e]}function Zt(t,e,a){return Gt([t,...e],a)}function Yt(t){return void 0!==t?1:0}async function Xt(t,e,a,n={}){const{addressLookupTables:r,recentBlockhash:i,computeUnitLimit:s}=n,o=Gt(a,s),l=void 0!==r&&r.length>0,c=i||(await t.getLatestBlockhash()).blockhash;if(l){const t=new A.web3.TransactionMessage({payerKey:e,recentBlockhash:c,instructions:o}).compileToV0Message([...r]);return{transaction:new A.web3.VersionedTransaction(t),isVersioned:!0,recentBlockhash:c}}{const t=(new A.web3.Transaction).add(...o);return t.feePayer=e,t.recentBlockhash=c,{transaction:t,isVersioned:!1,recentBlockhash:c}}}global.Buffer=u,u.prototype.subarray=function(t,e){const a=Uint8Array.prototype.subarray.apply(this,[t,e]);return Object.setPrototypeOf(a,u.prototype),a};class qt{constructor(t){this.connection=t,this.program=new A.Program(H,{connection:t}),this.programId=this.program.programId,this.defaultPolicyProgram=new kt(t),this.walletPdas=new Ut(this.programId),this.policyResolver=new Rt(this.defaultPolicyProgram,this.walletPdas)}getSmartWalletPubkey(t){return this.walletPdas.smartWallet(t)}getWalletStatePubkey(t){return this.walletPdas.walletState(t)}getWalletDevicePubkey(t,e){return this.walletPdas.walletDevice(t,e)}getChunkPubkey(t,e){return this.walletPdas.chunk(t,e)}generateWalletId(){return new A.BN(K(8),"le")}async fetchWalletStateContext(t){const e=this.getWalletStatePubkey(t);return{walletState:e,data:await this.program.account.walletState.fetch(e)}}async fetchChunkContext(t,e){const a=this.getChunkPubkey(t,e);return{chunk:a,data:await this.program.account.chunk.fetch(a)}}validateCreateSmartWalletParams(t){$(t,"params"),tt(t.payer,"params.payer"),nt(t.passkeyPublicKey,"params.passkeyPublicKey"),ht(t.credentialIdBase64,"params.credentialIdBase64"),void 0!==t.amount&&ct(t.amount,"params.amount"),void 0!==t.smartWalletId&&ct(t.smartWalletId,"params.smartWalletId"),void 0!==t.policyDataSize&&yt(t.policyDataSize,"params.policyDataSize"),void 0!==t.policyInstruction&&pt(t.policyInstruction,"params.policyInstruction")}validateExecuteParams(t){$(t,"params"),tt(t.payer,"params.payer"),tt(t.smartWallet,"params.smartWallet"),St(t.passkeySignature,"params.passkeySignature"),it(t.credentialHash,"params.credentialHash"),pt(t.cpiInstruction,"params.cpiInstruction"),ct(t.timestamp,"params.timestamp"),void 0!==t.policyInstruction&&pt(t.policyInstruction,"params.policyInstruction"),void 0!==t.cpiSigners&&ft(t.cpiSigners,"params.cpiSigners")}validateCreateChunkParams(t){$(t,"params"),tt(t.payer,"params.payer"),tt(t.smartWallet,"params.smartWallet"),St(t.passkeySignature,"params.passkeySignature"),it(t.credentialHash,"params.credentialHash"),wt(t.cpiInstructions,"params.cpiInstructions"),ct(t.timestamp,"params.timestamp"),void 0!==t.policyInstruction&&pt(t.policyInstruction,"params.policyInstruction"),void 0!==t.cpiSigners&&ft(t.cpiSigners,"params.cpiSigners")}validateExecuteChunkParams(t){$(t,"params"),tt(t.payer,"params.payer"),tt(t.smartWallet,"params.smartWallet"),wt(t.cpiInstructions,"params.cpiInstructions"),void 0!==t.cpiSigners&&ft(t.cpiSigners,"params.cpiSigners")}async getWalletStateData(t){const{data:e}=await this.fetchWalletStateContext(t);return e}async getChunkData(t){return await this.program.account.chunk.fetch(t)}async getSmartWalletByCredentialHash(t){it(t,"credentialHash");const e=H.accounts?.find(t=>"WalletDevice"===t.name)?.discriminator;if(!e)throw new q("WalletDevice discriminator not found in IDL","credentialHash");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:g.default.encode(e)}},{memcmp:{offset:41,bytes:g.default.encode(t)}}]});if(0===a.length)return null;for(const t of a){const e=await this.program.account.walletDevice.fetch(t.pubkey);return{smartWallet:e.smartWallet,walletState:this.getWalletStatePubkey(e.smartWallet),walletDevice:t.pubkey,passkeyPublicKey:e.passkeyPubkey}}return null}async buildCreateSmartWalletIns(t,e,a,n){return tt(t,"payer"),tt(e,"smartWallet"),pt(a,"policyInstruction"),$(n,"args"),nt(n.passkeyPublicKey,"args.passkeyPublicKey"),it(n.credentialHash,"args.credentialHash"),ct(n.walletId,"args.walletId"),ct(n.amount,"args.amount"),await this.program.methods.createSmartWallet(n).accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),walletDevice:this.getWalletDevicePubkey(e,n.credentialHash),policyProgram:a.programId,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...Q(a)]).instruction()}async buildExecuteIns(t,e,a,n,r,i,s){return tt(t,"payer"),tt(e,"smartWallet"),tt(a,"walletDevice"),$(n,"args"),pt(r,"policyInstruction"),pt(i,"cpiInstruction"),void 0!==s&&ft(s,"cpiSigners"),await this.program.methods.execute(n).accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),walletDevice:a,policyProgram:r.programId,cpiProgram:i.programId,ixSysvar:A.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...Q(r),...Q(i,s)]).instruction()}async buildCreateChunkIns(t,e,a,n,r){tt(t,"payer"),tt(e,"smartWallet"),tt(a,"walletDevice"),$(n,"args"),pt(r,"policyInstruction");const{walletState:i,data:s}=await this.fetchWalletStateContext(e),o=this.getChunkPubkey(e,s.lastNonce);return await this.program.methods.createChunk(n).accountsPartial({payer:t,smartWallet:e,walletState:i,walletDevice:a,policyProgram:r.programId,chunk:o,ixSysvar:A.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...Q(r)]).instruction()}async buildExecuteChunkIns(t,e,a,n){tt(t,"payer"),tt(e,"smartWallet"),wt(a,"cpiInstructions"),void 0!==n&&ft(n,"cpiSigners");const{data:r,walletState:i}=await this.fetchWalletStateContext(e),{chunk:s,data:o}=await this.fetchChunkContext(e,r.lastNonce),l=a.map(t=>u.from(t.data)),c=function(t){const e=[];let a=0;for(let n=0;n<t.length-1;n++)a+=t[n].keys.length+1,e.push(a);return e}(a),d=function(t,e){return t.flatMap(t=>[{pubkey:t.programId,isSigner:!1,isWritable:!1},...Q(t,e)])}(a,n);return await this.program.methods.executeChunk(l,u.from(c)).accountsStrict({payer:t,smartWallet:e,walletState:i,chunk:s,sessionRefund:o.rentRefundAddress,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts(d).instruction()}async createSmartWalletTxn(t,e={}){this.validateCreateSmartWalletParams(t);const a=t.smartWalletId??this.generateWalletId(),n=this.getSmartWalletPubkey(a),r=this.getWalletStatePubkey(n),i=t.amount??new A.BN(_),s=t.policyDataSize??this.defaultPolicyProgram.getPolicyDataSize(),o=O(t.credentialIdBase64),l=await this.policyResolver.resolveForCreate({provided:t.policyInstruction,smartWalletId:a,smartWallet:n,walletState:r,passkeyPublicKey:t.passkeyPublicKey,credentialHash:o}),c={passkeyPublicKey:t.passkeyPublicKey,credentialHash:o,initPolicyData:l.data,walletId:a,amount:i,policyDataSize:s},d=await this.buildCreateSmartWalletIns(t.payer,n,l,c);return{transaction:(await Xt(this.connection,t.payer,[d],e)).transaction,smartWalletId:a,smartWallet:n}}async executeTxn(t,e={}){this.validateExecuteParams(t);const a=Lt(t.passkeySignature),n=await this.getWalletStateData(t.smartWallet),r=this.getWalletDevicePubkey(t.smartWallet,t.credentialHash),i=await this.policyResolver.resolveForExecute({provided:t.policyInstruction,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:t.passkeySignature.passkeyPublicKey,walletStateData:n}),s=jt(t.passkeySignature),o=_t(a,[await this.buildExecuteIns(t.payer,t.smartWallet,r,{...s,verifyInstructionIndex:Yt(e.computeUnitLimit),splitIndex:i.keys.length,policyData:i.data,cpiData:t.cpiInstruction.data,timestamp:t.timestamp},i,t.cpiInstruction,[...t.cpiSigners??[],t.payer])]);return(await Xt(this.connection,t.payer,o,e)).transaction}async createChunkTxn(t,e={}){this.validateCreateChunkParams(t);const a=Lt(t.passkeySignature),n=await this.getWalletStateData(t.smartWallet),r=this.getWalletDevicePubkey(t.smartWallet,t.credentialHash),i=await this.policyResolver.resolveForExecute({provided:t.policyInstruction,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:t.passkeySignature.passkeyPublicKey,walletStateData:n}),s=jt(t.passkeySignature),o=function(t,e,a){const n=Kt(t,e,a),r=new Uint8Array(64);return r.set(n.cpiDataHash,0),r.set(n.cpiAccountsHash,32),Array.from(new Uint8Array(p.arrayBuffer(r)))}(t.cpiInstructions,t.smartWallet,[...t.cpiSigners??[],t.payer]),l=_t(a,[await this.buildCreateChunkIns(t.payer,t.smartWallet,r,{...s,policyData:i.data,verifyInstructionIndex:Yt(e.computeUnitLimit),timestamp:t.timestamp,cpiHash:Array.from(o)},i)]);return(await Xt(this.connection,t.payer,l,e)).transaction}async executeChunkTxn(t,e={}){this.validateExecuteChunkParams(t);const a=await this.buildExecuteChunkIns(t.payer,t.smartWallet,t.cpiInstructions,t.cpiSigners);return(await Xt(this.connection,t.payer,[a],e)).transaction}async buildAuthorizationMessage(t){let e;const{action:a,smartWallet:n,passkeyPublicKey:r,timestamp:i}=t;switch(a.type){case M.CreateChunk:{const{policyInstruction:s,cpiInstructions:o,cpiSigners:l}=a.args,c=await this.getWalletStateData(t.smartWallet),d=await this.policyResolver.resolveForExecute({provided:s,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:r,walletStateData:c});e=zt(n,(await this.getWalletStateData(n)).lastNonce,i,d,o,[...l??[],t.payer]);break}default:throw new q(`Unsupported SmartWalletAction: ${a.type}`,"action.type")}return e}}"function"!=typeof globalThis.structuredClone&&(globalThis.structuredClone=t=>JSON.parse(JSON.stringify(t)));class $t extends h{constructor(){super(),this.iframeRef=null,this.retryDelays=[200,400,800,1500,3e3]}setIframeRef(t){this.iframeRef=t}notifyCredentialsUpdated(t){this.emit("credentials-updated",t);const e=new CustomEvent("lazorkit:credentials-updated",{detail:t,bubbles:!0,cancelable:!0});window.dispatchEvent(e)}syncCredentials(t=!1){this.iframeRef&&this.iframeRef.contentWindow?this.performCredentialSync(t):setTimeout(()=>this.syncCredentials(t),500)}performCredentialSync(t){if(!this.iframeRef?.contentWindow)throw new Error("Cannot sync credentials: iframe reference not available");const e=localStorage.getItem("CREDENTIAL_ID")||"",a=localStorage.getItem("PUBLIC_KEY")||"",n=localStorage.getItem("SMART_WALLET_ADDRESS")||"";if(!(t||e&&a))return;const r={type:"SYNC_CREDENTIALS",data:{credentialId:e,publickey:a,smartWalletAddress:n,timestamp:Date.now()}};try{this.iframeRef.contentWindow.postMessage(r,"*"),this.retryDelays.forEach(t=>{setTimeout(()=>{try{this.iframeRef?.contentWindow&&this.iframeRef.contentWindow.postMessage(r,"*")}catch(t){}},t)})}catch(t){}}storeCredential(t){t.credentialId&&localStorage.setItem("CREDENTIAL_ID",t.credentialId),t.publickey&&localStorage.setItem("PUBLIC_KEY",t.publickey),t.smartWalletAddress&&localStorage.setItem("SMART_WALLET_ADDRESS",t.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",(new Date).toISOString())}destroy(){this.removeAllListeners(),this.iframeRef=null}}class te extends h{constructor(t){super(),this.dialogRef=null,this.iframeRef=null,this.popupWindow=null,this.popupCloseInterval=null,this.isClosing=!1,this.isDestroyed=!1,this.logger=new R("DialogManager"),this._currentAction=null,this.config=t,this.credentialManager=new $t,this.logger.debug("Created dialog manager"),this.setupMessageListener()}async openConnect(){return new Promise((t,e)=>{const a=()=>{this.off("connect-result",n),this.off("error",r)},n=e=>{a(),t(e)},r=t=>{a(),e(t)};this.on("connect-result",n),this.on("error",r);const i=setTimeout(()=>{a(),e(new Error("Connection timed out after 60 seconds"))},6e4),s=t,o=e;t=t=>{clearTimeout(i),s(t)},e=t=>{clearTimeout(i),o(t)},this._currentAction=W.CONNECT;if(this.shouldUsePopup("connect")){const t=`${this.config.portalUrl}?action=${W.CONNECT}`;this.openPopup(t).catch(e)}else this.openConnectDialog().catch(e)})}async openSign(t,e,a,n){return new Promise((r,i)=>{const s=()=>{this.off("sign-result",o),this.off("error",l)},o=t=>{s(),r(t)},l=t=>{s(),i(t)};this.on("sign-result",o),this.on("error",l);const c=setTimeout(()=>{s(),i(new Error("Signing timed out after 60 seconds"))},6e4),d=r,A=i;r=t=>{clearTimeout(c),d(t)},i=t=>{clearTimeout(c),A(t)},this._currentAction=W.SIGN;const u=this.shouldUsePopup("sign"),p=encodeURIComponent(t);let g=`${this.config.portalUrl}?action=${W.SIGN}&message=${p}&transaction=${encodeURIComponent(e)}&credentialId=${encodeURIComponent(a)}`;n&&(g+=`&clusterSimulation=${n}`),u?this.openPopup(g).catch(i):this.openSignDialog(g).catch(i)})}async openSignMessage(t,e){return new Promise((a,n)=>{const r=()=>{this.off("sign-result",i),this.off("error",s)},i=t=>{r(),a(t)},s=t=>{r(),n(t)};this.on("sign-result",i),this.on("error",s);const o=setTimeout(()=>{r(),n(new Error("Signing timed out after 60 seconds"))},6e4),l=a,c=n;a=t=>{clearTimeout(o),l(t)},n=t=>{clearTimeout(o),c(t)},this._currentAction=W.SIGN;const d=encodeURIComponent(t),A=`${this.config.portalUrl}?action=${W.SIGN}&message=${d}&credentialId=${encodeURIComponent(e)}`;this.shouldUsePopup("sign")?this.openPopup(A).catch(n):this.openSignDialog(A).catch(n)})}async openConnectDialog(){const t=`${this.config.portalUrl}?action=${W.CONNECT}`;await this.openModal(t)}ensureFonts(){const t="lazorkit-font-roboto-flex";if(document.getElementById(t))return;const e=document.createElement("link");e.id=t,e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&display=swap",document.head.appendChild(e)}ensureDialogBackdropCSS(){const t="lazorkit-dialog-backdrop-style";if(document.getElementById(t))return;const e=document.createElement("style");e.id=t,e.textContent='\n    /* ===== Backdrop (overlay nh) ===== */\n    dialog#lazorkit-dialog::backdrop {\n      background: rgba(0,0,0,0);\n      animation: lazor-backdrop-in 160ms ease-out forwards;\n    }\n\n    dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n      animation: lazor-backdrop-out 140ms ease-in forwards;\n    }\n\n    @keyframes lazor-backdrop-in {\n      from { background: rgba(0,0,0,0); }\n      to   { background: rgba(0,0,0,0.12); } /*  overlay nh */\n    }\n\n    @keyframes lazor-backdrop-out {\n      from { background: rgba(0,0,0,0.12); }\n      to   { background: rgba(0,0,0,0); }\n    }\n\n    /* ===== Panel animations ===== */\n    @keyframes lazor-drawer-in {\n      from { transform: translateY(16px); opacity: 0.98; }\n      to   { transform: translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-drawer-out {\n      from { transform: translateY(0); opacity: 1; }\n      to   { transform: translateY(16px); opacity: 0.98; }\n    }\n\n    @keyframes lazor-float-in {\n      from { transform: scale(0.985) translateY(4px); opacity: 0; }\n      to   { transform: scale(1) translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-float-out {\n      from { transform: scale(1) translateY(0); opacity: 1; }\n      to   { transform: scale(0.985) translateY(4px); opacity: 0; }\n    }\n\n    #lazorkit-panel {\n      will-change: transform, opacity;\n      transform-origin: center;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-drawer-in 180ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-drawer-out 150ms ease-in forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-float-in 170ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-float-out 140ms ease-in forwards;\n    }\n\n    /* ===== Reduced motion ===== */\n    @media (prefers-reduced-motion: reduce) {\n      dialog#lazorkit-dialog::backdrop {\n        animation: none !important;\n        background: rgba(0,0,0,0.12) !important;\n      }\n      dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n        background: rgba(0,0,0,0) !important;\n      }\n      dialog#lazorkit-dialog #lazorkit-panel {\n        animation: none !important;\n      }\n    }\n  ',document.head.appendChild(e)}createCloseButton(t){const e=document.createElement("button");return e.type="button",e.title="Close Dialog",e.setAttribute("aria-label","Close Dialog"),Object.assign(e.style,{width:"36px",height:"36px",borderRadius:"10px",border:"none",background:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0",color:"rgba(255, 255, 255, 0.6)",outline:"none",webkitTapHighlightColor:"transparent"}),e.addEventListener("mouseenter",()=>{e.style.background="rgba(255,255,255,0.1)",e.style.color="#ffffff"}),e.addEventListener("mouseleave",()=>{e.style.background="transparent",e.style.color="rgba(255, 255, 255, 0.6)"}),e.onclick=t,e.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg"\n      width="20" height="20" viewBox="0 0 24 24"\n      fill="none" stroke="currentColor" stroke-width="2"\n      stroke-linecap="round" stroke-linejoin="round">\n      <line x1="18" y1="6" x2="6" y2="18" />\n      <line x1="6" y1="6" x2="18" y2="18" />\n    </svg>\n  ',e}async openSignDialog(t){await this.openModal(t),this.iframeRef&&(this.credentialManager.setIframeRef(this.iframeRef),setTimeout(()=>{this.credentialManager.syncCredentials(!0)},500))}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}shouldUsePopup(t){const e=this.isMobileDevice();return!(!this.isSafari()||"connect"!==t)||(!(!e||"connect"!==t)||!(!e&&"sign"===t)&&(!e||"sign"!==t))}getPopupDimensions(){if(!window.top)return{width:450,height:600,top:0,left:0};const t=window.top.outerWidth/2+window.top.screenX-225;return{width:450,height:600,top:window.top.outerHeight/2+window.top.screenY-300,left:t}}async openPopup(t){if(this.popupWindow&&!this.popupWindow.closed)try{this.popupWindow.close()}catch(t){}const e=this.getPopupDimensions();if(this.popupWindow=window.open(t,"lazorkit-popup",`width=${e.width},height=${e.height},top=${e.top},left=${e.left},resizable,scrollbars,status`),this.startPopupMonitor(),!this.popupWindow)throw this.logger.error("Popup was blocked by browser"),new Error("Popup was blocked by browser")}startPopupMonitor(){this.popupCloseInterval&&clearInterval(this.popupCloseInterval),this.popupCloseInterval=setInterval(()=>{this.popupWindow?.closed&&(this.popupWindow=null,this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null))},500)}async openModal(t){this.dialogRef||this.createModal(),this.iframeRef&&(this.iframeRef.src=t),this.dialogRef&&!this.dialogRef.open&&(this.dialogRef.setAttribute("data-state","opening"),this.dialogRef.showModal(),window.setTimeout(()=>{this.dialogRef?.open&&this.dialogRef.setAttribute("data-state","idle")},220))}createModal(){this.ensureFonts(),this.ensureDialogBackdropCSS();const t=document.createElement("dialog");t.id="lazorkit-dialog",t.style.colorScheme="dark",t.setAttribute("data-theme","dark");const e=this.isMobileDevice(),a=(t=>({overlay:{position:"fixed",inset:0,padding:0,border:"none",background:"transparent",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",overflow:"visible",zIndex:2147483647,display:"grid",placeItems:t?"end center":"center"},panel:{width:t?"100%":"360px",maxWidth:t?"100%":"90vw",height:t?"55vh":"650px",maxHeight:t?"55vh":"90vh",background:"white",borderRadius:t?"20px 20px 0 0":"20px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",position:"relative"},closeButton:{zIndex:10},iframeContainer:{position:"relative",width:"100%",height:"100%",border:"none",margin:0,padding:0,overflow:"hidden",borderRadius:"inherit",background:"white"},iframe:{width:"100%",height:"100%",border:0,borderRadius:"inherit",display:"block"}}))(e);Object.assign(t.style,a.overlay),Object.assign(t.style,{"--background-color-th_base":"#191919","--background-color-th_frame":"#191919","--text-color-th_base":"#eeeeee","--border-color-th_frame":"rgba(255,255,255,0.10)"});const n=document.createElement("div"),r=e?"drawer":"floating";t.setAttribute("data-variant",r),t.setAttribute("data-state","idle"),n.id="lazorkit-panel",Object.assign(n.style,a.panel),Object.assign(n.style,{display:"flex",flexDirection:"column"}),Object.assign(n.style,{background:"var(--background-color-th_base, #fcfcfc)",color:"var(--text-color-th_base, #202020)",fontFamily:'"Roboto Flex", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'});const i=document.createElement("div");Object.assign(i.style,{height:"32px",flex:"0 0 auto",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 12px",boxSizing:"border-box",borderBottom:"1px solid rgba(0,0,0,0.08)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, var(--background-color-th_base, #fcfcfc))",color:"var(--text-color-th_base, #202020)",borderBottom:"1px solid var(--border-color-th_frame, rgba(0,0,0,0.08))"});const s=document.createElement("div");Object.assign(s.style,a.iframeContainer),Object.assign(s.style,{flex:"1 1 auto"}),Object.assign(s.style,{background:"var(--background-color-th_base, #fcfcfc)"}),Object.assign(n.style,{background:"var(--background-color-th_base, #191919)",color:"var(--text-color-th_base, #eeeeee)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, #191919)",color:"var(--text-color-th_base, #eeeeee)",borderBottom:"1px solid var(--border-color-th_frame, rgba(255,255,255,0.10))"}),Object.assign(s.style,{background:"var(--background-color-th_base, #191919)"});const o=this.createCloseButton(()=>{this.closeDialog(),this.emit("close")});Object.assign(o.style,{position:"static",top:"",right:""}),o.id="lazorkit-dialog-close",o.ariaLabel="Close",Object.assign(o.style,a.closeButton);const l=document.createElement("iframe");l.id="lazorkit-iframe",Object.assign(l.style,a.iframe),l.allow=`publickey-credentials-get ${this.config.portalUrl}; publickey-credentials-create ${this.config.portalUrl}; clipboard-write; camera; microphone`;const c=l.sandbox;c.add("allow-forms"),c.add("allow-scripts"),c.add("allow-same-origin"),c.add("allow-popups"),c.add("allow-popups-to-escape-sandbox"),c.add("allow-modals"),l.setAttribute("aria-label","Lazor Wallet"),l.tabIndex=0,l.title="Lazor",t.addEventListener("cancel",()=>this.closeDialog()),t.addEventListener("click",e=>{e.target===t&&this.closeDialog()}),i.appendChild(o),n.appendChild(i),s.appendChild(l),n.appendChild(s),t.appendChild(n),document.body.appendChild(t),this.dialogRef=t,this.iframeRef=l}setupMessageListener(){window.addEventListener("message",t=>{if(!t.origin.includes(new URL(this.config.portalUrl).hostname))return;const{type:e,data:a,error:n}=t.data;if(n)this.emit("error",new Error(n.message||"Portal error"));else switch(e){case"connect-result":case"WALLET_CONNECTED":const t={publicKey:a.publickey||a.publicKey||"",credentialId:a.credentialId,isCreated:"create"===a.connectionType||!!a.publickey,connectionType:a.connectionType||(a.publickey?"create":"get"),timestamp:a.timestamp||Date.now(),accountName:a.accountName};this.emit("connect-result",t),this.closeDialog();break;case"sign-result":case"SIGNATURE_CREATED":const e={signature:a.normalized,clientDataJsonBase64:a.clientDataJSONReturn,authenticatorDataBase64:a.authenticatorDataReturn,signedPayload:a.msg};this.emit("sign-result",e),this.closeDialog();break;case"error":this.emit("error",new Error(a?.message||"Unknown portal error"));break;case"close":this.closeDialog()}})}closeDialog(){if(this.isClosing)return;this.isClosing=!0;const t=this.dialogRef,e=this.iframeRef;try{t&&t.setAttribute("data-state","closing"),window.setTimeout(()=>{try{if(e&&(e.parentNode&&e.parentNode.removeChild(e),this.iframeRef=null),t){try{t.open&&t.close()}catch{}t.parentNode&&t.parentNode.removeChild(t),this.dialogRef=null}if(this.popupWindow){try{this.popupWindow.close()}catch{}this.popupWindow=null}this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null),this.logger.debug("Closed dialog (animated)")}catch(t){this.logger.error("Error during animated close:",t)}finally{this.isClosing=!1}},170)}catch(t){this.logger.error("Error closing dialog:",t),this.isClosing=!1}}getIframeRef(){return this.iframeRef}getDialogRef(){return this.dialogRef}getPopupWindow(){return this.popupWindow}getCurrentAction(){return this._currentAction}destroy(){this.isDestroyed||(this.isDestroyed=!0,this.closeDialog(),this.credentialManager.destroy(),this.removeAllListeners(),this.logger.debug("Destroyed dialog manager"))}}const ee=t=>new te({portalUrl:t.portalUrl,rpcUrl:t.rpcUrl,paymasterUrl:t.paymasterConfig.paymasterUrl}),ae=t=>Array.from(new Uint8Array(p.arrayBuffer(Buffer.from(t,"base64")))),ne=(t,e,a)=>{const n=t instanceof Error?t:new Error(String(t));throw e({error:n}),a?.(n),n},re=t=>t?Array.from(Buffer.from(t,"base64")):[],ie=async(t,e,a)=>{const{isConnecting:n,config:r}=t();if(n)throw new Error("Already connecting");e({isConnecting:!0,error:null});try{const n=await U.getWallet();if((()=>{if("undefined"==typeof window)return;const t=localStorage.getItem("lazorkit-wallet");if(t)try{const e=JSON.parse(t);e.state&&void 0!==e.version&&localStorage.removeItem("lazorkit-wallet")}catch(t){}})(),n)return e({wallet:n}),a?.onSuccess?.(n),n;const i=ee(r);try{const n=await i.openConnect(),s=new T(r.paymasterConfig),o=new qt(t().connection),l=ae(n.credentialId),c=await o.getSmartWalletByCredentialHash(l);let d,A;if(!n.publicKey&&c?(A=Buffer.from(c.passkeyPublicKey).toString("base64"),localStorage.setItem("PUBLIC_KEY",A)):A=n.publicKey,c)d=c.smartWallet.toBase58();else{const t=await s.getPayer(),e=await o.createSmartWalletTxn({passkeyPublicKey:re(A),payer:t,credentialIdBase64:n.credentialId});await s.signAndSend(e.transaction),d=e.smartWallet.toBase58()}const u={credentialId:n.credentialId,passkeyPubkey:re(A),expo:"web",platform:navigator.platform,smartWallet:d,walletDevice:"",accountName:n.accountName};return await U.saveWallet(u),e({wallet:u}),a?.onSuccess?.(u),u}finally{i.destroy()}}catch(t){return ne(t,e,a?.onFail)}finally{e({isConnecting:!1})}},se=d()(C((t,e)=>({wallet:null,config:{portalUrl:P.PORTAL_URL,paymasterConfig:{paymasterUrl:P.PAYMASTER_URL},rpcUrl:P.RPC_ENDPOINT},connection:new s(P.RPC_ENDPOINT,E),isLoading:!1,isConnecting:!1,isSigning:!1,error:null,setConfig:e=>{try{const a=new s(e.rpcUrl||P.RPC_ENDPOINT,E);t({config:e,connection:a})}catch(t){throw console.error("Failed to update wallet configuration:",t,{config:e}),new Error(`Failed to update configuration: ${t}`)}},setWallet:e=>{try{t({wallet:e})}catch(t){throw console.error("Failed to set wallet:",t,{wallet:e}),t}},setLoading:e=>t({isLoading:e}),setConnecting:e=>t({isConnecting:e}),setSigning:e=>t({isSigning:e}),setConnection:e=>{try{t({connection:e})}catch(t){throw console.error("Failed to set connection:",t,{endpoint:e?.rpcEndpoint}),t}},setError:e=>{t({error:e}),e&&console.error("Error state set:",e)},clearError:()=>{t({error:null})},connect:a=>ie(e,t,a),disconnect:()=>(async(t,e)=>{try{await U.clearWallet(),t({wallet:null,error:null,isConnecting:!1,isSigning:!1,isLoading:!1}),e?.onSuccess?.()}catch(a){return ne(a,t,e?.onFail)}})(t),signAndSendTransaction:a=>(async(t,e,a)=>{const{isSigning:n,connection:r,wallet:i,config:s}=t();if(n)throw new Error("Already signing");if(!i)throw new Error("No wallet connected");if(!r)throw new Error("No connection available");e({isSigning:!0,error:null});try{const t=new T(s.paymasterConfig),e=new qt(r),n=await t.getPayer(),o=await z(r),l=await e.buildAuthorizationMessage({action:{type:M.CreateChunk,args:{cpiInstructions:a.instructions}},payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),passkeyPublicKey:i.passkeyPubkey,timestamp:new A.BN(o),credentialHash:ae(i.credentialId)}),c=Buffer.from(l).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=await r.getLatestBlockhash(),u=new A.web3.TransactionMessage({payerKey:n,recentBlockhash:d.blockhash,instructions:a.instructions}).compileToV0Message(),p=new A.web3.VersionedTransaction(u),g=Buffer.from(p.serialize()).toString("base64"),m=ee(s),h=i.credentialId,y=a.transactionOptions?.clusterSimulation;try{const s=await m.openSign(c,g,h,y),l={msg:c,normalized:s.signature,clientDataJSONReturn:s.clientDataJsonBase64,authenticatorDataReturn:s.authenticatorDataBase64},d=ae(i.credentialId),u=await e.createChunkTxn({payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),passkeySignature:{passkeyPublicKey:i.passkeyPubkey,signature64:l.normalized,clientDataJsonRaw64:l.clientDataJSONReturn,authenticatorDataRaw64:l.authenticatorDataReturn},cpiInstructions:a.instructions,timestamp:o,credentialHash:d}),p=await t.signAndSend(u);await r.confirmTransaction(p),await V(r,e,new A.web3.PublicKey(i.smartWallet));const f=a.transactionOptions?.addressLookupTableAccounts||[],w=await e.executeChunkTxn({payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),cpiInstructions:a.instructions},{addressLookupTables:f,computeUnitLimit:a.transactionOptions?.computeUnitLimit});let b;return b=f.length>0?await t.signAndSendVersionedTransaction(w):await t.signAndSend(w),a.onSuccess?.(b),b}finally{m.destroy()}}catch(t){return ne(t,e,a.onFail)}finally{e({isSigning:!1})}})(e,t,a),signMessage:a=>(async(t,e,a)=>{const{isSigning:n,wallet:r,config:i}=t();if(n)throw new Error("Already signing");if(!r)throw new Error("No wallet connected");e({isSigning:!0,error:null});try{const t=ee(i);try{const e=await t.openSignMessage(a,r.credentialId);return{signature:e.signature,signedPayload:e.signedPayload}}finally{t.destroy()}}catch(t){throw e({error:t}),t}finally{e({isSigning:!1})}})(e,t,a)}),{name:"lazorkit-wallet-store",storage:v(()=>x),partialize:t=>({wallet:t.wallet,config:t.config})})),oe=n=>{const{children:r,rpcUrl:i=P.RPC_ENDPOINT,portalUrl:s=P.PORTAL_URL,paymasterConfig:o={paymasterUrl:P.PAYMASTER_URL}}=n,{setConfig:l}=se();return a(()=>{l({portalUrl:s,paymasterConfig:o,rpcUrl:i})},[i,s,o,l]),t(e,{children:r})};function le(t){return Uint8Array.from(atob(t),t=>t.charCodeAt(0))}async function ce(t){let e=t;if(64===e.length){const t=new Uint8Array(65);t[0]=4,t.set(e,1),e=t}return crypto.subtle.importKey("raw",e,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])}async function de({signedPayload:t,signature:e,publicKey:a}){const n=le(t),r=le(e),i=le(a),s=await ce(i);return crypto.subtle.verify({name:"ECDSA",hash:"SHA-256"},s,r,n)}const Ae=()=>{const{wallet:t,isLoading:e,isConnecting:a,isSigning:i,error:s,connect:o,disconnect:l,signAndSendTransaction:c,signMessage:d}=se(),A=n(async t=>{try{return await o(t)}catch(t){throw console.error("Failed to connect wallet:",t),t}},[o]),u=n(async()=>{try{await l()}catch(t){throw console.error("Failed to disconnect wallet:",t),t}},[l]),p=n(async t=>{try{return await c({instructions:t.instructions,transactionOptions:t.transactionOptions})}catch(t){throw console.error("Failed to sign and send transaction:",t),t}},[c]),g=n(async t=>{try{return await d(t)}catch(t){throw console.error("Failed to sign message:",t),t}},[d]),m=n(async({signedPayload:t,signature:e,publicKey:a})=>{const n=Buffer.from(t).toString("base64"),r=Buffer.from(e).toString("base64"),i=Buffer.from(a).toString("base64");return await de({signedPayload:n,signature:r,publicKey:i})},[]);return{smartWalletPubkey:t?.smartWallet?new r(t.smartWallet):null,isConnected:!!t,isLoading:e||a||i,isConnecting:a,isSigning:i,error:s,wallet:t,connect:A,disconnect:u,signAndSendTransaction:p,signMessage:g,verifyMessage:m}};function ue(){if("undefined"!=typeof window&&window.ReactNativeWebView)return"mobile";const t=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(t)?"mobile":"web"}function pe(){const t=navigator.userAgent.toLowerCase();return/^((?!chrome|android).)*safari/i.test(t)}function ge(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function me(){return/Android/i.test(navigator.userAgent)}const he="CREDENTIAL_ID",ye="PUBLIC_KEY",fe="SMART_WALLET_ADDRESS";class we{static saveCredentials(t){try{t.credentialId&&localStorage.setItem(he,t.credentialId),localStorage.setItem(ye,t.publickey),localStorage.setItem(fe,t.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",t.timestamp.toString())}catch(t){console.error("Failed to save credentials to local storage:",t)}}static getCredentials(){try{const t=localStorage.getItem(he),e=localStorage.getItem(ye),a=localStorage.getItem(fe),n=localStorage.getItem("CREDENTIALS_TIMESTAMP");return e&&a?{credentialId:t||void 0,publickey:e,smartWalletAddress:a,timestamp:n?parseInt(n):Date.now()}:null}catch(t){return console.error("Failed to get credentials from local storage:",t),null}}static updateSmartWalletAddress(t){try{localStorage.setItem(fe,t)}catch(t){console.error("Failed to update smart wallet address in local storage:",t)}}static clearCredentials(){try{localStorage.removeItem(he),localStorage.removeItem(ye),localStorage.removeItem(fe),localStorage.removeItem("CREDENTIALS_TIMESTAMP"),console.log("Credentials cleared from local storage")}catch(t){console.error("Failed to clear credentials from local storage:",t)}}static getItem(t){return localStorage.getItem(t)}static setItem(t,e){localStorage.setItem(t,e)}}const be="Lazorkit Wallet",Se={rpcUrl:"https://api.devnet.solana.com",portalUrl:"https://portal.lazor.sh",paymasterConfig:{paymasterUrl:"https://kora.devnet.lazorkit.com"}};class ke extends y{constructor(t){super(),this.name=be,this.url="https://lazorkit.com",this.icon="data:image/png;base64,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",this.supportedTransactionVersions=new Set(["legacy",0]),this._publicKey=null,this._readyState="undefined"==typeof window||"undefined"==typeof document?f.Unsupported:f.Installed,this._connecting=!1,this._wallet=null,this._config=Se,t&&(this._config={...this._config,...t})}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==f.Installed)throw new w;this._connecting=!0,this.emit("readyStateChange",this._readyState);const t=await U.getWallet();if(t)return void this._updateWalletState(t);const e=this._createDialogManager();try{const t=await e.openConnect(),a=await this._ensureWalletOnChain(t);await U.saveWallet(a),this._updateWalletState(a)}finally{e.destroy()}}catch(t){throw this.emit("error",t),t}finally{this._connecting=!1}}_updateWalletState(t){this._wallet=t,this._publicKey=new r(t.smartWallet),this.emit("connect",this._publicKey)}_createDialogManager(){return new te({portalUrl:this._config.portalUrl,rpcUrl:this._config.rpcUrl,paymasterUrl:this._config.paymasterConfig.paymasterUrl})}async _ensureWalletOnChain(t){const e=new s(this._config.rpcUrl),a=new k({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),n=new qt(e),r=ae(t.credentialId),i=await n.getSmartWalletByCredentialHash(r);let o,l;if(!t.publicKey&&i?(l=u.from(i.passkeyPublicKey).toString("base64"),localStorage.setItem("PUBLIC_KEY",l)):l=t.publicKey,i)o=i.smartWallet.toBase58();else{const e=await a.getPayerSigner(),r=await n.createSmartWalletTxn({passkeyPublicKey:re(t.publicKey),payer:new A.web3.PublicKey(e.signer_address),credentialIdBase64:t.credentialId});await a.signAndSendTransaction({transaction:u.from(r.transaction.serialize({requireAllSignatures:!1})).toString("base64"),signer_key:e.signer_address}),o=r.smartWallet.toBase58()}return{credentialId:t.credentialId,passkeyPubkey:re(l),expo:"web",platform:navigator.platform,smartWallet:o,walletDevice:""}}async disconnect(){await U.clearWallet(),this._wallet=null,this._publicKey=null,this.emit("disconnect")}async sendTransaction(t){try{if(!this._wallet||!this._publicKey)throw new b;const e=this._prepareInstructions(t);if(0===e.length)throw new S("No instructions to sign");const a=this._initializeClients();let n=[];if("version"in t){const e=t.message.addressTableLookups;n=await Promise.all(e.map(async t=>{const e=await a.connection.getAccountInfo(t.accountKey);if(!e)throw new Error("Lookup table not found");return new o({key:t.accountKey,state:o.deserialize(e.data)})}))}const r=await a.paymaster.getPayerSigner(),i=await z(a.connection),s=ae(this._wallet.credentialId),l=await this._buildAuthorizationMessage(a.smartWallet,e,r.signer_address,i,s),c=await a.connection.getLatestBlockhash(),d=await this._signWithDialog(l,e,c.blockhash,r.signer_address);return await this._executeSmartWalletTransaction(a,e,d,r.signer_address,i,s,n)}catch(t){throw this.emit("error",t),t}}async signTransaction(t){throw new S("Lazorkit Wallet does not support signTransaction. Please use sendTransaction or signAndSendTransaction.")}async signAllTransactions(t){throw new S("Lazorkit Wallet does not support signAllTransactions. Please use sendTransaction or signAndSendTransaction.")}async signMessage(t){const e=this._createDialogManager();try{if(!this._wallet||!this._publicKey)throw new b;const a=u.from(t).toString("base64"),n=await e.openSign(a,"",this._wallet.credentialId,this._config.clusterSimulation),r=JSON.stringify({signature:n.signature,signedPayload:n.signedPayload});return new Uint8Array(u.from(r))}catch(t){throw this.emit("error",t),t}finally{e.destroy()}}_initializeClients(){const t=new s(this._config.rpcUrl);return{connection:t,paymaster:new k({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),smartWallet:new qt(t)}}_prepareInstructions(t){return"version"in t?t.message.compiledInstructions.map(e=>new l({keys:e.accountKeyIndexes.map(e=>({pubkey:t.message.staticAccountKeys[e],isSigner:t.message.isAccountSigner(e),isWritable:t.message.isAccountWritable(e)})),programId:new r(t.message.staticAccountKeys[e.programIdIndex]),data:u.from(e.data)})):[...t.instructions]}async _buildAuthorizationMessage(t,e,a,n,r){return await t.buildAuthorizationMessage({action:{type:M.CreateChunk,args:{cpiInstructions:e}},payer:new A.web3.PublicKey(a),smartWallet:this._publicKey,passkeyPublicKey:this._wallet.passkeyPubkey,timestamp:new A.BN(n),credentialHash:r})}async _signWithDialog(t,e,a,n){const r=u.from(t).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,""),i=this._createDialogManager();try{const t=new A.web3.TransactionMessage({payerKey:new A.web3.PublicKey(n),recentBlockhash:a,instructions:e}).compileToV0Message(),s=new A.web3.VersionedTransaction(t),o=u.from(s.serialize()).toString("base64");return await i.openSign(r,o,this._wallet.credentialId,this._config.clusterSimulation)}finally{i.destroy()}}async _executeSmartWalletTransaction(t,e,a,n,r,i,s){const o=await t.smartWallet.createChunkTxn({payer:new A.web3.PublicKey(n),smartWallet:this._publicKey,passkeySignature:{passkeyPublicKey:this._wallet.passkeyPubkey,signature64:a.signature,clientDataJsonRaw64:a.clientDataJsonBase64,authenticatorDataRaw64:a.authenticatorDataBase64},cpiInstructions:e,timestamp:r,credentialHash:i}),l=await this._sendToPaymaster(t.paymaster,o,n);await t.connection.confirmTransaction(l,"confirmed"),await V(t.connection,t.smartWallet,this._publicKey);const c=await t.smartWallet.executeChunkTxn({payer:new A.web3.PublicKey(n),smartWallet:this._publicKey,cpiInstructions:e},{addressLookupTables:s});return await this._sendToPaymaster(t.paymaster,c,n)}async _sendToPaymaster(t,e,a){let n;n="version"in e?u.from(e.serialize()):u.from(e.serialize({requireAllSignatures:!1,verifySignatures:!1}));return(await t.signAndSendTransaction({transaction:n.toString("base64"),signer_key:a})).signature}}function Ie(t){I(new ve(t))}class ve{constructor(t){this.version="1.0.0",this.name=be,this.icon="data:image/png;base64,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",this._account=null,this._listeners={},this._adapter=new ke(t),this._adapter.on("connect",t=>{this._account={address:t.toBase58(),publicKey:t.toBytes(),chains:["solana:mainnet","solana:devnet","solana:testnet"],features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]},this._emit("change",{accounts:[this._account]})}),this._adapter.on("disconnect",()=>{this._account=null,this._emit("change",{accounts:[]})})}get accounts(){return this._account?[this._account]:[]}get chains(){return["solana:mainnet","solana:devnet","solana:testnet"]}get features(){return{"standard:connect":{version:"1.0.0",connect:async()=>(await this._adapter.connect(),{accounts:this.accounts})},"standard:disconnect":{version:"1.0.0",disconnect:async()=>{await this._adapter.disconnect()}},"standard:events":{version:"1.0.0",on:(t,e)=>(this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(e),()=>{this._listeners[t]=this._listeners[t]?.filter(t=>t!==e)||[]})},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:async(...t)=>{const e=[];for(const a of t){const t=c.deserialize(a.transaction),n=await this._adapter.sendTransaction(t);e.push({signature:m.decode(n)})}return e}},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:async(...t)=>{throw new Error("signTransaction not supported")}},"solana:signMessage":{version:"1.0.0",signMessage:async(...t)=>{const e=[];for(const a of t){const t=await this._adapter.signMessage(a.message);e.push({message:a.message,signature:t,signedMessage:a.message})}return e}}}}_emit(t,...e){this._listeners[t]?.forEach(t=>t(...e))}}export{W as API_ENDPOINTS,Ct as CHUNK_SEED,Y as CREDENTIAL_HASH_SIZE,P as DEFAULTS,E as DEFAULT_COMMITMENT,Se as DEFAULT_CONFIG,kt as DefaultPolicyClient,te as DialogManager,_ as EMPTY_PDA_RENT_EXEMPT_BALANCE,qt as LazorkitClient,oe as LazorkitProvider,ke as LazorkitWalletAdapter,be as LazorkitWalletName,R as Logger,Z as PASSKEY_PUBLIC_KEY_SIZE,T as Paymaster,X as SIGNATURE_SIZE,vt as SMART_WALLET_CONFIG_SEED,It as SMART_WALLET_SEED,B as STORAGE_KEYS,M as SmartWalletAction,U as StorageManager,we as StorageUtil,q as ValidationError,Dt as WALLET_DEVICE_SEED,L as asCredentialHash,F as asPasskeyPublicKey,j as asSignature,et as assertByteArrayLength,$ as assertDefined,ut as assertNonEmptyArray,at as assertNonEmptyByteArray,At as assertNonEmptyString,ct as assertPositiveBN,yt as assertPositiveInteger,dt as assertPositiveNumber,ht as assertValidBase64,it as assertValidCredentialHash,nt as assertValidPasskeyPublicKey,St as assertValidPasskeySignature,tt as assertValidPublicKey,ft as assertValidPublicKeyArray,ot as assertValidSignature,pt as assertValidTransactionInstruction,wt as assertValidTransactionInstructionArray,le as base64ToBytes,zt as buildCreateChunkMessage,Ot as buildExecuteMessage,Lt as buildPasskeyVerificationInstruction,Xt as buildTransaction,N as byteArrayEquals,Yt as calculateVerifyInstructionIndex,_t as combineInstructionsWithAuth,Zt as combineInstructionsWithAuthAndCU,Kt as computeMultipleCpiHashes,jt as convertPasskeySignatureToInstructionArgs,Jt as createComputeUnitLimitInstruction,O as credentialHashFromBase64,xt as deriveChunkPda,Wt as deriveSmartWalletConfigPda,Pt as deriveSmartWalletPda,Bt as deriveWalletDevicePda,ue as detectPlatform,V as ensureChunkExist,z as getBlockchainTimestamp,K as getRandomBytes,ce as importP256PublicKey,Q as instructionToAccountMetas,me as isAndroid,ge as isIOS,pe as isSafari,mt as normalizePublicKey,Gt as prependComputeUnitLimit,Ie as registerLazorkitWallet,gt as toNumberArray,bt as toNumberArraySafe,Ae as useWallet,se as useWalletStore,st as validateCredentialHash,rt as validatePasskeyPublicKey,lt as validateSignature,de as verifySignatureBrowser};
+import{jsx as t,Fragment as e}from"react/jsx-runtime";import{useEffect as a,useCallback as n}from"react";import{PublicKey as r,Transaction as i,Connection as s,AddressLookupTableAccount as o,TransactionInstruction as l,VersionedTransaction as c}from"@solana/web3.js";export{Connection,Keypair,PublicKey,Transaction,TransactionInstruction}from"@solana/web3.js";import{create as d}from"zustand";import*as A from"@coral-xyz/anchor";import{Buffer as u}from"buffer";import{sha256 as p}from"js-sha256";import m from"bs58";import{EventEmitter as g}from"eventemitter3";import{BaseWalletAdapter as h,WalletReadyState as y,WalletWindowClosedError as f,WalletDisconnectedError as w,WalletSignTransactionError as b}from"@solana/wallet-adapter-base";import{KoraClient as k}from"@solana/kora";import{registerWallet as S}from"@wallet-standard/wallet";function I(t,e){let a;try{a=t()}catch(t){return}return{getItem:t=>{var e;const n=t=>null===t?null:JSON.parse(t,void 0),r=null!=(e=a.getItem(t))?e:null;return r instanceof Promise?r.then(n):n(r)},setItem:(t,e)=>a.setItem(t,JSON.stringify(e,void 0)),removeItem:t=>a.removeItem(t)}}const v=t=>e=>{try{const a=t(e);return a instanceof Promise?a:{then:t=>v(t)(a),catch(t){return this}}}catch(t){return{then(t){return this},catch:e=>v(e)(t)}}},C=(t,e)=>(a,n,r)=>{let i={storage:I(()=>localStorage),partialize:t=>t,version:0,merge:(t,e)=>({...e,...t}),...e},s=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return t((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...t)},n,r);const d=()=>{const t=i.partialize({...n()});return c.setItem(i.name,{state:t,version:i.version})},A=r.setState;r.setState=(t,e)=>(A(t,e),d());const u=t((...t)=>(a(...t),d()),n,r);let p;r.getInitialState=()=>u;const m=()=>{var t,e;if(!c)return;s=!1,o.forEach(t=>{var e;return t(null!=(e=n())?e:u)});const r=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,null!=(t=n())?t:u))||void 0;return v(c.getItem.bind(c))(i.name).then(t=>{if(t){if("number"!=typeof t.version||t.version===i.version)return[!1,t.state];if(i.migrate){const e=i.migrate(t.state,t.version);return e instanceof Promise?e.then(t=>[!0,t]):[!0,e]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(t=>{var e;const[r,s]=t;if(p=i.merge(s,null!=(e=n())?e:u),a(p,!0),r)return d()}).then(()=>{null==r||r(p,void 0),p=n(),s=!0,l.forEach(t=>t(p))}).catch(t=>{null==r||r(void 0,t)})};return r.persist={setOptions:t=>{i={...i,...t},t.storage&&(c=t.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>s,onHydrate:t=>(o.add(t),()=>{o.delete(t)}),onFinishHydration:t=>(l.add(t),()=>{l.delete(t)})},i.skipHydration||m(),p||u},P={PORTAL_URL:"https://portal.lazor.sh",PAYMASTER_URL:"https://lazorkit-paymaster.onrender.com",RPC_ENDPOINT:"https://api.devnet.solana.com"},D={CONNECT:"connect",SIGN:"sign"},W="confirmed",E={WALLET:"lazorkit-wallet",CREDENTIALS:"lazorkit-credentials",PUBLIC_KEY:"PUBLIC_KEY",CREDENTIAL_ID:"CREDENTIAL_ID",SMART_WALLET_ADDRESS:"SMART_WALLET_ADDRESS"},B={getItem:async t=>{try{if("undefined"==typeof window)return null;return localStorage.getItem(t)}catch(e){return console.error("Error reading from localStorage:",e,{key:t}),null}},setItem:async(t,e)=>{try{if("undefined"==typeof window)return;localStorage.setItem(t,e)}catch(a){console.error("Error writing to localStorage:",a,{key:t,valueLength:e.length})}},removeItem:async t=>{try{if("undefined"==typeof window)return;localStorage.removeItem(t)}catch(e){console.error("Error removing from localStorage:",e,{key:t})}}};class x{static async saveWallet(t){try{await B.setItem(E.WALLET,JSON.stringify(t)),await B.setItem(E.CREDENTIAL_ID,t.credentialId),await B.setItem(E.SMART_WALLET_ADDRESS,t.smartWallet),await B.setItem(E.PUBLIC_KEY,u.from(t.passkeyPubkey).toString("base64"))}catch(t){throw console.error("Failed to save wallet to storage:",t),t}}static async getWallet(){try{const t=await B.getItem(E.WALLET);return t?JSON.parse(t):null}catch(t){return console.error("Failed to get wallet from storage:",t),null}}static async saveConfig(t){try{await B.setItem("lazorkit-config",JSON.stringify(t))}catch(t){throw console.error("Failed to save config to storage:",t),t}}static async getConfig(){try{const t=await B.getItem("lazorkit-config");return t?JSON.parse(t):null}catch(t){return console.error("Failed to get config from storage:",t),null}}static async clearWallet(){try{await B.removeItem(E.WALLET),await B.removeItem(E.CREDENTIAL_ID),await B.removeItem(E.SMART_WALLET_ADDRESS),await B.removeItem(E.PUBLIC_KEY),await B.removeItem("CREDENTIALS_TIMESTAMP")}catch(t){throw console.error("Failed to clear wallet from storage:",t),t}}static async getItem(t){return await B.getItem(t)}static async setItem(t,e){await B.setItem(t,e)}static async removeItem(t){await B.removeItem(t)}}class U{constructor(t){this.context=t,this.enabled="production"!==process.env.NODE_ENV}debug(t,e){this.enabled&&console.debug(`[${this.context}] ${t}`,e)}info(t,e){console.info(`[${this.context}] ${t}`,e)}warn(t,e){console.warn(`[${this.context}] ${t}`,e)}error(t,e){console.error(`[${this.context}] ${t}`,e)}}class R{constructor(t){this.logger=new U("Paymaster"),this.endpoint=t.paymasterUrl,this.apiKey=t.apiKey}getHeaders(){const t={"Content-Type":"application/json"};return this.apiKey&&(t["x-api-key"]=this.apiKey),t}async getPayer(){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getPayerSigner",params:[]})});if(!t.ok)throw new Error(`Failed to get payer: ${t.statusText}`);const e=await t.json();return new r(e.result.signer_address)}catch(t){throw this.logger.error("Failed to get payer",t),t}}async getBlockhash(){try{const t=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"getBlockhash",id:1,params:[]})});if(!t.ok)throw new Error(`Failed to get blockhash: ${t.statusText}`);return(await t.json()).result.blockhash}catch(t){throw this.logger.error("Failed to get blockhash",t),t}}async attemptSign(t,e=1){try{const e=t.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signTransaction",id:1,params:[e.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign transaction: ${a.statusText}`);const n=await a.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return i.from(u.from(n.result.signed_transaction,"base64"))}catch(t){throw this.logger.error(`Sign attempt ${e} failed:`,t),t}}async sign(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSign(t,n)}catch(t){if(n===e)throw this.logger.error("All sign retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying sign in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign transaction after all retries")}async attemptSignAndSend(t,e=1){try{const e=t.serialize({verifySignatures:!1,requireAllSignatures:!1}),a=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[e.toString("base64")]})});if(!a.ok)throw new Error(`Failed to sign and send transaction: ${a.statusText}`);const n=await a.json();if(n.error)throw new Error(n.error.message||"Unknown paymaster error");return n.result.signature}catch(t){throw this.logger.error(`Attempt ${e} failed:`,t),t}}async signAndSend(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSignAndSend(t,n)}catch(t){if(n===e)throw this.logger.error("All retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign and send transaction after all retries")}async attemptSignAndSendVersionedTransaction(t,e=1){try{const e=await fetch(`${this.endpoint}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({jsonrpc:"2.0",method:"signAndSendTransaction",id:1,params:[u.from(t.serialize()).toString("base64")]})});if(!e.ok)throw new Error(`Failed to sign and send transaction: ${e.statusText}`);const a=await e.json();if(a.error)throw new Error(a.error.message||"Unknown paymaster error");return a.result.signature}catch(t){throw this.logger.error(`Attempt ${e} failed:`,t),t}}async signAndSendVersionedTransaction(t,e=3,a=1e3){for(let n=1;n<=e;n++)try{return await this.attemptSignAndSendVersionedTransaction(t,n)}catch(t){if(n===e)throw this.logger.error("All retry attempts failed",t),t;const r=a*Math.pow(2,n-1);this.logger.info(`Retrying in ${r}ms (attempt ${n}/${e})`),await new Promise(t=>setTimeout(t,r))}throw new Error("Failed to sign and send transaction after all retries")}}var T,M={address:"Gsuz7YcA5sbMGVRXT3xSYhJBessW4xFC4xYsihNCqMFh",metadata:{name:"lazorkit",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},docs:["LazorKit: Smart Wallet with WebAuthn Passkey Authentication"],instructions:[{name:"close_chunk",discriminator:[150,183,213,198,0,74,14,170],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0}],args:[]},{name:"create_chunk",discriminator:[83,226,15,219,9,19,186,90],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"wallet_state.last_nonce",account:"WalletState"}]}},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateChunkArgs"}}}]},{name:"create_smart_wallet",discriminator:[129,39,235,18,132,68,203,19],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"arg",path:"args.wallet_id"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"policy_program"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"CreateSmartWalletArgs"}}}]},{name:"delete_smart_wallet",discriminator:[126,239,172,118,134,32,52,102],accounts:[{name:"payer",writable:!0,signer:!0,address:"BE8duRBDmh4cF4Ecz4TBCNgNAMCaonrpQiEiQ1xfQmab"},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"execute",discriminator:[130,221,242,154,13,193,189,29],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",writable:!0,pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"wallet_device"},{name:"policy_program"},{name:"cpi_program"},{name:"ix_sysvar",address:"Sysvar1nstructions1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"args",type:{defined:{name:"ExecuteArgs"}}}]},{name:"execute_chunk",discriminator:[106,83,113,47,89,243,39,220],accounts:[{name:"payer",writable:!0,signer:!0},{name:"smart_wallet",writable:!0,pda:{seeds:[{kind:"const",value:[115,109,97,114,116,95,119,97,108,108,101,116]},{kind:"account",path:"wallet_state.wallet_id",account:"WalletState"}]}},{name:"wallet_state",pda:{seeds:[{kind:"const",value:[119,97,108,108,101,116,95,115,116,97,116,101]},{kind:"account",path:"smart_wallet"}]}},{name:"chunk",writable:!0,pda:{seeds:[{kind:"const",value:[99,104,117,110,107]},{kind:"account",path:"smart_wallet"},{kind:"account",path:"chunk.authorized_nonce",account:"Chunk"}]}},{name:"session_refund",writable:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"instruction_data_list",type:{vec:"bytes"}},{name:"split_index",type:"bytes"}]}],accounts:[{name:"Chunk",discriminator:[134,67,80,65,135,143,156,196]},{name:"WalletDevice",discriminator:[35,85,31,31,179,48,136,123]},{name:"WalletState",discriminator:[126,186,0,158,92,223,167,68]}],errors:[{code:6e3,name:"PasskeyMismatch",msg:"Passkey public key mismatch with stored authenticator"},{code:6001,name:"InvalidPolicyDataSize",msg:"Invalid policy data size"},{code:6002,name:"Secp256r1InvalidLength",msg:"Secp256r1 instruction has invalid data length"},{code:6003,name:"Secp256r1HeaderMismatch",msg:"Secp256r1 instruction header validation failed"},{code:6004,name:"Secp256r1DataMismatch",msg:"Secp256r1 signature data validation failed"},{code:6005,name:"InvalidSignature",msg:"Invalid signature provided for passkey verification"},{code:6006,name:"ClientDataInvalidUtf8",msg:"Client data JSON is not valid UTF-8"},{code:6007,name:"ClientDataJsonParseError",msg:"Client data JSON parsing failed"},{code:6008,name:"ChallengeMissing",msg:"Challenge field missing from client data JSON"},{code:6009,name:"ChallengeBase64DecodeError",msg:"Challenge base64 decoding failed"},{code:6010,name:"ChallengeDeserializationError",msg:"Challenge message deserialization failed"},{code:6011,name:"HashMismatch",msg:"Message hash mismatch: expected different value"},{code:6012,name:"InvalidInstructionDiscriminator",msg:"Invalid instruction discriminator"},{code:6013,name:"InsufficientCpiAccounts",msg:"Insufficient remaining accounts for CPI instruction"},{code:6014,name:"AccountSliceOutOfBounds",msg:"Account slice index out of bounds"},{code:6015,name:"InvalidAccountOwner",msg:"Account owner verification failed"},{code:6016,name:"ProgramNotExecutable",msg:"Program not executable"},{code:6017,name:"CredentialIdEmpty",msg:"Credential ID cannot be empty"},{code:6018,name:"PolicyDataTooLarge",msg:"Policy data exceeds maximum allowed size"},{code:6019,name:"TransactionTooOld",msg:"Transaction is too old"},{code:6020,name:"InvalidInstructionData",msg:"Invalid instruction data"},{code:6021,name:"InvalidInstruction",msg:"Invalid instruction"},{code:6022,name:"InsufficientBalanceForFee",msg:"Insufficient balance for fee"},{code:6023,name:"InvalidSequenceNumber",msg:"Invalid sequence number"},{code:6024,name:"InvalidPasskeyFormat",msg:"Invalid passkey format"},{code:6025,name:"ReentrancyDetected",msg:"Reentrancy detected"},{code:6026,name:"UnauthorizedAdmin",msg:"Unauthorized admin"}],types:[{name:"Chunk",docs:["Transaction chunk for deferred execution","","Created after full passkey and policy verification. Contains all bindings","necessary to execute the transaction later without re-verification.","Used for large transactions that need to be split into manageable chunks."],type:{kind:"struct",fields:[{name:"owner_wallet_address",docs:["Smart wallet address that authorized this chunk session"],type:"pubkey"},{name:"cpi_hash",docs:["Combined SHA256 hash of all cpi transaction instruction data"],type:{array:["u8",32]}},{name:"authorized_nonce",docs:["The nonce that was authorized at chunk creation (bound into data hash)"],type:"u64"},{name:"authorized_timestamp",docs:["Timestamp from the original message hash for expiration validation"],type:"i64"},{name:"rent_refund_address",docs:["Address to receive rent refund when closing the chunk session"],type:"pubkey"}]}},{name:"CreateChunkArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"policy_data",type:"bytes"},{name:"timestamp",type:"i64"},{name:"cpi_hash",type:{array:["u8",32]}}]}},{name:"CreateSmartWalletArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"init_policy_data",type:"bytes"},{name:"wallet_id",type:"u64"},{name:"amount",type:"u64"},{name:"policy_data_size",type:"u16"}]}},{name:"ExecuteArgs",type:{kind:"struct",fields:[{name:"passkey_public_key",type:{array:["u8",33]}},{name:"signature",type:{array:["u8",64]}},{name:"client_data_json_raw",type:"bytes"},{name:"authenticator_data_raw",type:"bytes"},{name:"verify_instruction_index",type:"u8"},{name:"split_index",type:"u16"},{name:"policy_data",type:"bytes"},{name:"cpi_data",type:"bytes"},{name:"timestamp",type:"i64"}]}},{name:"WalletDevice",docs:["Wallet device account linking a passkey to a smart wallet"],type:{kind:"struct",fields:[{name:"passkey_pubkey",docs:["Secp256r1 compressed public key (33 bytes)"],type:{array:["u8",33]}},{name:"credential_hash",docs:["SHA256 hash of the credential ID"],type:{array:["u8",32]}},{name:"smart_wallet",docs:["Associated smart wallet address"],type:"pubkey"},{name:"bump",docs:["PDA bump seed"],type:"u8"}]}},{name:"WalletState",docs:["Wallet state account storing wallet configuration and execution state"],type:{kind:"struct",fields:[{name:"bump",docs:["PDA bump seed for smart wallet"],type:"u8"},{name:"wallet_id",docs:["Unique wallet identifier"],type:"u64"},{name:"last_nonce",docs:["Last used nonce for anti-replay protection"],type:"u64"},{name:"policy_program",docs:["Policy program that validates transactions"],type:"pubkey"},{name:"policy_data",docs:["Serialized policy data returned from policy initialization"],type:"bytes"}]}}]};function H(t,e){return t.keys.map(t=>({pubkey:t.pubkey,isWritable:t.isWritable,isSigner:!!e&&e.some(e=>e.toString()===t.pubkey.toString())}))}function Q(t){if("function"==typeof globalThis.crypto?.getRandomValues){const e=new Uint8Array(t);return globalThis.crypto.getRandomValues(e),e}try{const{randomBytes:e}=require("crypto");return e(t)}catch{throw new Error("No CSPRNG available")}}function N(t,e){if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0}function K(t){const e=u.from(t,"base64");return Array.from(new Uint8Array(p.arrayBuffer(e)))}async function O(t){const e=await t.getSlot(),a=await t.getBlockTime(e);return new A.BN(a||Math.floor(Date.now()/1e3))}function z(t){return t}function F(t){return t}function V(t){return t}!function(t){t.Execute="execute",t.CreateChunk="create_chunk",t.ExecuteChunk="execute_chunk"}(T||(T={}));var L={address:"BiE9vSdz9MidUiyjVYsu3PG4C1fbPZ8CVPADA9jRfXw7",metadata:{name:"default_policy",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},instructions:[{name:"check_policy",discriminator:[28,88,170,179,239,136,25,35],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet"}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}},{name:"policy_data",type:"bytes"}]},{name:"init_policy",discriminator:[45,234,110,100,209,146,191,86],accounts:[{name:"policy_signer",signer:!0},{name:"smart_wallet",writable:!0},{name:"wallet_state",writable:!0}],args:[{name:"wallet_id",type:"u64"},{name:"passkey_public_key",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}],returns:{defined:{name:"PolicyStruct"}}}],errors:[{code:6e3,name:"InvalidPasskey",msg:"Invalid passkey format"},{code:6001,name:"Unauthorized",msg:"Unauthorized to access smart wallet"}],types:[{name:"DeviceSlot",type:{kind:"struct",fields:[{name:"passkey_pubkey",type:{array:["u8",33]}},{name:"credential_hash",type:{array:["u8",32]}}]}},{name:"PolicyStruct",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"smart_wallet",type:"pubkey"},{name:"device_slots",type:{vec:{defined:{name:"DeviceSlot"}}}}]}}]};const j=u.from("policy");const _=890880,G=33,J=32,Z=64;class Y extends Error{constructor(t,e){super(t),this.field=e,this.name="ValidationError"}}function X(t,e){if(null==t||void 0===t){throw new Y(`${e} is required but was ${null===t?"null":"undefined"}`,e)}}function q(t,e){X(t,e);try{if("string"==typeof t){if(0===t.trim().length)throw new Y(`${e} cannot be an empty string`,e);new A.web3.PublicKey(t)}else{if(!(t instanceof A.web3.PublicKey||t&&"object"==typeof t&&"toBase58"in t&&"function"==typeof t.toBase58&&"toBytes"in t&&"function"==typeof t.toBytes))throw new Y(`${e} must be a PublicKey instance or valid base58 string`,e)}}catch(t){if(t instanceof Y)throw t;throw new Y(`${e} is not a valid PublicKey: ${t instanceof Error?t.message:"Invalid format"}`,e)}}function $(t,e,a){let n;if(X(t,a),Array.isArray(t))n=t;else if(t instanceof Uint8Array)n=Array.from(t);else{if(!t||"object"!=typeof t||"number"!=typeof t.length)throw new Y(`${a} must be an array or Uint8Array`,a);n=Array.from(t)}if(n.length!==e)throw new Y(`${a} must be exactly ${e} bytes, got ${n.length}`,a);for(let t=0;t<n.length;t++){const e=n[t];if("number"!=typeof e||!Number.isFinite(e)||!Number.isInteger(e)||e<0||e>255)throw new Y(`${a}[${t}] must be a valid byte (0-255), got ${"number"==typeof e?e:typeof e}`,a)}}function tt(t,e){X(t,e);if(0===(Array.isArray(t)?t:Array.from(t)).length)throw new Y(`${e} cannot be empty`,e)}function et(t,e="passkeyPublicKey"){$(t,33,e)}function at(t,e="passkeyPublicKey"){return et(t,e),Array.isArray(t)?t:Array.from(t)}function nt(t,e="credentialHash"){$(t,32,e)}function rt(t,e="credentialHash"){return nt(t,e),Array.isArray(t)?t:Array.from(t)}function it(t,e="signature"){$(t,64,e)}function st(t,e="signature"){return it(t,e),Array.isArray(t)?t:Array.from(t)}function ot(t,e){X(t,e);if(!(t instanceof A.BN||t&&"object"==typeof t&&"lt"in t&&"function"==typeof t.lt&&"toString"in t&&"function"==typeof t.toString))throw new Y(`${e} must be a BN instance`,e);if(t.lt(new A.BN(0)))throw new Y(`${e} must be non-negative, got ${t.toString()}`,e)}function lt(t,e){if(X(t,e),"number"!=typeof t||!Number.isFinite(t)||Number.isNaN(t))throw new Y(`${e} must be a finite number (got ${Number.isNaN(t)?"NaN":Number.isFinite(t)?typeof t:t===1/0?"Infinity":"-Infinity"})`,e);if(t<0)throw new Y(`${e} must be non-negative, got ${t}`,e)}function ct(t,e){if(X(t,e),"string"!=typeof t)throw new Y(`${e} must be a string (got ${typeof t})`,e);if(0===String(t).trim().length)throw new Y(`${e} cannot be empty`,e)}function dt(t,e){if(X(t,e),!Array.isArray(t))throw new Y(`${e} must be an array (got ${typeof t}${t&&"object"==typeof t?` with constructor ${t.constructor?.name||"unknown"}`:""})`,e);if(0===t.length)throw new Y(`${e} cannot be empty`,e)}function At(t,e){X(t,e);if(!(t instanceof A.web3.TransactionInstruction||t&&"object"==typeof t&&"programId"in t&&"keys"in t&&Array.isArray(t.keys)&&"data"in t))throw new Y(`${e} must be a TransactionInstruction instance`,e);if(q(t.programId,`${e}.programId`),!t.keys||!Array.isArray(t.keys)||0===t.keys.length)throw new Y(`${e} must have at least one account key`,e)}function ut(t){return Array.isArray(t)?t:Array.from(t)}function pt(t,e="publicKey"){return q(t,e),"string"==typeof t?new A.web3.PublicKey(t):t}function mt(t,e){ct(t,e);if(!/^[A-Za-z0-9+/]*={0,2}$/.test(t))throw new Y(`${e} is not a valid base64 string (invalid characters)`,e);try{"undefined"!=typeof Buffer&&Buffer.from?Buffer.from(t,"base64"):"undefined"!=typeof atob&&atob(t)}catch(t){throw new Y(`${e} is not a valid base64 string: ${t instanceof Error?t.message:"Invalid format"}`,e)}}function gt(t,e){if(X(t,e),"number"!=typeof t||!Number.isFinite(t)||Number.isNaN(t))throw new Y(`${e} must be a finite number (got ${Number.isNaN(t)?"NaN":Number.isFinite(t)?typeof t:t===1/0?"Infinity":"-Infinity"})`,e);if(!Number.isInteger(t))throw new Y(`${e} must be an integer, got ${t}`,e);if(t<=0)throw new Y(`${e} must be a positive integer, got ${t}`,e)}function ht(t,e){dt(t,e),t.forEach((t,a)=>{q(t,`${e}[${a}]`)})}function yt(t,e){dt(t,e),t.forEach((t,a)=>{At(t,`${e}[${a}]`)})}function ft(t){return Array.isArray(t)?[...t]:Array.from(t)}class wt{constructor(t){X(t,"connection"),this.connection=t,this.program=new A.Program(L,{connection:t}),this.programId=this.program.programId}policyPda(t){return q(t,"smartWallet"),function(t,e){return A.web3.PublicKey.findProgramAddressSync([j,e.toBuffer()],t)[0]}(this.programId,t)}getPolicyDataSize(){return 102}validateInitPolicyParams(t){X(t,"params"),ot(t.walletId,"params.walletId"),et(t.passkeyPublicKey,"params.passkeyPublicKey"),nt(t.credentialHash,"params.credentialHash"),q(t.policySigner,"params.policySigner"),q(t.smartWallet,"params.smartWallet"),q(t.walletState,"params.walletState")}async buildInitPolicyIx(t){return this.validateInitPolicyParams(t),await this.program.methods.initPolicy(t.walletId,ft(t.passkeyPublicKey),ft(t.credentialHash)).accountsPartial({smartWallet:t.smartWallet,walletState:t.walletState,policySigner:t.policySigner}).instruction()}validateCheckPolicyParams(t){if(X(t,"params"),ot(t.walletId,"params.walletId"),et(t.passkeyPublicKey,"params.passkeyPublicKey"),q(t.policySigner,"params.policySigner"),q(t.smartWallet,"params.smartWallet"),nt(t.credentialHash,"params.credentialHash"),X(t.policyData,"params.policyData"),!Buffer.isBuffer(t.policyData))throw new Y("params.policyData must be a Buffer instance","params.policyData")}async buildCheckPolicyIx(t){return this.validateCheckPolicyParams(t),await this.program.methods.checkPolicy(t.walletId,ft(t.passkeyPublicKey),ft(t.credentialHash),t.policyData).accountsPartial({smartWallet:t.smartWallet,policySigner:t.policySigner}).instruction()}}function bt(t,e){const a=u.concat([t.toBuffer(),u.from(e)]),n=p.arrayBuffer(a);return u.from(n).subarray(0,32)}const kt=32,St=new A.web3.PublicKey("Secp256r1SigVerify1111111111111111111111111"),It=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),vt=new Uint8Array([127,255,255,255,128,0,0,0,127,255,255,255,255,255,255,255,222,115,125,86,211,139,207,66,121,220,229,97,126,49,146,168]);function Ct(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);{const e=new ArrayBuffer(2*Object.values(t).length),a=new DataView(e);return Object.values(t).forEach((t,e)=>{a.setUint16(2*e,t,!0)}),new Uint8Array(e)}}function Pt(t,e,a){try{const n=a.slice(0,kt),r=a.slice(kt,64),i=u.alloc(kt,0),s=u.alloc(kt,0);if(n.copy(i,kt-n.length),r.copy(s,kt-r.length),function(t,e){if(t.length!==e.length)return t.length>e.length;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return t[a]>e[a];return!1}(s,vt)){const t=function(t,e){const a=new Uint8Array(t.length);let n=0;for(let r=t.length-1;r>=0;r--){let i=t[r]-e[r]-n;i<0?(i+=256,n=1):n=0,a[r]=i}return a}(It,s);a=u.concat([i,u.from(t)])}else a=u.concat([i,s]);if(33!==e.length||64!==a.length)throw new Error("Invalid key or signature length");const o=113+t.length,l=new Uint8Array(o),c=1,d=16,p=d+33,m=p+64;l.set(Ct([c,0]),0);const g={signature_offset:p,signature_instruction_index:65535,public_key_offset:d,public_key_instruction_index:65535,message_data_offset:m,message_data_size:t.length,message_instruction_index:65535};return l.set(Ct(g),2),l.set(e,d),l.set(a,p),l.set(t,m),new A.web3.TransactionInstruction({keys:[],programId:St,data:u.from(l)})}catch(t){throw new Error(`Failed to create secp256r1 instruction: ${t}`)}}const Dt=u.from("smart_wallet"),Wt=u.from("wallet_state"),Et=u.from("wallet_device"),Bt=u.from("chunk");function xt(t,e){return A.web3.PublicKey.findProgramAddressSync([Dt,e.toArrayLike(u,"le",8)],t)[0]}function Ut(t,e){return A.web3.PublicKey.findProgramAddressSync([Wt,e.toBuffer()],t)[0]}function Rt(t,e,a){return A.web3.PublicKey.findProgramAddressSync([Et,bt(e,a)],t)}function Tt(t,e,a){return A.web3.PublicKey.findProgramAddressSync([Bt,e.toBuffer(),a.toArrayLike(u,"le",8)],t)[0]}class Mt{constructor(t){this.programId=t}smartWallet(t){return ot(t,"walletId"),xt(this.programId,t)}walletState(t){return q(t,"smartWallet"),Ut(this.programId,t)}walletDevice(t,e){return q(t,"smartWallet"),nt(e,"credentialHash"),Rt(this.programId,t,e)[0]}chunk(t,e){return q(t,"smartWallet"),Tt(this.programId,t,e)}}class Ht{constructor(t,e){this.policyClient=t,this.walletPdas=e}async resolveForExecute({provided:t,smartWallet:e,credentialHash:a,passkeyPublicKey:n,walletStateData:r}){if(null!==t)return t;const i=this.walletPdas.walletDevice(e,a);return this.policyClient.buildCheckPolicyIx({walletId:r.walletId,passkeyPublicKey:n,policySigner:i,smartWallet:e,credentialHash:a,policyData:r.policyData})}async resolveForCreate({provided:t,smartWalletId:e,smartWallet:a,walletState:n,passkeyPublicKey:r,credentialHash:i}){if(null!=t)return t;const s=this.walletPdas.walletDevice(a,i);return this.policyClient.buildInitPolicyIx({walletId:e,passkeyPublicKey:r,credentialHash:i,policySigner:s,smartWallet:a,walletState:n})}}let Qt=null;const Nt=t=>new Uint8Array(p.arrayBuffer(t)),Kt=(t,e,a)=>{const n=p.create();n.update(t.toBytes());for(const t of e)n.update(t.pubkey.toBytes()),n.update(Uint8Array.from([t.isSigner?1:0])),n.update(Uint8Array.from([t.pubkey.toString()===a.toString()||t.isWritable?1:0]));return new Uint8Array(n.arrayBuffer())},Ot=(t,e)=>{const a=H(t),n=Kt(t.programId,a,e);return{policyDataHash:Nt(t.data),policyAccountsHash:n}},zt=(t,e,a)=>{const n=u.alloc(4);n.writeUInt32LE(t.length,0);const r=u.concat([n,...t.map(t=>{const e=u.from(t.data),a=u.alloc(4);return a.writeUInt32LE(e.length,0),u.concat([a,e])})]),i=Nt(r),s=((t,e)=>{const a=new Map;for(const e of t){const t=e.pubkey.toString(),n=a.get(t);n?(n.isSigner=n.isSigner||e.isSigner,n.isWritable=n.isWritable||e.isWritable):a.set(t,{isSigner:e.isSigner,isWritable:e.isWritable})}const n=t.map(t=>{const e=t.pubkey.toString(),n=a.get(e);return{pubkey:t.pubkey,isSigner:n.isSigner,isWritable:n.isWritable}}),r=p.create();for(const t of n)r.update(t.pubkey.toBytes()),r.update(Uint8Array.from([t.isSigner?1:0])),r.update(Uint8Array.from([t.pubkey.toString()===e.toString()||t.isWritable?1:0]));return new Uint8Array(r.arrayBuffer())})(t.flatMap(t=>[{pubkey:t.programId,isSigner:!1,isWritable:!1},...H(t,a)]),e);return{cpiDataHash:i,cpiAccountsHash:s}},Ft=(t,e)=>{try{const a=(Qt||(Qt=new A.BorshCoder({version:"0.1.0",name:"lazorkit_msgs",instructions:[],accounts:[],types:[{name:"SimpleMessage",type:{kind:"struct",fields:[{name:"dataHash",type:{array:["u8",32]}}]}}]})),Qt).types.encode(t,e);return u.from(a)}catch(e){throw new Error(`Failed to encode ${t}: ${e instanceof Error?e.message:"Unknown error"}`)}};function Vt(t,e,a,n,r,i){const s=Ot(n,t),o=((t,e,a)=>{const n=H(t,a),r=Kt(t.programId,n,e);return{cpiDataHash:Nt(t.data),cpiAccountsHash:r}})(r,t,i??[]),l=new Uint8Array(64);l.set(s.policyDataHash,0),l.set(s.policyAccountsHash,32);const c=Nt(l),d=new Uint8Array(64);d.set(o.cpiDataHash,0),d.set(o.cpiAccountsHash,32);const A=Nt(d),p=u.alloc(8);p.writeBigUInt64LE(BigInt(e.toString()),0);const m=u.alloc(8);m.writeBigInt64LE(BigInt(a.toString()),0);const g=u.concat([p,m,u.from(c),u.from(A)]),h=Nt(g);return Ft("SimpleMessage",{dataHash:Array.from(h)})}function Lt(t,e,a,n,r,i){const s=Ot(n,t),o=zt(r,t,i),l=new Uint8Array(64);l.set(s.policyDataHash,0),l.set(s.policyAccountsHash,32);const c=Nt(l),d=new Uint8Array(64);d.set(o.cpiDataHash,0),d.set(o.cpiAccountsHash,32);const A=Nt(d),p=u.alloc(8);p.writeBigUInt64LE(BigInt(e.toString()),0);const m=u.alloc(8);m.writeBigInt64LE(BigInt(a.toString()),0);const g=u.concat([p,m,u.from(c),u.from(A)]),h=Nt(g);return Ft("SimpleMessage",{dataHash:Array.from(h)})}function jt(t){et(t.passkeyPublicKey,"passkeySignature.passkeyPublicKey"),mt(t.signature64,"passkeySignature.signature64"),mt(t.clientDataJsonRaw64,"passkeySignature.clientDataJsonRaw64"),mt(t.authenticatorDataRaw64,"passkeySignature.authenticatorDataRaw64");const e=Buffer.from(t.authenticatorDataRaw64,"base64"),a=Buffer.from(t.clientDataJsonRaw64,"base64"),n=Buffer.from(t.signature64,"base64");it(ut(n),"passkeySignature.signature64 (decoded)");const r=Buffer.concat([e,Buffer.from(p.arrayBuffer(a))]);return Pt(Buffer.from(p.arrayBuffer(r)),t.passkeyPublicKey,n)}function _t(t){const e=Buffer.from(t.signature64,"base64");return it(ut(e),"passkeySignature.signature64 (decoded)"),{passkeyPublicKey:t.passkeyPublicKey,signature:ut(e),clientDataJsonRaw:Buffer.from(t.clientDataJsonRaw64,"base64"),authenticatorDataRaw:Buffer.from(t.authenticatorDataRaw64,"base64")}}function Gt(t){return A.web3.ComputeBudgetProgram.setComputeUnitLimit({units:t})}function Jt(t,e){return void 0===e?t:[Gt(e),...t]}function Zt(t,e){return[t,...e]}function Yt(t,e,a){return Jt([t,...e],a)}function Xt(t){return void 0!==t?1:0}async function qt(t,e,a,n={}){const{addressLookupTables:r,recentBlockhash:i,computeUnitLimit:s}=n,o=Jt(a,s),l=r||[],c=i||(await t.getLatestBlockhash()).blockhash;if(l.length>0){console.log("lookupTables in buildTransaction",l);const t=new A.web3.TransactionMessage({payerKey:e,recentBlockhash:c,instructions:o}).compileToV0Message(l);return{transaction:new A.web3.VersionedTransaction(t),isVersioned:!0,recentBlockhash:c}}{const t=(new A.web3.Transaction).add(...o);return t.feePayer=e,t.recentBlockhash=c,{transaction:t,isVersioned:!1,recentBlockhash:c}}}"undefined"!=typeof globalThis&&(globalThis.Buffer=u),u.prototype.subarray=function(t,e){const a=Uint8Array.prototype.subarray.apply(this,[t,e]);return Object.setPrototypeOf(a,u.prototype),a};class $t{constructor(t){this.connection=t,this.program=new A.Program(M,{connection:t}),this.programId=this.program.programId,this.defaultPolicyProgram=new wt(t),this.walletPdas=new Mt(this.programId),this.policyResolver=new Ht(this.defaultPolicyProgram,this.walletPdas)}getSmartWalletPubkey(t){return this.walletPdas.smartWallet(t)}getWalletStatePubkey(t){return this.walletPdas.walletState(t)}getWalletDevicePubkey(t,e){return this.walletPdas.walletDevice(t,e)}getChunkPubkey(t,e){return this.walletPdas.chunk(t,e)}generateWalletId(){return new A.BN(Q(8),"le")}async fetchWalletStateContext(t){const e=this.getWalletStatePubkey(t);return{walletState:e,data:await this.program.account.walletState.fetch(e)}}async fetchChunkContext(t,e){const a=this.getChunkPubkey(t,e);return{chunk:a,data:await this.program.account.chunk.fetch(a)}}validateCreateSmartWalletParams(t){X(t,"params"),q(t.payer,"params.payer"),et(t.passkeyPublicKey,"params.passkeyPublicKey"),mt(t.credentialIdBase64,"params.credentialIdBase64"),void 0!==t.amount&&ot(t.amount,"params.amount"),void 0!==t.smartWalletId&&ot(t.smartWalletId,"params.smartWalletId"),void 0!==t.policyDataSize&&gt(t.policyDataSize,"params.policyDataSize"),null!==t.policyInstruction&&void 0!==t.policyInstruction&&At(t.policyInstruction,"params.policyInstruction")}validateExecuteParams(t){X(t,"params"),q(t.payer,"params.payer"),q(t.smartWallet,"params.smartWallet"),nt(t.credentialHash,"params.credentialHash"),At(t.cpiInstruction,"params.cpiInstruction"),ot(t.timestamp,"params.timestamp"),null!==t.policyInstruction&&At(t.policyInstruction,"params.policyInstruction")}validateCreateChunkParams(t){X(t,"params"),q(t.payer,"params.payer"),q(t.smartWallet,"params.smartWallet"),nt(t.credentialHash,"params.credentialHash"),yt(t.cpiInstructions,"params.cpiInstructions"),ot(t.timestamp,"params.timestamp"),null!==t.policyInstruction&&At(t.policyInstruction,"params.policyInstruction"),void 0!==t.cpiSigners&&ht(t.cpiSigners,"params.cpiSigners")}validateExecuteChunkParams(t){X(t,"params"),q(t.payer,"params.payer"),q(t.smartWallet,"params.smartWallet"),yt(t.cpiInstructions,"params.cpiInstructions"),void 0!==t.cpiSigners&&ht(t.cpiSigners,"params.cpiSigners")}validateCloseChunkParams(t){X(t,"params"),q(t.payer,"params.payer"),q(t.smartWallet,"params.smartWallet"),ot(t.nonce,"params.nonce")}async getWalletStateData(t){const{data:e}=await this.fetchWalletStateContext(t);return e}async getChunkData(t){return await this.program.account.chunk.fetch(t)}async getSmartWalletByPasskey(t){et(t,"passkeyPublicKey");const e=M.accounts?.find(t=>"WalletState"===t.name)?.discriminator;if(!e)throw new Y("WalletState discriminator not found in IDL","passkeyPublicKey");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:m.encode(e)}}]});for(const e of a)try{const a=this.program.coder.accounts.decode("WalletState",e.account.data);for(const n of a.devices)if(N(n.passkeyPubkey,t)){return{smartWallet:this.getSmartWalletPubkey(a.walletId),walletState:e.pubkey,deviceSlot:{passkeyPubkey:n.passkeyPubkey,credentialHash:n.credentialHash}}}}catch(t){continue}return{smartWallet:null,walletState:null,deviceSlot:null}}async getSmartWalletByCredentialHash(t){nt(t,"credentialHash");const e=M.accounts?.find(t=>"WalletDevice"===t.name)?.discriminator;if(!e)throw new Y("WalletDevice discriminator not found in IDL","credentialHash");const a=await this.connection.getProgramAccounts(this.programId,{filters:[{memcmp:{offset:0,bytes:m.encode(e)}},{memcmp:{offset:41,bytes:m.encode(t)}}]});if(0===a.length)return null;for(const t of a){const e=await this.program.account.walletDevice.fetch(t.pubkey);return{smartWallet:e.smartWallet,walletState:this.getWalletStatePubkey(e.smartWallet),walletDevice:t.pubkey,passkeyPubkey:e.passkeyPubkey}}return null}async buildCreateSmartWalletIns(t,e,a,n){return q(t,"payer"),q(e,"smartWallet"),At(a,"policyInstruction"),X(n,"args"),et(n.passkeyPublicKey,"args.passkeyPublicKey"),nt(n.credentialHash,"args.credentialHash"),ot(n.walletId,"args.walletId"),ot(n.amount,"args.amount"),await this.program.methods.createSmartWallet(n).accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),walletDevice:this.getWalletDevicePubkey(e,n.credentialHash),policyProgram:a.programId,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...H(a)]).instruction()}async buildExecuteIns(t,e,a,n,r,i,s){return q(t,"payer"),q(e,"smartWallet"),q(a,"walletDevice"),X(n,"args"),At(r,"policyInstruction"),At(i,"cpiInstruction"),void 0!==s&&ht(s,"cpiSigners"),await this.program.methods.execute(n).accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),walletDevice:a,policyProgram:r.programId,cpiProgram:i.programId,ixSysvar:A.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...H(r),...H(i,s)]).instruction()}async buildCreateChunkIns(t,e,a,n,r){q(t,"payer"),q(e,"smartWallet"),q(a,"walletDevice"),X(n,"args"),At(r,"policyInstruction");const{walletState:i,data:s}=await this.fetchWalletStateContext(e),o=this.getChunkPubkey(e,s.lastNonce);return await this.program.methods.createChunk(n).accountsPartial({payer:t,smartWallet:e,walletState:i,walletDevice:a,policyProgram:r.programId,chunk:o,ixSysvar:A.web3.SYSVAR_INSTRUCTIONS_PUBKEY,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts([...H(r)]).instruction()}async buildExecuteChunkIns(t,e,a,n){q(t,"payer"),q(e,"smartWallet"),yt(a,"cpiInstructions"),void 0!==n&&ht(n,"cpiSigners");const{data:r}=await this.fetchWalletStateContext(e),i=r.lastNonce.sub(new A.BN(1)),{chunk:s,data:o}=await this.fetchChunkContext(e,i),l=a.map(t=>u.from(t.data)),c=function(t){const e=[];let a=0;for(let n=0;n<t.length-1;n++)a+=t[n].keys.length+1,e.push(a);return e}(a),d=function(t,e){return t.flatMap(t=>[{pubkey:t.programId,isSigner:!1,isWritable:!1},...H(t,e)])}(a,n);return await this.program.methods.executeChunk(l,u.from(c)).accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),chunk:s,sessionRefund:o.rentRefundAddress,systemProgram:A.web3.SystemProgram.programId}).remainingAccounts(d).instruction()}async buildCloseChunkIns(t,e,a){q(t,"payer"),q(e,"smartWallet"),ot(a,"nonce");const{chunk:n,data:r}=await this.fetchChunkContext(e,a);return await this.program.methods.closeChunk().accountsPartial({payer:t,smartWallet:e,walletState:this.getWalletStatePubkey(e),chunk:n,sessionRefund:r.rentRefundAddress}).instruction()}async createSmartWalletTxn(t,e={}){this.validateCreateSmartWalletParams(t);const a=t.smartWalletId??this.generateWalletId(),n=this.getSmartWalletPubkey(a),r=this.getWalletStatePubkey(n),i=t.amount??new A.BN(_),s=t.policyDataSize??this.defaultPolicyProgram.getPolicyDataSize(),o=K(t.credentialIdBase64),l=await this.policyResolver.resolveForCreate({provided:t.policyInstruction,smartWalletId:a,smartWallet:n,walletState:r,passkeyPublicKey:t.passkeyPublicKey,credentialHash:o}),c={passkeyPublicKey:t.passkeyPublicKey,credentialHash:o,initPolicyData:l.data,walletId:a,amount:i,policyDataSize:s},d=await this.buildCreateSmartWalletIns(t.payer,n,l,c);return{transaction:(await qt(this.connection,t.payer,[d],e)).transaction,smartWalletId:a,smartWallet:n}}async executeTxn(t,e={}){this.validateExecuteParams(t);const a=jt(t.passkeySignature),n=await this.getWalletStateData(t.smartWallet),r=this.getWalletDevicePubkey(t.smartWallet,t.credentialHash),i=await this.policyResolver.resolveForExecute({provided:t.policyInstruction,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:t.passkeySignature.passkeyPublicKey,walletStateData:n}),s=_t(t.passkeySignature),o=Zt(a,[await this.buildExecuteIns(t.payer,t.smartWallet,r,{...s,verifyInstructionIndex:Xt(e.computeUnitLimit),splitIndex:i.keys.length,policyData:i.data,cpiData:t.cpiInstruction.data,timestamp:t.timestamp},i,t.cpiInstruction,[...t.cpiSigners??[],t.payer])]);return(await qt(this.connection,t.payer,o,e)).transaction}async createChunkTxn(t,e={}){this.validateCreateChunkParams(t);const a=jt(t.passkeySignature),n=await this.getWalletStateData(t.smartWallet),r=this.getWalletDevicePubkey(t.smartWallet,t.credentialHash),i=await this.policyResolver.resolveForExecute({provided:t.policyInstruction,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:t.passkeySignature.passkeyPublicKey,walletStateData:n}),s=_t(t.passkeySignature),o=function(t,e,a){const n=zt(t,e,a),r=new Uint8Array(64);return r.set(n.cpiDataHash,0),r.set(n.cpiAccountsHash,32),Array.from(new Uint8Array(p.arrayBuffer(r)))}(t.cpiInstructions,t.smartWallet,[...t.cpiSigners??[],t.payer]),l=Zt(a,[await this.buildCreateChunkIns(t.payer,t.smartWallet,r,{...s,policyData:i.data,verifyInstructionIndex:Xt(e.computeUnitLimit),timestamp:t.timestamp,cpiHash:Array.from(o)},i)]);return(await qt(this.connection,t.payer,l,e)).transaction}async executeChunkTxn(t,e={}){this.validateExecuteChunkParams(t);const a=await this.buildExecuteChunkIns(t.payer,t.smartWallet,t.cpiInstructions,t.cpiSigners);return(await qt(this.connection,t.payer,[a],e)).transaction}async closeChunkTxn(t,e={}){this.validateCloseChunkParams(t);const a=await this.buildCloseChunkIns(t.payer,t.smartWallet,t.nonce);return(await qt(this.connection,t.payer,[a],e)).transaction}async buildAuthorizationMessage(t){let e;const{action:a,smartWallet:n,passkeyPublicKey:r,credentialHash:i,timestamp:s}=t;switch(a.type){case T.Execute:{const{policyInstruction:i,cpiInstruction:o,cpiSigners:l}=a.args,c=await this.getWalletStateData(t.smartWallet),d=await this.policyResolver.resolveForExecute({provided:i,smartWallet:t.smartWallet,credentialHash:t.credentialHash,passkeyPublicKey:r,walletStateData:c});e=Vt(n,(await this.getWalletStateData(n)).lastNonce,s,d,o,[...l??[],t.payer]);break}case T.CreateChunk:{const{policyInstruction:o,cpiInstructions:l,cpiSigners:c}=a.args,d=await this.getWalletStateData(n);if(o)e=Lt(n,d.lastNonce,s,o,l,[...c??[],t.payer]);else{const a=this.getWalletDevicePubkey(n,i),o=await this.defaultPolicyProgram.buildCheckPolicyIx({walletId:d.walletId,passkeyPublicKey:r,policySigner:a,smartWallet:n,credentialHash:i,policyData:d.policyData});e=Lt(n,d.lastNonce,s,o,l,[...c??[],t.payer])}break}default:throw new Y(`Unsupported SmartWalletAction: ${a.type}`,"action.type")}return e}}"function"!=typeof globalThis.structuredClone&&(globalThis.structuredClone=t=>JSON.parse(JSON.stringify(t)));class te extends g{constructor(){super(),this.iframeRef=null,this.retryDelays=[200,400,800,1500,3e3]}setIframeRef(t){this.iframeRef=t}notifyCredentialsUpdated(t){this.emit("credentials-updated",t);const e=new CustomEvent("lazorkit:credentials-updated",{detail:t,bubbles:!0,cancelable:!0});window.dispatchEvent(e)}syncCredentials(t=!1){this.iframeRef&&this.iframeRef.contentWindow?this.performCredentialSync(t):setTimeout(()=>this.syncCredentials(t),500)}performCredentialSync(t){if(!this.iframeRef?.contentWindow)throw new Error("Cannot sync credentials: iframe reference not available");const e=localStorage.getItem("CREDENTIAL_ID")||"",a=localStorage.getItem("PUBLIC_KEY")||"",n=localStorage.getItem("SMART_WALLET_ADDRESS")||"";if(!(t||e&&a))return;const r={type:"SYNC_CREDENTIALS",data:{credentialId:e,publickey:a,smartWalletAddress:n,timestamp:Date.now()}};try{this.iframeRef.contentWindow.postMessage(r,"*"),this.retryDelays.forEach(t=>{setTimeout(()=>{try{this.iframeRef?.contentWindow&&this.iframeRef.contentWindow.postMessage(r,"*")}catch(t){}},t)})}catch(t){}}storeCredential(t){t.credentialId&&localStorage.setItem("CREDENTIAL_ID",t.credentialId),t.publickey&&localStorage.setItem("PUBLIC_KEY",t.publickey),t.smartWalletAddress&&localStorage.setItem("SMART_WALLET_ADDRESS",t.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",(new Date).toISOString())}destroy(){this.removeAllListeners(),this.iframeRef=null}}class ee extends g{constructor(t){super(),this.dialogRef=null,this.iframeRef=null,this.popupWindow=null,this.popupCloseInterval=null,this.isClosing=!1,this.isDestroyed=!1,this.logger=new U("DialogManager"),this._currentAction=null,this.config=t,this.credentialManager=new te,this.logger.debug("Created dialog manager"),this.setupMessageListener()}async openConnect(){return new Promise((t,e)=>{const a=()=>{this.off("connect-result",n),this.off("error",r)},n=e=>{a(),t(e)},r=t=>{a(),e(t)};this.on("connect-result",n),this.on("error",r);const i=setTimeout(()=>{a(),e(new Error("Connection timed out after 60 seconds"))},6e4),s=t,o=e;t=t=>{clearTimeout(i),s(t)},e=t=>{clearTimeout(i),o(t)},this._currentAction=D.CONNECT;if(this.shouldUsePopup("connect")){const t=`${this.config.portalUrl}?action=${D.CONNECT}`;this.openPopup(t).catch(e)}else this.openConnectDialog().catch(e)})}async openSign(t,e,a,n){return new Promise((r,i)=>{const s=()=>{this.off("sign-result",o),this.off("error",l)},o=t=>{s(),r(t)},l=t=>{s(),i(t)};this.on("sign-result",o),this.on("error",l);const c=setTimeout(()=>{s(),i(new Error("Signing timed out after 60 seconds"))},6e4),d=r,A=i;r=t=>{clearTimeout(c),d(t)},i=t=>{clearTimeout(c),A(t)},this._currentAction=D.SIGN;const u=this.shouldUsePopup("sign"),p=encodeURIComponent(t);let m=`${this.config.portalUrl}?action=${D.SIGN}&message=${p}&transaction=${encodeURIComponent(e)}&credentialId=${encodeURIComponent(a)}`;n&&(m+=`&clusterSimulation=${n}`),u?this.openPopup(m).catch(i):this.openSignDialog(m).catch(i)})}async openSignMessage(t,e){return new Promise((a,n)=>{const r=()=>{this.off("sign-result",i),this.off("error",s)},i=t=>{r(),a(t)},s=t=>{r(),n(t)};this.on("sign-result",i),this.on("error",s);const o=setTimeout(()=>{r(),n(new Error("Signing timed out after 60 seconds"))},6e4),l=a,c=n;a=t=>{clearTimeout(o),l(t)},n=t=>{clearTimeout(o),c(t)},this._currentAction=D.SIGN;const d=encodeURIComponent(t),A=`${this.config.portalUrl}?action=${D.SIGN}&message=${d}&credentialId=${encodeURIComponent(e)}`;this.shouldUsePopup("sign")?this.openPopup(A).catch(n):this.openSignDialog(A).catch(n)})}async openConnectDialog(){const t=`${this.config.portalUrl}?action=${D.CONNECT}`;await this.openModal(t)}ensureFonts(){const t="lazorkit-font-roboto-flex";if(document.getElementById(t))return;const e=document.createElement("link");e.id=t,e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&display=swap",document.head.appendChild(e)}ensureDialogBackdropCSS(){const t="lazorkit-dialog-backdrop-style";if(document.getElementById(t))return;const e=document.createElement("style");e.id=t,e.textContent='\n    /* ===== Backdrop (overlay nh) ===== */\n    dialog#lazorkit-dialog::backdrop {\n      background: rgba(0,0,0,0);\n      animation: lazor-backdrop-in 160ms ease-out forwards;\n    }\n\n    dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n      animation: lazor-backdrop-out 140ms ease-in forwards;\n    }\n\n    @keyframes lazor-backdrop-in {\n      from { background: rgba(0,0,0,0); }\n      to   { background: rgba(0,0,0,0.12); } /*  overlay nh */\n    }\n\n    @keyframes lazor-backdrop-out {\n      from { background: rgba(0,0,0,0.12); }\n      to   { background: rgba(0,0,0,0); }\n    }\n\n    /* ===== Panel animations ===== */\n    @keyframes lazor-drawer-in {\n      from { transform: translateY(16px); opacity: 0.98; }\n      to   { transform: translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-drawer-out {\n      from { transform: translateY(0); opacity: 1; }\n      to   { transform: translateY(16px); opacity: 0.98; }\n    }\n\n    @keyframes lazor-float-in {\n      from { transform: scale(0.985) translateY(4px); opacity: 0; }\n      to   { transform: scale(1) translateY(0); opacity: 1; }\n    }\n\n    @keyframes lazor-float-out {\n      from { transform: scale(1) translateY(0); opacity: 1; }\n      to   { transform: scale(0.985) translateY(4px); opacity: 0; }\n    }\n\n    #lazorkit-panel {\n      will-change: transform, opacity;\n      transform-origin: center;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-drawer-in 180ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="drawer"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-drawer-out 150ms ease-in forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="opening"] #lazorkit-panel {\n      animation: lazor-float-in 170ms cubic-bezier(.2,.9,.2,1) forwards;\n    }\n\n    dialog#lazorkit-dialog[data-variant="floating"][data-state="closing"] #lazorkit-panel {\n      animation: lazor-float-out 140ms ease-in forwards;\n    }\n\n    /* ===== Reduced motion ===== */\n    @media (prefers-reduced-motion: reduce) {\n      dialog#lazorkit-dialog::backdrop {\n        animation: none !important;\n        background: rgba(0,0,0,0.12) !important;\n      }\n      dialog#lazorkit-dialog[data-state="closing"]::backdrop {\n        background: rgba(0,0,0,0) !important;\n      }\n      dialog#lazorkit-dialog #lazorkit-panel {\n        animation: none !important;\n      }\n    }\n  ',document.head.appendChild(e)}createCloseButton(t){const e=document.createElement("button");return e.type="button",e.title="Close Dialog",e.setAttribute("aria-label","Close Dialog"),Object.assign(e.style,{width:"36px",height:"36px",borderRadius:"10px",border:"none",background:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0",color:"rgba(255, 255, 255, 0.6)",outline:"none",webkitTapHighlightColor:"transparent"}),e.addEventListener("mouseenter",()=>{e.style.background="rgba(255,255,255,0.1)",e.style.color="#ffffff"}),e.addEventListener("mouseleave",()=>{e.style.background="transparent",e.style.color="rgba(255, 255, 255, 0.6)"}),e.onclick=t,e.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg"\n      width="20" height="20" viewBox="0 0 24 24"\n      fill="none" stroke="currentColor" stroke-width="2"\n      stroke-linecap="round" stroke-linejoin="round">\n      <line x1="18" y1="6" x2="6" y2="18" />\n      <line x1="6" y1="6" x2="18" y2="18" />\n    </svg>\n  ',e}async openSignDialog(t){await this.openModal(t),this.iframeRef&&(this.credentialManager.setIframeRef(this.iframeRef),setTimeout(()=>{this.credentialManager.syncCredentials(!0)},500))}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}shouldUsePopup(t){const e=this.isMobileDevice();return!(!this.isSafari()||"connect"!==t)||(!(!e||"connect"!==t)||!(!e&&"sign"===t)&&(!e||"sign"!==t))}getPopupDimensions(){if(!window.top)return{width:450,height:600,top:0,left:0};const t=window.top.outerWidth/2+window.top.screenX-225;return{width:450,height:600,top:window.top.outerHeight/2+window.top.screenY-300,left:t}}async openPopup(t){if(this.popupWindow&&!this.popupWindow.closed)try{this.popupWindow.close()}catch(t){}const e=this.getPopupDimensions();if(this.popupWindow=window.open(t,"lazorkit-popup",`width=${e.width},height=${e.height},top=${e.top},left=${e.left},resizable,scrollbars,status`),this.startPopupMonitor(),!this.popupWindow)throw this.logger.error("Popup was blocked by browser"),new Error("Popup was blocked by browser")}startPopupMonitor(){this.popupCloseInterval&&clearInterval(this.popupCloseInterval),this.popupCloseInterval=setInterval(()=>{this.popupWindow?.closed&&(this.popupWindow=null,this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null))},500)}async openModal(t){this.dialogRef||this.createModal(),this.iframeRef&&(this.iframeRef.src=t),this.dialogRef&&!this.dialogRef.open&&(this.dialogRef.setAttribute("data-state","opening"),this.dialogRef.showModal(),window.setTimeout(()=>{this.dialogRef?.open&&this.dialogRef.setAttribute("data-state","idle")},220))}createModal(){this.ensureFonts(),this.ensureDialogBackdropCSS();const t=document.createElement("dialog");t.id="lazorkit-dialog",t.style.colorScheme="dark",t.setAttribute("data-theme","dark");const e=this.isMobileDevice(),a=(t=>({overlay:{position:"fixed",inset:0,padding:0,border:"none",background:"transparent",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",overflow:"visible",zIndex:2147483647,display:"grid",placeItems:t?"end center":"center"},panel:{width:t?"100%":"360px",maxWidth:t?"100%":"90vw",height:t?"55vh":"650px",maxHeight:t?"55vh":"90vh",background:"white",borderRadius:t?"20px 20px 0 0":"20px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",position:"relative"},closeButton:{zIndex:10},iframeContainer:{position:"relative",width:"100%",height:"100%",border:"none",margin:0,padding:0,overflow:"hidden",borderRadius:"inherit",background:"white"},iframe:{width:"100%",height:"100%",border:0,borderRadius:"inherit",display:"block"}}))(e);Object.assign(t.style,a.overlay),Object.assign(t.style,{"--background-color-th_base":"#191919","--background-color-th_frame":"#191919","--text-color-th_base":"#eeeeee","--border-color-th_frame":"rgba(255,255,255,0.10)"});const n=document.createElement("div"),r=e?"drawer":"floating";t.setAttribute("data-variant",r),t.setAttribute("data-state","idle"),n.id="lazorkit-panel",Object.assign(n.style,a.panel),Object.assign(n.style,{display:"flex",flexDirection:"column"}),Object.assign(n.style,{background:"var(--background-color-th_base, #fcfcfc)",color:"var(--text-color-th_base, #202020)",fontFamily:'"Roboto Flex", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'});const i=document.createElement("div");Object.assign(i.style,{height:"32px",flex:"0 0 auto",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 12px",boxSizing:"border-box",borderBottom:"1px solid rgba(0,0,0,0.08)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, var(--background-color-th_base, #fcfcfc))",color:"var(--text-color-th_base, #202020)",borderBottom:"1px solid var(--border-color-th_frame, rgba(0,0,0,0.08))"});const s=document.createElement("div");Object.assign(s.style,a.iframeContainer),Object.assign(s.style,{flex:"1 1 auto"}),Object.assign(s.style,{background:"var(--background-color-th_base, #fcfcfc)"}),Object.assign(n.style,{background:"var(--background-color-th_base, #191919)",color:"var(--text-color-th_base, #eeeeee)"}),Object.assign(i.style,{background:"var(--background-color-th_frame, #191919)",color:"var(--text-color-th_base, #eeeeee)",borderBottom:"1px solid var(--border-color-th_frame, rgba(255,255,255,0.10))"}),Object.assign(s.style,{background:"var(--background-color-th_base, #191919)"});const o=this.createCloseButton(()=>{this.closeDialog(),this.emit("close")});Object.assign(o.style,{position:"static",top:"",right:""}),o.id="lazorkit-dialog-close",o.ariaLabel="Close",Object.assign(o.style,a.closeButton);const l=document.createElement("iframe");l.id="lazorkit-iframe",Object.assign(l.style,a.iframe),l.allow=`publickey-credentials-get ${this.config.portalUrl}; publickey-credentials-create ${this.config.portalUrl}; clipboard-write; camera; microphone`;const c=l.sandbox;c.add("allow-forms"),c.add("allow-scripts"),c.add("allow-same-origin"),c.add("allow-popups"),c.add("allow-popups-to-escape-sandbox"),c.add("allow-modals"),l.setAttribute("aria-label","Lazor Wallet"),l.tabIndex=0,l.title="Lazor",t.addEventListener("cancel",()=>this.closeDialog()),t.addEventListener("click",e=>{e.target===t&&this.closeDialog()}),i.appendChild(o),n.appendChild(i),s.appendChild(l),n.appendChild(s),t.appendChild(n),document.body.appendChild(t),this.dialogRef=t,this.iframeRef=l}setupMessageListener(){window.addEventListener("message",t=>{if(!t.origin.includes(new URL(this.config.portalUrl).hostname))return;const{type:e,data:a,error:n}=t.data;if(n)this.emit("error",new Error(n.message||"Portal error"));else switch(e){case"connect-result":case"WALLET_CONNECTED":const t={publicKey:a.publickey||a.publicKey||"",credentialId:a.credentialId,isCreated:"create"===a.connectionType||!!a.publickey,connectionType:a.connectionType||(a.publickey?"create":"get"),timestamp:a.timestamp||Date.now(),accountName:a.accountName};this.emit("connect-result",t),this.closeDialog();break;case"sign-result":case"SIGNATURE_CREATED":const e={signature:a.normalized,clientDataJsonBase64:a.clientDataJSONReturn,authenticatorDataBase64:a.authenticatorDataReturn,signedPayload:a.msg};this.emit("sign-result",e),this.closeDialog();break;case"error":this.emit("error",new Error(a?.message||"Unknown portal error"));break;case"close":this.closeDialog()}})}closeDialog(){if(this.isClosing)return;this.isClosing=!0;const t=this.dialogRef,e=this.iframeRef;try{t&&t.setAttribute("data-state","closing"),window.setTimeout(()=>{try{if(e&&(e.parentNode&&e.parentNode.removeChild(e),this.iframeRef=null),t){try{t.open&&t.close()}catch{}t.parentNode&&t.parentNode.removeChild(t),this.dialogRef=null}if(this.popupWindow){try{this.popupWindow.close()}catch{}this.popupWindow=null}this.popupCloseInterval&&(clearInterval(this.popupCloseInterval),this.popupCloseInterval=null),this.logger.debug("Closed dialog (animated)")}catch(t){this.logger.error("Error during animated close:",t)}finally{this.isClosing=!1}},170)}catch(t){this.logger.error("Error closing dialog:",t),this.isClosing=!1}}getIframeRef(){return this.iframeRef}getDialogRef(){return this.dialogRef}getPopupWindow(){return this.popupWindow}getCurrentAction(){return this._currentAction}destroy(){this.isDestroyed||(this.isDestroyed=!0,this.closeDialog(),this.credentialManager.destroy(),this.removeAllListeners(),this.logger.debug("Destroyed dialog manager"))}}const ae=t=>new ee({portalUrl:t.portalUrl,rpcUrl:t.rpcUrl,paymasterUrl:t.paymasterConfig.paymasterUrl}),ne=t=>Array.from(new Uint8Array(p.arrayBuffer(Buffer.from(t,"base64")))),re=(t,e,a)=>{const n=t instanceof Error?t:new Error(String(t));throw e({error:n}),a?.(n),n},ie=t=>t?Array.from(Buffer.from(t,"base64")):[],se=async(t,e,a)=>{const{isConnecting:n,config:r}=t();if(n)throw new Error("Already connecting");e({isConnecting:!0,error:null});try{const n=await x.getWallet();if((()=>{if("undefined"==typeof window)return;const t=localStorage.getItem("lazorkit-wallet");if(t)try{const e=JSON.parse(t);e.state&&void 0!==e.version&&localStorage.removeItem("lazorkit-wallet")}catch(t){}})(),n)return e({wallet:n}),a?.onSuccess?.(n),n;const i=ae(r);try{const n=await i.openConnect(),s=new R(r.paymasterConfig),o=new $t(t().connection),l=ne(n.credentialId),c=await o.getSmartWalletByCredentialHash(l);let d,A;if(!n.publicKey&&c?(A=Buffer.from(c.passkeyPubkey).toString("base64"),localStorage.setItem("PUBLIC_KEY",A)):A=n.publicKey,c)d=c.smartWallet.toBase58();else{const t=await s.getPayer(),e=await o.createSmartWalletTxn({passkeyPublicKey:ie(A),payer:t,credentialIdBase64:n.credentialId});await s.signAndSend(e.transaction),d=e.smartWallet.toBase58()}const u={credentialId:n.credentialId,passkeyPubkey:ie(A),expo:"web",platform:navigator.platform,smartWallet:d,walletDevice:"",accountName:n.accountName};return await x.saveWallet(u),e({wallet:u}),a?.onSuccess?.(u),u}finally{i.destroy()}}catch(t){return re(t,e,a?.onFail)}finally{e({isConnecting:!1})}},oe=d()(C((t,e)=>({wallet:null,config:{portalUrl:P.PORTAL_URL,paymasterConfig:{paymasterUrl:P.PAYMASTER_URL},rpcUrl:P.RPC_ENDPOINT},connection:new s(P.RPC_ENDPOINT,W),isLoading:!1,isConnecting:!1,isSigning:!1,error:null,setConfig:e=>{try{const a=new s(e.rpcUrl||P.RPC_ENDPOINT,W);t({config:e,connection:a})}catch(t){throw console.error("Failed to update wallet configuration:",t,{config:e}),new Error(`Failed to update configuration: ${t}`)}},setWallet:e=>{try{t({wallet:e})}catch(t){throw console.error("Failed to set wallet:",t,{wallet:e}),t}},setLoading:e=>t({isLoading:e}),setConnecting:e=>t({isConnecting:e}),setSigning:e=>t({isSigning:e}),setConnection:e=>{try{t({connection:e})}catch(t){throw console.error("Failed to set connection:",t,{endpoint:e?.rpcEndpoint}),t}},setError:e=>{t({error:e}),e&&console.error("Error state set:",e)},clearError:()=>{t({error:null})},connect:a=>se(e,t,a),disconnect:()=>(async(t,e)=>{try{await x.clearWallet(),t({wallet:null,error:null,isConnecting:!1,isSigning:!1,isLoading:!1}),e?.onSuccess?.()}catch(a){return re(a,t,e?.onFail)}})(t),signAndSendTransaction:a=>(async(t,e,a)=>{const{isSigning:n,connection:r,wallet:i,config:s}=t();if(n)throw new Error("Already signing");if(!i)throw new Error("No wallet connected");if(!r)throw new Error("No connection available");e({isSigning:!0,error:null});try{const t=new R(s.paymasterConfig),e=new $t(r),n=await t.getPayer(),o=await O(r),l=await e.buildAuthorizationMessage({action:{type:T.CreateChunk,args:{policyInstruction:null,cpiInstructions:a.instructions}},payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),passkeyPublicKey:i.passkeyPubkey,timestamp:new A.BN(o),credentialHash:ne(i.credentialId)}),c=Buffer.from(l).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=await r.getLatestBlockhash(),u=new A.web3.TransactionMessage({payerKey:n,recentBlockhash:d.blockhash,instructions:a.instructions}).compileToV0Message(),p=new A.web3.VersionedTransaction(u),m=Buffer.from(p.serialize()).toString("base64"),g=ae(s),h=i.credentialId,y=a.transactionOptions?.clusterSimulation;try{const s=await g.openSign(c,m,h,y),l={msg:c,normalized:s.signature,clientDataJSONReturn:s.clientDataJsonBase64,authenticatorDataReturn:s.authenticatorDataBase64},d=ne(i.credentialId),u=await e.createChunkTxn({payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),passkeySignature:{passkeyPublicKey:i.passkeyPubkey,signature64:l.normalized,clientDataJsonRaw64:l.clientDataJSONReturn,authenticatorDataRaw64:l.authenticatorDataReturn},policyInstruction:null,cpiInstructions:a.instructions,timestamp:o,credentialHash:d}),p=await t.signAndSend(u);await r.confirmTransaction(p);const f=a.transactionOptions?.addressLookupTableAccounts||[],w=await e.executeChunkTxn({payer:n,smartWallet:new A.web3.PublicKey(i.smartWallet),cpiInstructions:a.instructions},{addressLookupTables:f,computeUnitLimit:a.transactionOptions?.computeUnitLimit});let b;return b=f.length>0?await t.signAndSendVersionedTransaction(w):await t.signAndSend(w),a.onSuccess?.(b),b}finally{g.destroy()}}catch(t){return re(t,e,a.onFail)}finally{e({isSigning:!1})}})(e,t,a),signMessage:a=>(async(t,e,a)=>{const{isSigning:n,wallet:r,config:i}=t();if(n)throw new Error("Already signing");if(!r)throw new Error("No wallet connected");e({isSigning:!0,error:null});try{const t=ae(i);try{const e=await t.openSignMessage(a,r.credentialId);return{signature:e.signature,signedPayload:e.signedPayload}}finally{t.destroy()}}catch(t){throw e({error:t}),t}finally{e({isSigning:!1})}})(e,t,a)}),{name:"lazorkit-wallet-store",storage:I(()=>B),partialize:t=>({wallet:t.wallet,config:t.config})})),le=n=>{const{children:r,rpcUrl:i=P.RPC_ENDPOINT,portalUrl:s=P.PORTAL_URL,paymasterConfig:o={paymasterUrl:P.PAYMASTER_URL}}=n,{setConfig:l}=oe();return a(()=>{l({portalUrl:s,paymasterConfig:o,rpcUrl:i})},[i,s,o,l]),t(e,{children:r})};function ce(t){return Uint8Array.from(atob(t),t=>t.charCodeAt(0))}async function de(t){let e=t;if(64===e.length){const t=new Uint8Array(65);t[0]=4,t.set(e,1),e=t}return crypto.subtle.importKey("raw",e,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])}async function Ae({signedPayload:t,signature:e,publicKey:a}){const n=ce(t),r=ce(e),i=ce(a),s=await de(i);return crypto.subtle.verify({name:"ECDSA",hash:"SHA-256"},s,r,n)}const ue=()=>{const{wallet:t,isLoading:e,isConnecting:a,isSigning:i,error:s,connect:o,disconnect:l,signAndSendTransaction:c,signMessage:d}=oe(),A=n(async t=>{try{return await o(t)}catch(t){throw console.error("Failed to connect wallet:",t),t}},[o]),u=n(async()=>{try{await l()}catch(t){throw console.error("Failed to disconnect wallet:",t),t}},[l]),p=n(async t=>{try{return await c({instructions:t.instructions,transactionOptions:t.transactionOptions})}catch(t){throw console.error("Failed to sign and send transaction:",t),t}},[c]),m=n(async t=>{try{return await d(t)}catch(t){throw console.error("Failed to sign message:",t),t}},[d]),g=n(async({signedPayload:t,signature:e,publicKey:a})=>{const n=Buffer.from(t).toString("base64"),r=Buffer.from(e).toString("base64"),i=Buffer.from(a).toString("base64");return await Ae({signedPayload:n,signature:r,publicKey:i})},[]);return{smartWalletPubkey:t?.smartWallet?new r(t.smartWallet):null,isConnected:!!t,isLoading:e||a||i,isConnecting:a,isSigning:i,error:s,wallet:t,connect:A,disconnect:u,signAndSendTransaction:p,signMessage:m,verifyMessage:g}};function pe(){if("undefined"!=typeof window&&window.ReactNativeWebView)return"mobile";const t=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(t)?"mobile":"web"}function me(){const t=navigator.userAgent.toLowerCase();return/^((?!chrome|android).)*safari/i.test(t)}function ge(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function he(){return/Android/i.test(navigator.userAgent)}const ye="CREDENTIAL_ID",fe="PUBLIC_KEY",we="SMART_WALLET_ADDRESS";class be{static saveCredentials(t){try{t.credentialId&&localStorage.setItem(ye,t.credentialId),localStorage.setItem(fe,t.publickey),localStorage.setItem(we,t.smartWalletAddress),localStorage.setItem("CREDENTIALS_TIMESTAMP",t.timestamp.toString())}catch(t){console.error("Failed to save credentials to local storage:",t)}}static getCredentials(){try{const t=localStorage.getItem(ye),e=localStorage.getItem(fe),a=localStorage.getItem(we),n=localStorage.getItem("CREDENTIALS_TIMESTAMP");return e&&a?{credentialId:t||void 0,publickey:e,smartWalletAddress:a,timestamp:n?parseInt(n):Date.now()}:null}catch(t){return console.error("Failed to get credentials from local storage:",t),null}}static updateSmartWalletAddress(t){try{localStorage.setItem(we,t)}catch(t){console.error("Failed to update smart wallet address in local storage:",t)}}static clearCredentials(){try{localStorage.removeItem(ye),localStorage.removeItem(fe),localStorage.removeItem(we),localStorage.removeItem("CREDENTIALS_TIMESTAMP"),console.log("Credentials cleared from local storage")}catch(t){console.error("Failed to clear credentials from local storage:",t)}}static getItem(t){return localStorage.getItem(t)}static setItem(t,e){localStorage.setItem(t,e)}}const ke="Lazorkit Wallet",Se={rpcUrl:"https://api.devnet.solana.com",portalUrl:"https://portal.lazor.sh",paymasterConfig:{paymasterUrl:"https://kora.devnet.lazorkit.com"}};class Ie extends h{constructor(t){super(),this.name=ke,this.url="https://lazorkit.com",this.icon="data:image/png;base64,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",this.supportedTransactionVersions=new Set(["legacy",0]),this._publicKey=null,this._readyState="undefined"==typeof window||"undefined"==typeof document?y.Unsupported:y.Installed,this._connecting=!1,this._wallet=null,this._config=Se,t&&(this._config={...this._config,...t})}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==y.Installed)throw new f;this._connecting=!0,this.emit("readyStateChange",this._readyState);const t=await x.getWallet();if(t)return void this._updateWalletState(t);const e=this._createDialogManager();try{const t=await e.openConnect(),a=await this._ensureWalletOnChain(t);await x.saveWallet(a),this._updateWalletState(a)}finally{e.destroy()}}catch(t){throw this.emit("error",t),t}finally{this._connecting=!1}}_updateWalletState(t){this._wallet=t,this._publicKey=new r(t.smartWallet),this.emit("connect",this._publicKey)}_createDialogManager(){return new ee({portalUrl:this._config.portalUrl,rpcUrl:this._config.rpcUrl,paymasterUrl:this._config.paymasterConfig.paymasterUrl})}async _ensureWalletOnChain(t){const e=new s(this._config.rpcUrl),a=new k({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),n=new $t(e),r=ne(t.credentialId),i=await n.getSmartWalletByCredentialHash(r);let o,l;if(!t.publicKey&&i?(l=u.from(i.passkeyPubkey).toString("base64"),localStorage.setItem("PUBLIC_KEY",l)):l=t.publicKey,i)o=i.smartWallet.toBase58();else{const e=await a.getPayerSigner(),r=await n.createSmartWalletTxn({passkeyPublicKey:ie(t.publicKey),payer:new A.web3.PublicKey(e.signer_address),credentialIdBase64:t.credentialId});await a.signAndSendTransaction({transaction:u.from(r.transaction.serialize({requireAllSignatures:!1})).toString("base64"),signer_key:e.signer_address}),o=r.smartWallet.toBase58()}return{credentialId:t.credentialId,passkeyPubkey:ie(l),expo:"web",platform:navigator.platform,smartWallet:o,walletDevice:""}}async disconnect(){await x.clearWallet(),this._wallet=null,this._publicKey=null,this.emit("disconnect")}async sendTransaction(t){try{if(!this._wallet||!this._publicKey)throw new w;const e=this._prepareInstructions(t);if(0===e.length)throw new b("No instructions to sign");const a=this._initializeClients();let n=[];if("version"in t){const e=t.message.addressTableLookups;n=await Promise.all(e.map(async t=>{const e=await a.connection.getAccountInfo(t.accountKey);if(!e)throw new Error("Lookup table not found");return new o({key:t.accountKey,state:o.deserialize(e.data)})}))}const r=await a.paymaster.getPayerSigner(),i=await O(a.connection),s=ne(this._wallet.credentialId),l=await this._buildAuthorizationMessage(a.smartWallet,e,r.signer_address,i,s),c=await a.connection.getLatestBlockhash(),d=await this._signWithDialog(l,e,c.blockhash,r.signer_address);return await this._executeSmartWalletTransaction(a,e,d,r.signer_address,i,s,n)}catch(t){throw this.emit("error",t),t}}async signTransaction(t){throw new b("Lazorkit Wallet does not support signTransaction. Please use sendTransaction or signAndSendTransaction.")}async signAllTransactions(t){throw new b("Lazorkit Wallet does not support signAllTransactions. Please use sendTransaction or signAndSendTransaction.")}async signMessage(t){const e=this._createDialogManager();try{if(!this._wallet||!this._publicKey)throw new w;const a=u.from(t).toString("base64"),n=await e.openSign(a,"",this._wallet.credentialId,this._config.clusterSimulation),r=JSON.stringify({signature:n.signature,signedPayload:n.signedPayload});return new Uint8Array(u.from(r))}catch(t){throw this.emit("error",t),t}finally{e.destroy()}}_initializeClients(){const t=new s(this._config.rpcUrl);return{connection:t,paymaster:new k({rpcUrl:this._config.paymasterConfig.paymasterUrl,apiKey:this._config.paymasterConfig.apiKey}),smartWallet:new $t(t)}}_prepareInstructions(t){return"version"in t?t.message.compiledInstructions.map(e=>new l({keys:e.accountKeyIndexes.map(e=>({pubkey:t.message.staticAccountKeys[e],isSigner:t.message.isAccountSigner(e),isWritable:t.message.isAccountWritable(e)})),programId:new r(t.message.staticAccountKeys[e.programIdIndex]),data:u.from(e.data)})):[...t.instructions]}async _buildAuthorizationMessage(t,e,a,n,r){return await t.buildAuthorizationMessage({action:{type:T.CreateChunk,args:{policyInstruction:null,cpiInstructions:e}},payer:new A.web3.PublicKey(a),smartWallet:this._publicKey,passkeyPublicKey:this._wallet.passkeyPubkey,timestamp:new A.BN(n),credentialHash:r})}async _signWithDialog(t,e,a,n){const r=u.from(t).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,""),i=this._createDialogManager();try{const t=new A.web3.TransactionMessage({payerKey:new A.web3.PublicKey(n),recentBlockhash:a,instructions:e}).compileToV0Message(),s=new A.web3.VersionedTransaction(t),o=u.from(s.serialize()).toString("base64");return await i.openSign(r,o,this._wallet.credentialId,this._config.clusterSimulation)}finally{i.destroy()}}async _executeSmartWalletTransaction(t,e,a,n,r,i,s){const o=await t.smartWallet.createChunkTxn({payer:new A.web3.PublicKey(n),smartWallet:this._publicKey,passkeySignature:{passkeyPublicKey:this._wallet.passkeyPubkey,signature64:a.signature,clientDataJsonRaw64:a.clientDataJsonBase64,authenticatorDataRaw64:a.authenticatorDataBase64},policyInstruction:null,cpiInstructions:e,timestamp:r,credentialHash:i}),l=await this._sendToPaymaster(t.paymaster,o,n);await t.connection.confirmTransaction(l,"confirmed");const c=await t.smartWallet.executeChunkTxn({payer:new A.web3.PublicKey(n),smartWallet:this._publicKey,cpiInstructions:e},{addressLookupTables:s});return await this._sendToPaymaster(t.paymaster,c,n)}async _sendToPaymaster(t,e,a){let n;n="version"in e?u.from(e.serialize()):u.from(e.serialize({requireAllSignatures:!1,verifySignatures:!1}));return(await t.signAndSendTransaction({transaction:n.toString("base64"),signer_key:a})).signature}}function ve(t){S(new Ce(t))}class Ce{constructor(t){this.version="1.0.0",this.name=ke,this.icon="data:image/png;base64,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",this._account=null,this._listeners={},this._adapter=new Ie(t),this._adapter.on("connect",t=>{this._account={address:t.toBase58(),publicKey:t.toBytes(),chains:["solana:mainnet","solana:devnet","solana:testnet"],features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]},this._emit("change",{accounts:[this._account]})}),this._adapter.on("disconnect",()=>{this._account=null,this._emit("change",{accounts:[]})})}get accounts(){return this._account?[this._account]:[]}get chains(){return["solana:mainnet","solana:devnet","solana:testnet"]}get features(){return{"standard:connect":{version:"1.0.0",connect:async()=>(await this._adapter.connect(),{accounts:this.accounts})},"standard:disconnect":{version:"1.0.0",disconnect:async()=>{await this._adapter.disconnect()}},"standard:events":{version:"1.0.0",on:(t,e)=>(this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(e),()=>{this._listeners[t]=this._listeners[t]?.filter(t=>t!==e)||[]})},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:async(...t)=>{const e=[];for(const a of t){const t=c.deserialize(a.transaction),n=await this._adapter.sendTransaction(t);e.push({signature:m.decode(n)})}return e}},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:async(...t)=>{throw new Error("signTransaction not supported")}},"solana:signMessage":{version:"1.0.0",signMessage:async(...t)=>{const e=[];for(const a of t){const t=await this._adapter.signMessage(a.message);e.push({message:a.message,signature:t,signedMessage:a.message})}return e}}}}_emit(t,...e){this._listeners[t]?.forEach(t=>t(...e))}}export{D as API_ENDPOINTS,Bt as CHUNK_SEED,J as CREDENTIAL_HASH_SIZE,P as DEFAULTS,W as DEFAULT_COMMITMENT,Se as DEFAULT_CONFIG,wt as DefaultPolicyClient,ee as DialogManager,_ as EMPTY_PDA_RENT_EXEMPT_BALANCE,$t as LazorkitClient,le as LazorkitProvider,Ie as LazorkitWalletAdapter,ke as LazorkitWalletName,U as Logger,G as PASSKEY_PUBLIC_KEY_SIZE,R as Paymaster,Z as SIGNATURE_SIZE,Wt as SMART_WALLET_CONFIG_SEED,Dt as SMART_WALLET_SEED,E as STORAGE_KEYS,T as SmartWalletAction,x as StorageManager,be as StorageUtil,Y as ValidationError,Et as WALLET_DEVICE_SEED,F as asCredentialHash,z as asPasskeyPublicKey,V as asSignature,$ as assertByteArrayLength,X as assertDefined,dt as assertNonEmptyArray,tt as assertNonEmptyByteArray,ct as assertNonEmptyString,ot as assertPositiveBN,gt as assertPositiveInteger,lt as assertPositiveNumber,mt as assertValidBase64,nt as assertValidCredentialHash,et as assertValidPasskeyPublicKey,q as assertValidPublicKey,ht as assertValidPublicKeyArray,it as assertValidSignature,At as assertValidTransactionInstruction,yt as assertValidTransactionInstructionArray,ce as base64ToBytes,Lt as buildCreateChunkMessage,Vt as buildExecuteMessage,jt as buildPasskeyVerificationInstruction,qt as buildTransaction,N as byteArrayEquals,Xt as calculateVerifyInstructionIndex,Zt as combineInstructionsWithAuth,Yt as combineInstructionsWithAuthAndCU,zt as computeMultipleCpiHashes,_t as convertPasskeySignatureToInstructionArgs,Gt as createComputeUnitLimitInstruction,K as credentialHashFromBase64,Tt as deriveChunkPda,Ut as deriveSmartWalletConfigPda,xt as deriveSmartWalletPda,Rt as deriveWalletDevicePda,pe as detectPlatform,O as getBlockchainTimestamp,Q as getRandomBytes,de as importP256PublicKey,H as instructionToAccountMetas,he as isAndroid,ge as isIOS,me as isSafari,pt as normalizePublicKey,Jt as prependComputeUnitLimit,ve as registerLazorkitWallet,ut as toNumberArray,ft as toNumberArraySafe,ue as useWallet,oe as useWalletStore,rt as validateCredentialHash,at as validatePasskeyPublicKey,st as validateSignature,Ae as verifySignatureBrowser};
 //# sourceMappingURL=index.mjs.map
diff --git a/node_modules/@lazorkit/wallet/dist/index.mjs.map b/node_modules/@lazorkit/wallet/dist/index.mjs.map
index 335e37a..65d8648 100644
--- a/node_modules/@lazorkit/wallet/dist/index.mjs.map
+++ b/node_modules/@lazorkit/wallet/dist/index.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"index.mjs","sources":["../../../node_modules/.pnpm/zustand@5.0.9_@types+react@18.3.27_react@19.2.3/node_modules/zustand/esm/middleware.mjs","../../config/defaults.ts","../../config/endpoints.ts","../../config/constants.ts","../../core/storage/StorageManager.ts","../../utils/logger.ts","../../core/paymaster/paymaster.ts","../../core/contract/types.ts","../../core/contract/utils.ts","../../core/contract/pda/defaultPolicy.ts","../../core/contract/constants.ts","../../core/contract/validation.ts","../../core/contract/client/defaultPolicy.ts","../../core/contract/pda/lazorkit.ts","../../core/contract/client/internal/walletPdas.ts","../../core/contract/client/internal/policyResolver.ts","../../core/contract/messages.ts","../../core/contract/webauthn/secp256r1.ts","../../core/contract/auth.ts","../../core/contract/transaction.ts","../../core/contract/client/lazorkit.ts","../../core/contract/client/internal/cpi.ts","../../core/contract/index.ts","../../core/portal/CredentialManager.ts","../../core/portal/DialogManager.ts","../../core/portal/styles/DialogStyles.ts","../../core/wallet/utils.ts","../../core/wallet/actions.ts","../../react/store.ts","../../react/LazorkitProvider.tsx","../../utils/verify.ts","../../react/useWallet.ts","../../utils/platform.ts","../../utils/storage.ts","../../core/adapter/adapter.ts","../../core/adapter/standard.ts"],"sourcesContent":["const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...args) => api.dispatch(...args), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst removeStoreFromTrackedConnections = (name, store) => {\n  if (store === void 0) return;\n  const connectionInfo = trackedConnections.get(name);\n  if (!connectionInfo) return;\n  delete connectionInfo.stores[store];\n  if (Object.keys(connectionInfo.stores).length === 0) {\n    trackedConnections.delete(name);\n  }\n};\nconst findCallerName = (stack) => {\n  var _a, _b;\n  if (!stack) return void 0;\n  const traceLines = stack.split(\"\\n\");\n  const apiSetStateLineIndex = traceLines.findIndex(\n    (traceLine) => traceLine.includes(\"api.setState\")\n  );\n  if (apiSetStateLineIndex < 0) return void 0;\n  const callerLine = ((_a = traceLines[apiSetStateLineIndex + 1]) == null ? void 0 : _a.trim()) || \"\";\n  return (_b = /.+ (.+) .+/.exec(callerLine)) == null ? void 0 : _b[1];\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = ((state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? {\n      type: anonymousActionType || findCallerName(new Error().stack) || \"anonymous\"\n    } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  });\n  api.devtools = {\n    cleanup: () => {\n      if (connection && typeof connection.unsubscribe === \"function\") {\n        connection.unsubscribe();\n      }\n      removeStoreFromTrackedConnections(options.name, store);\n    }\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && args[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...args);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, fn) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) fn(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = ((selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  });\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nfunction combine(initialState, create) {\n  return (...args) => Object.assign({}, initialState, create(...args));\n}\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(name, JSON.stringify(newValue, options == null ? void 0 : options.replacer)),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst persistImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    return setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      return setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            const migration = options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n            if (migration instanceof Promise) {\n              return migration.then((result) => [true, result]);\n            }\n            return [true, migration];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persist = persistImpl;\n\nfunction ssrSafe(config, isSSR = typeof window === \"undefined\") {\n  return (set, get, api) => {\n    if (!isSSR) {\n      return config(set, get, api);\n    }\n    const ssrSet = () => {\n      throw new Error(\"Cannot set state of Zustand store in SSR\");\n    };\n    api.setState = ssrSet;\n    return config(ssrSet, get, api);\n  };\n}\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector, ssrSafe as unstable_ssrSafe };\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["createJSONStorage","getStorage","options","storage","e","getItem","name","_a","parse","str2","JSON","str","Promise","then","setItem","newValue","stringify","removeItem","toThenable","fn","input","result","onFulfilled","_onRejected","this","_onFulfilled","catch","onRejected","persist","config","baseOptions","set","get","api","localStorage","partialize","state","version","merge","persistedState","currentState","hasHydrated","hydrationListeners","Set","finishHydrationListeners","args","console","warn","savedSetState","setState","replace","configResult","stateFromStorage","getInitialState","hydrate","_b","forEach","cb","_a2","postRehydrationCallback","onRehydrateStorage","call","bind","deserializedStorageValue","migrate","migration","error","migrationResult","migrated","migratedState","setOptions","newOptions","clearStorage","getOptions","rehydrate","onHydrate","add","delete","onFinishHydration","skipHydration","DEFAULTS","PORTAL_URL","PAYMASTER_URL","RPC_ENDPOINT","API_ENDPOINTS","CONNECT","SIGN","DEFAULT_COMMITMENT","STORAGE_KEYS","WALLET","CREDENTIALS","PUBLIC_KEY","CREDENTIAL_ID","SMART_WALLET_ADDRESS","async","window","key","value","valueLength","length","StorageManager","saveWallet","wallet","credentialId","smartWallet","Buffer","from","passkeyPubkey","toString","getWallet","walletData","saveConfig","getConfig","configData","clearWallet","Logger","constructor","context","enabled","process","env","NODE_ENV","debug","message","data","info","Paymaster","logger","endpoint","paymasterUrl","apiKey","getHeaders","headers","getPayer","response","fetch","method","body","jsonrpc","id","params","ok","Error","statusText","json","PublicKey","signer_address","getBlockhash","blockhash","attemptSign","transaction","attempt","serialized","serialize","verifySignatures","requireAllSignatures","Transaction","signed_transaction","sign","maxRetries","baseDelay","delay","Math","pow","resolve","setTimeout","attemptSignAndSend","signature","signAndSend","attemptSignAndSendVersionedTransaction","signAndSendVersionedTransaction","SmartWalletAction","instructionToAccountMetas","ix","signers","keys","map","k","pubkey","isWritable","isSigner","some","s","getRandomBytes","len","globalThis","crypto","getRandomValues","arr","Uint8Array","randomBytes","require","byteArrayEquals","a","b","i","credentialHashFromBase64","credentialIdBase64","Array","sha256","arrayBuffer","getBlockchainTimestamp","connection","slot","getSlot","blockTime","getBlockTime","anchor","BN","ensureChunkExist","client","smartWalletPubkey","retries","nounce","getWalletStateData","chunkAddress","getChunkPubkey","lastNonce","getAccountInfo","asPasskeyPublicKey","asCredentialHash","asSignature","POLICY_SEED","EMPTY_PDA_RENT_EXEMPT_BALANCE","PASSKEY_PUBLIC_KEY_SIZE","CREDENTIAL_HASH_SIZE","SIGNATURE_SIZE","ValidationError","field","super","assertDefined","fieldName","assertValidPublicKey","trim","web3","toBase58","toBytes","assertByteArrayLength","expectedLength","array","isArray","byte","Number","isFinite","isInteger","assertNonEmptyByteArray","assertValidPasskeyPublicKey","validatePasskeyPublicKey","assertValidCredentialHash","validateCredentialHash","assertValidSignature","validateSignature","assertPositiveBN","lt","assertPositiveNumber","isNaN","Infinity","assertNonEmptyString","String","assertNonEmptyArray","assertValidTransactionInstruction","TransactionInstruction","programId","toNumberArray","normalizePublicKey","assertValidBase64","test","atob","assertPositiveInteger","assertValidPublicKeyArray","pk","index","assertValidTransactionInstructionArray","toNumberArraySafe","assertValidPasskeySignature","passkeyPublicKey","signature64","clientDataJsonRaw64","authenticatorDataRaw64","DefaultPolicyClient","program","Program","DefaultPolicyIdl","policyPda","findProgramAddressSync","toBuffer","derivePolicyPda","getPolicyDataSize","validateInitPolicyParams","walletId","credentialHash","policySigner","walletState","buildInitPolicyIx","methods","initPolicy","accountsPartial","instruction","validateCheckPolicyParams","policyData","isBuffer","buildCheckPolicyIx","checkPolicy","SMART_WALLET_SEED","SMART_WALLET_CONFIG_SEED","WALLET_DEVICE_SEED","CHUNK_SEED","deriveSmartWalletPda","toArrayLike","deriveSmartWalletConfigPda","createWalletDeviceHash","rawBuffer","concat","hash","subarray","deriveWalletDevicePda","deriveChunkPda","WalletPdaFactory","walletDevice","chunk","nonce","PolicyInstructionResolver","policyClient","walletPdas","resolveForExecute","provided","walletStateData","undefined","resolveForCreate","smartWalletId","coder","computeHash","computeSingleInsAccountsHash","metas","h","create","update","meta","computePolicyHashes","policyIns","policyMetas","policyAccountsHash","policyDataHash","computeMultipleCpiHashes","cpiInstructions","cpiSigners","lengthBuffer","alloc","writeUInt32LE","serializedData","dataLengthBuffer","cpiDataHash","cpiAccountsHash","pubkeyProperties","Map","existing","processedMetas","properties","computeAllInsAccountsHash","flatMap","encodeMessage","messageType","encoded","BorshCoder","instructions","accounts","types","type","kind","fields","encode","buildExecuteMessage","timestamp","cpiIns","policyHashes","cpiHashes","cpiMetas","computeCpiHashes","policyCombined","policyHash","cpiCombined","cpiHash","nonceBuffer","writeBigUInt64LE","BigInt","timestampBuffer","writeBigInt64LE","finalData","dataHash","buildCreateChunkMessage","SECP256R1_NATIVE_PROGRAM","bytesOf","buffer","ArrayBuffer","Object","values","view","DataView","setUint16","buildPasskeyVerificationInstruction","passkeySignature","authenticatorDataRaw","clientDataJsonRaw","totalSize","DATA_START","instructionData","offsets","signature_offset","publicKeyOffset","signature_instruction_index","public_key_offset","SIGNATURE_OFFSETS_SERIALIZED_SIZE","public_key_instruction_index","message_data_offset","signatureOffset","message_data_size","message_instruction_index","buildSecp256r1VerifyIx","convertPasskeySignatureToInstructionArgs","createComputeUnitLimitInstruction","limit","ComputeBudgetProgram","setComputeUnitLimit","units","prependComputeUnitLimit","computeUnitLimit","combineInstructionsWithAuth","authInstruction","smartWalletInstructions","combineInstructionsWithAuthAndCU","calculateVerifyInstructionIndex","buildTransaction","payer","addressLookupTables","recentBlockhash","customBlockhash","finalInstructions","shouldUseVersioned","getLatestBlockhash","TransactionMessage","payerKey","compileToV0Message","VersionedTransaction","isVersioned","feePayer","global","prototype","begin","end","apply","setPrototypeOf","LazorkitClient","LazorkitIdl","defaultPolicyProgram","policyResolver","getSmartWalletPubkey","getWalletStatePubkey","getWalletDevicePubkey","generateWalletId","fetchWalletStateContext","account","fetchChunkContext","validateCreateSmartWalletParams","amount","policyDataSize","policyInstruction","validateExecuteParams","cpiInstruction","validateCreateChunkParams","validateExecuteChunkParams","getChunkData","getSmartWalletByCredentialHash","discriminator","find","getProgramAccounts","filters","memcmp","offset","bytes","bs58","default","buildCreateSmartWalletIns","createSmartWallet","policyProgram","systemProgram","SystemProgram","remainingAccounts","buildExecuteIns","execute","cpiProgram","ixSysvar","SYSVAR_INSTRUCTIONS_PUBKEY","buildCreateChunkIns","chunkPda","createChunk","buildExecuteChunkIns","chunkData","instructionDataList","splitIndex","currentIndex","push","calculateSplitIndex","allAccountMetas","collectCpiAccountMetas","executeChunk","accountsStrict","sessionRefund","rentRefundAddress","createSmartWalletTxn","initPolicyData","executeTxn","signatureArgs","verifyInstructionIndex","cpiData","createChunkTxn","calculateCpiHash","executeChunkTxn","buildAuthorizationMessage","action","types.SmartWalletAction","CreateChunk","structuredClone","obj","CredentialManager","EventEmitter","iframeRef","retryDelays","setIframeRef","iframe","notifyCredentialsUpdated","credentials","emit","event","CustomEvent","detail","bubbles","cancelable","dispatchEvent","syncCredentials","force","contentWindow","performCredentialSync","publickey","smartWalletAddress","Date","now","postMessage","err","storeCredential","credential","toISOString","destroy","removeAllListeners","DialogManager","dialogRef","popupWindow","popupCloseInterval","isClosing","isDestroyed","_currentAction","credentialManager","setupMessageListener","openConnect","reject","cleanup","off","connectHandler","errorHandler","on","timeoutId","originalResolve","originalReject","clearTimeout","reason","shouldUsePopup","connectUrl","portalUrl","openPopup","openConnectDialog","openSign","clusterSimulation","signHandler","encodedMessage","encodeURIComponent","signUrl","openSignDialog","openSignMessage","openModal","ensureFonts","document","getElementById","link","createElement","rel","href","head","appendChild","ensureDialogBackdropCSS","style","textContent","createCloseButton","onClose","btn","title","setAttribute","assign","width","height","borderRadius","border","background","cursor","display","alignItems","justifyContent","padding","color","outline","webkitTapHighlightColor","addEventListener","onclick","innerHTML","url","isMobileDevice","navigator","userAgent","isSafari","isMobile","getPopupDimensions","top","left","outerWidth","screenX","outerHeight","screenY","closed","close","dimensions","open","startPopupMonitor","clearInterval","setInterval","createModal","src","showModal","dialog","colorScheme","styles","overlay","position","inset","maxWidth","maxHeight","overflow","zIndex","placeItems","panel","boxShadow","closeButton","iframeContainer","margin","getDialogStyles","variant","flexDirection","fontFamily","header","flex","boxSizing","borderBottom","closeDialog","right","ariaLabel","allow","sandbox","tabIndex","target","origin","includes","URL","hostname","transformedData","publicKey","isCreated","connectionType","accountName","transformedDataSignResult","normalized","clientDataJsonBase64","clientDataJSONReturn","authenticatorDataBase64","authenticatorDataReturn","signedPayload","msg","parentNode","removeChild","getIframeRef","getDialogRef","getPopupWindow","getCurrentAction","createDialogManager","rpcUrl","paymasterConfig","getCredentialHash","handleActionError","onFail","getPasskeyPublicKey","publicKeyBase64","connectAction","isConnecting","existingWallet","oldZustandData","parsed","cleanupLegacyStorage","onSuccess","dialogManager","dialogResult","paymaster","smartWalletData","initSmartWalletTxn","walletInfo","expo","platform","useWalletStore","Connection","isLoading","isSigning","setConfig","setWallet","setLoading","setConnecting","setSigning","setConnection","rpcEndpoint","setError","clearError","connect","disconnect","disconnectAction","signAndSendTransaction","payload","encodedChallenge","latest","messageV0","base64Tx","transactionOptions","signResult","signResponse","createChunkTransaction","createChunkSignature","confirmTransaction","addressLookupTableAccounts","executeChunkTransaction","signAndSendTransactionAction","signMessage","signMessageAction","LazorkitProvider","props","children","useEffect","_jsx","_Fragment","base64ToBytes","b64","c","charCodeAt","importP256PublicKey","publicKeyBytes","rawKey","newKey","subtle","importKey","namedCurve","verifySignatureBrowser","payloadBytes","signatureBytes","cryptoKey","verify","useWallet","handleConnect","useCallback","handleDisconnect","handleSignAndSendTransaction","handleSignMessage","handleVerifyMessage","signedPayloadB64","signatureB64","publicKeyB64","isConnected","verifyMessage","detectPlatform","ReactNativeWebView","toLowerCase","isIOS","isAndroid","CREDENTIAL_ID_KEY","PUBLIC_KEY_KEY","SMART_WALLET_KEY","StorageUtil","saveCredentials","getCredentials","parseInt","updateSmartWalletAddress","clearCredentials","log","LazorkitWalletName","DEFAULT_CONFIG","LazorkitWalletAdapter","BaseWalletAdapter","icon","supportedTransactionVersions","_publicKey","_readyState","WalletReadyState","Unsupported","Installed","_connecting","_wallet","_config","connecting","readyState","connected","WalletWindowClosedError","_updateWalletState","_createDialogManager","_ensureWalletOnChain","KoraClient","getPayerSigner","signer_key","sendTransaction","WalletDisconnectedError","_prepareInstructions","WalletSignTransactionError","clients","_initializeClients","lookups","addressTableLookups","all","lookup","acc","accountKey","AddressLookupTableAccount","deserialize","_buildAuthorizationMessage","_signWithDialog","_executeSmartWalletTransaction","signTransaction","_transaction","signAllTransactions","_transactions","messageBase64","compiledInstructions","accountKeyIndexes","keyIndex","staticAccountKeys","isAccountSigner","isAccountWritable","programIdIndex","feePayerAddress","createDeferredExecutionTxn","_sendToPaymaster","executeDeferredTransactionTxn","signerKey","registerLazorkitWallet","registerWallet","LazorkitWalletStandard","_account","_listeners","_adapter","address","chains","features","_emit","listener","filter","l","inputs","results","tx","decode","_inputs","signedMessage"],"mappings":"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","x_google_ignoreList":[0]}
\ No newline at end of file
+{"version":3,"file":"index.mjs","sources":["../../../node_modules/.pnpm/zustand@5.0.9_@types+react@18.3.27_react@19.2.3/node_modules/zustand/esm/middleware.mjs","../../config/defaults.ts","../../config/endpoints.ts","../../config/constants.ts","../../core/storage/StorageManager.ts","../../utils/logger.ts","../../core/paymaster/paymaster.ts","../../core/contract/types.ts","../../core/contract/utils.ts","../../core/contract/pda/defaultPolicy.ts","../../core/contract/constants.ts","../../core/contract/validation.ts","../../core/contract/client/defaultPolicy.ts","../../core/contract/webauthn/secp256r1.ts","../../core/contract/pda/lazorkit.ts","../../core/contract/client/internal/walletPdas.ts","../../core/contract/client/internal/policyResolver.ts","../../core/contract/messages.ts","../../core/contract/auth.ts","../../core/contract/transaction.ts","../../core/contract/client/lazorkit.ts","../../core/contract/client/internal/cpi.ts","../../core/contract/index.ts","../../core/portal/CredentialManager.ts","../../core/portal/DialogManager.ts","../../core/portal/styles/DialogStyles.ts","../../core/wallet/utils.ts","../../core/wallet/actions.ts","../../react/store.ts","../../react/LazorkitProvider.tsx","../../utils/verify.ts","../../react/useWallet.ts","../../utils/platform.ts","../../utils/storage.ts","../../core/adapter/adapter.ts","../../core/adapter/standard.ts"],"sourcesContent":["const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...args) => api.dispatch(...args), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst removeStoreFromTrackedConnections = (name, store) => {\n  if (store === void 0) return;\n  const connectionInfo = trackedConnections.get(name);\n  if (!connectionInfo) return;\n  delete connectionInfo.stores[store];\n  if (Object.keys(connectionInfo.stores).length === 0) {\n    trackedConnections.delete(name);\n  }\n};\nconst findCallerName = (stack) => {\n  var _a, _b;\n  if (!stack) return void 0;\n  const traceLines = stack.split(\"\\n\");\n  const apiSetStateLineIndex = traceLines.findIndex(\n    (traceLine) => traceLine.includes(\"api.setState\")\n  );\n  if (apiSetStateLineIndex < 0) return void 0;\n  const callerLine = ((_a = traceLines[apiSetStateLineIndex + 1]) == null ? void 0 : _a.trim()) || \"\";\n  return (_b = /.+ (.+) .+/.exec(callerLine)) == null ? void 0 : _b[1];\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = ((state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? {\n      type: anonymousActionType || findCallerName(new Error().stack) || \"anonymous\"\n    } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  });\n  api.devtools = {\n    cleanup: () => {\n      if (connection && typeof connection.unsubscribe === \"function\") {\n        connection.unsubscribe();\n      }\n      removeStoreFromTrackedConnections(options.name, store);\n    }\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && args[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...args);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, fn) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) fn(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = ((selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  });\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nfunction combine(initialState, create) {\n  return (...args) => Object.assign({}, initialState, create(...args));\n}\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(name, JSON.stringify(newValue, options == null ? void 0 : options.replacer)),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst persistImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    return setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      return setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            const migration = options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n            if (migration instanceof Promise) {\n              return migration.then((result) => [true, result]);\n            }\n            return [true, migration];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persist = persistImpl;\n\nfunction ssrSafe(config, isSSR = typeof window === \"undefined\") {\n  return (set, get, api) => {\n    if (!isSSR) {\n      return config(set, get, api);\n    }\n    const ssrSet = () => {\n      throw new Error(\"Cannot set state of Zustand store in SSR\");\n    };\n    api.setState = ssrSet;\n    return config(ssrSet, get, api);\n  };\n}\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector, ssrSafe as unstable_ssrSafe };\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"names":["createJSONStorage","getStorage","options","storage","e","getItem","name","_a","parse","str2","JSON","str","Promise","then","setItem","newValue","stringify","removeItem","toThenable","fn","input","result","onFulfilled","_onRejected","this","_onFulfilled","catch","onRejected","persist","config","baseOptions","set","get","api","localStorage","partialize","state","version","merge","persistedState","currentState","hasHydrated","hydrationListeners","Set","finishHydrationListeners","args","console","warn","savedSetState","setState","replace","configResult","stateFromStorage","getInitialState","hydrate","_b","forEach","cb","_a2","postRehydrationCallback","onRehydrateStorage","call","bind","deserializedStorageValue","migrate","migration","error","migrationResult","migrated","migratedState","setOptions","newOptions","clearStorage","getOptions","rehydrate","onHydrate","add","delete","onFinishHydration","skipHydration","DEFAULTS","PORTAL_URL","PAYMASTER_URL","RPC_ENDPOINT","API_ENDPOINTS","CONNECT","SIGN","DEFAULT_COMMITMENT","STORAGE_KEYS","WALLET","CREDENTIALS","PUBLIC_KEY","CREDENTIAL_ID","SMART_WALLET_ADDRESS","async","window","key","value","valueLength","length","StorageManager","saveWallet","wallet","credentialId","smartWallet","Buffer","from","passkeyPubkey","toString","getWallet","walletData","saveConfig","getConfig","configData","clearWallet","Logger","constructor","context","enabled","process","env","NODE_ENV","debug","message","data","info","Paymaster","logger","endpoint","paymasterUrl","apiKey","getHeaders","headers","getPayer","response","fetch","method","body","jsonrpc","id","params","ok","Error","statusText","json","PublicKey","signer_address","getBlockhash","blockhash","attemptSign","transaction","attempt","serialized","serialize","verifySignatures","requireAllSignatures","Transaction","signed_transaction","sign","maxRetries","baseDelay","delay","Math","pow","resolve","setTimeout","attemptSignAndSend","signature","signAndSend","attemptSignAndSendVersionedTransaction","signAndSendVersionedTransaction","SmartWalletAction","instructionToAccountMetas","ix","signers","keys","map","k","pubkey","isWritable","isSigner","some","s","getRandomBytes","len","globalThis","crypto","getRandomValues","arr","Uint8Array","randomBytes","require","byteArrayEquals","a","b","i","credentialHashFromBase64","credentialIdBase64","Array","sha256","arrayBuffer","getBlockchainTimestamp","connection","slot","getSlot","blockTime","getBlockTime","anchor","BN","floor","Date","now","asPasskeyPublicKey","asCredentialHash","asSignature","POLICY_SEED","EMPTY_PDA_RENT_EXEMPT_BALANCE","PASSKEY_PUBLIC_KEY_SIZE","CREDENTIAL_HASH_SIZE","SIGNATURE_SIZE","ValidationError","field","super","assertDefined","fieldName","assertValidPublicKey","trim","web3","toBase58","toBytes","assertByteArrayLength","expectedLength","array","isArray","byte","Number","isFinite","isInteger","assertNonEmptyByteArray","assertValidPasskeyPublicKey","validatePasskeyPublicKey","assertValidCredentialHash","validateCredentialHash","assertValidSignature","validateSignature","assertPositiveBN","lt","assertPositiveNumber","isNaN","Infinity","assertNonEmptyString","String","assertNonEmptyArray","assertValidTransactionInstruction","TransactionInstruction","programId","toNumberArray","normalizePublicKey","assertValidBase64","test","atob","assertPositiveInteger","assertValidPublicKeyArray","pk","index","assertValidTransactionInstructionArray","toNumberArraySafe","DefaultPolicyClient","program","Program","DefaultPolicyIdl","policyPda","findProgramAddressSync","toBuffer","derivePolicyPda","getPolicyDataSize","validateInitPolicyParams","walletId","passkeyPublicKey","credentialHash","policySigner","walletState","buildInitPolicyIx","methods","initPolicy","accountsPartial","instruction","validateCheckPolicyParams","policyData","isBuffer","buildCheckPolicyIx","checkPolicy","createWalletDeviceHash","rawBuffer","concat","hash","subarray","FIELD_SIZE","SECP256R1_NATIVE_PROGRAM","SECP256R1_ORDER","SECP256R1_HALF_ORDER","bytesOf","buffer","ArrayBuffer","Object","values","view","DataView","setUint16","buildSecp256r1VerifyIx","r","slice","paddedR","alloc","paddedS","copy","isGreaterThan","newS","borrow","diff","subtractBigNumbers","totalSize","DATA_START","instructionData","numSignatures","publicKeyOffset","SIGNATURE_OFFSETS_SERIALIZED_SIZE","signatureOffset","messageDataOffset","offsets","signature_offset","signature_instruction_index","public_key_offset","public_key_instruction_index","message_data_offset","message_data_size","message_instruction_index","SMART_WALLET_SEED","SMART_WALLET_CONFIG_SEED","WALLET_DEVICE_SEED","CHUNK_SEED","deriveSmartWalletPda","toArrayLike","deriveSmartWalletConfigPda","deriveWalletDevicePda","deriveChunkPda","lastNonce","WalletPdaFactory","walletDevice","chunk","nonce","PolicyInstructionResolver","policyClient","walletPdas","resolveForExecute","provided","walletStateData","resolveForCreate","smartWalletId","coder","computeHash","computeSingleInsAccountsHash","metas","h","create","update","meta","computePolicyHashes","policyIns","policyMetas","policyAccountsHash","policyDataHash","computeMultipleCpiHashes","cpiInstructions","cpiSigners","lengthBuffer","writeUInt32LE","serializedData","dataLengthBuffer","cpiDataHash","cpiAccountsHash","pubkeyProperties","Map","existing","processedMetas","properties","computeAllInsAccountsHash","flatMap","encodeMessage","messageType","encoded","BorshCoder","instructions","accounts","types","type","kind","fields","encode","buildExecuteMessage","timestamp","cpiIns","policyHashes","cpiHashes","cpiMetas","computeCpiHashes","policyCombined","policyHash","cpiCombined","cpiHash","nonceBuffer","writeBigUInt64LE","BigInt","timestampBuffer","writeBigInt64LE","finalData","dataHash","buildCreateChunkMessage","buildPasskeyVerificationInstruction","passkeySignature","signature64","clientDataJsonRaw64","authenticatorDataRaw64","authenticatorDataRaw","clientDataJsonRaw","rawMessage","convertPasskeySignatureToInstructionArgs","createComputeUnitLimitInstruction","limit","ComputeBudgetProgram","setComputeUnitLimit","units","prependComputeUnitLimit","computeUnitLimit","undefined","combineInstructionsWithAuth","authInstruction","smartWalletInstructions","combineInstructionsWithAuthAndCU","calculateVerifyInstructionIndex","buildTransaction","payer","addressLookupTables","recentBlockhash","customBlockhash","finalInstructions","lookupTables","getLatestBlockhash","log","TransactionMessage","payerKey","compileToV0Message","VersionedTransaction","isVersioned","feePayer","prototype","begin","end","apply","setPrototypeOf","LazorkitClient","LazorkitIdl","defaultPolicyProgram","policyResolver","getSmartWalletPubkey","getWalletStatePubkey","getWalletDevicePubkey","getChunkPubkey","generateWalletId","fetchWalletStateContext","account","fetchChunkContext","validateCreateSmartWalletParams","amount","policyDataSize","policyInstruction","validateExecuteParams","cpiInstruction","validateCreateChunkParams","validateExecuteChunkParams","validateCloseChunkParams","getWalletStateData","getChunkData","getSmartWalletByPasskey","discriminator","find","getProgramAccounts","filters","memcmp","offset","bytes","bs58","decode","device","devices","deviceSlot","getSmartWalletByCredentialHash","buildCreateSmartWalletIns","createSmartWallet","policyProgram","systemProgram","SystemProgram","remainingAccounts","buildExecuteIns","execute","cpiProgram","ixSysvar","SYSVAR_INSTRUCTIONS_PUBKEY","buildCreateChunkIns","chunkPda","createChunk","buildExecuteChunkIns","latestNonce","sub","chunkData","instructionDataList","splitIndex","currentIndex","push","calculateSplitIndex","allAccountMetas","collectCpiAccountMetas","executeChunk","sessionRefund","rentRefundAddress","buildCloseChunkIns","closeChunk","createSmartWalletTxn","initPolicyData","executeTxn","signatureArgs","verifyInstructionIndex","cpiData","createChunkTxn","calculateCpiHash","executeChunkTxn","closeChunkTxn","buildAuthorizationMessage","action","types.SmartWalletAction","Execute","CreateChunk","smartWalletConfig","defaultPolicyInstruction","structuredClone","obj","CredentialManager","EventEmitter","iframeRef","retryDelays","setIframeRef","iframe","notifyCredentialsUpdated","credentials","emit","event","CustomEvent","detail","bubbles","cancelable","dispatchEvent","syncCredentials","force","contentWindow","performCredentialSync","publickey","smartWalletAddress","postMessage","err","storeCredential","credential","toISOString","destroy","removeAllListeners","DialogManager","dialogRef","popupWindow","popupCloseInterval","isClosing","isDestroyed","_currentAction","credentialManager","setupMessageListener","openConnect","reject","cleanup","off","connectHandler","errorHandler","on","timeoutId","originalResolve","originalReject","clearTimeout","reason","shouldUsePopup","connectUrl","portalUrl","openPopup","openConnectDialog","openSign","clusterSimulation","signHandler","encodedMessage","encodeURIComponent","signUrl","openSignDialog","openSignMessage","openModal","ensureFonts","document","getElementById","link","createElement","rel","href","head","appendChild","ensureDialogBackdropCSS","style","textContent","createCloseButton","onClose","btn","title","setAttribute","assign","width","height","borderRadius","border","background","cursor","display","alignItems","justifyContent","padding","color","outline","webkitTapHighlightColor","addEventListener","onclick","innerHTML","url","isMobileDevice","navigator","userAgent","isSafari","isMobile","getPopupDimensions","top","left","outerWidth","screenX","outerHeight","screenY","closed","close","dimensions","open","startPopupMonitor","clearInterval","setInterval","createModal","src","showModal","dialog","colorScheme","styles","overlay","position","inset","maxWidth","maxHeight","overflow","zIndex","placeItems","panel","boxShadow","closeButton","iframeContainer","margin","getDialogStyles","variant","flexDirection","fontFamily","header","flex","boxSizing","borderBottom","closeDialog","right","ariaLabel","allow","sandbox","tabIndex","target","origin","includes","URL","hostname","transformedData","publicKey","isCreated","connectionType","accountName","transformedDataSignResult","normalized","clientDataJsonBase64","clientDataJSONReturn","authenticatorDataBase64","authenticatorDataReturn","signedPayload","msg","parentNode","removeChild","getIframeRef","getDialogRef","getPopupWindow","getCurrentAction","createDialogManager","rpcUrl","paymasterConfig","getCredentialHash","handleActionError","onFail","getPasskeyPublicKey","publicKeyBase64","connectAction","isConnecting","existingWallet","oldZustandData","parsed","cleanupLegacyStorage","onSuccess","dialogManager","dialogResult","paymaster","smartWalletData","initSmartWalletTxn","walletInfo","expo","platform","useWalletStore","Connection","isLoading","isSigning","setConfig","setWallet","setLoading","setConnecting","setSigning","setConnection","rpcEndpoint","setError","clearError","connect","disconnect","disconnectAction","signAndSendTransaction","payload","encodedChallenge","latest","messageV0","base64Tx","transactionOptions","signResult","signResponse","createChunkTransaction","createChunkSignature","confirmTransaction","addressLookupTableAccounts","executeChunkTransaction","signAndSendTransactionAction","signMessage","signMessageAction","LazorkitProvider","props","children","useEffect","_jsx","_Fragment","base64ToBytes","b64","c","charCodeAt","importP256PublicKey","publicKeyBytes","rawKey","newKey","subtle","importKey","namedCurve","verifySignatureBrowser","payloadBytes","signatureBytes","cryptoKey","verify","useWallet","handleConnect","useCallback","handleDisconnect","handleSignAndSendTransaction","handleSignMessage","handleVerifyMessage","signedPayloadB64","signatureB64","publicKeyB64","smartWalletPubkey","isConnected","verifyMessage","detectPlatform","ReactNativeWebView","toLowerCase","isIOS","isAndroid","CREDENTIAL_ID_KEY","PUBLIC_KEY_KEY","SMART_WALLET_KEY","StorageUtil","saveCredentials","getCredentials","parseInt","updateSmartWalletAddress","clearCredentials","LazorkitWalletName","DEFAULT_CONFIG","LazorkitWalletAdapter","BaseWalletAdapter","icon","supportedTransactionVersions","_publicKey","_readyState","WalletReadyState","Unsupported","Installed","_connecting","_wallet","_config","connecting","readyState","connected","WalletWindowClosedError","_updateWalletState","_createDialogManager","_ensureWalletOnChain","KoraClient","getPayerSigner","signer_key","sendTransaction","WalletDisconnectedError","_prepareInstructions","WalletSignTransactionError","clients","_initializeClients","lookups","addressTableLookups","all","lookup","acc","getAccountInfo","accountKey","AddressLookupTableAccount","deserialize","_buildAuthorizationMessage","_signWithDialog","_executeSmartWalletTransaction","signTransaction","_transaction","signAllTransactions","_transactions","messageBase64","compiledInstructions","accountKeyIndexes","keyIndex","staticAccountKeys","isAccountSigner","isAccountWritable","programIdIndex","feePayerAddress","createDeferredExecutionTxn","_sendToPaymaster","executeDeferredTransactionTxn","signerKey","registerLazorkitWallet","registerWallet","LazorkitWalletStandard","_account","_listeners","_adapter","address","chains","features","_emit","listener","filter","l","inputs","results","tx","_inputs","signedMessage"],"mappings":"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","x_google_ignoreList":[0]}
\ No newline at end of file
